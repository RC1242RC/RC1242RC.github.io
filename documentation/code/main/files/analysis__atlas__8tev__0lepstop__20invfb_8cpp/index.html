<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://rc1242rc.github.io/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://rc1242rc.github.io/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://rc1242rc.github.io/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var e=localStorage.getItem("theme");e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=https://rc1242rc.github.io/main.f12f7e04ea768acebec10c86baf049d74d6a79f24bc0dfb7ed77aa60462432916dd1ce8f41c78b69496adf650b3039a28a210183cce598f09b95d6fecb5ff999.css integrity="sha512-8S9+BOp2is6+wQyGuvBJ101qefJLwN+37XeqYEYkMpFt0c6PQceLaUlq32ULMDmiiiEBg8zlmPCbldb+y1/5mQ==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>file analyses/Analysis_ATLAS_8TeV_0LEPStop_20invfb.cpp - GAMBIT</title><meta name=description content="[No description available]"><link rel=canonical href=https://rc1242rc.github.io/documentation/code/main/files/analysis__atlas__8tev__0lepstop__20invfb_8cpp/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="file analyses/Analysis_ATLAS_8TeV_0LEPStop_20invfb.cpp"><meta property="og:description" content="[No description available]"><meta property="og:url" content="https://rc1242rc.github.io/documentation/code/main/files/analysis__atlas__8tev__0lepstop__20invfb_8cpp/"><meta property="og:site_name" content="GAMBIT"><meta property="og:image" content="https://rc1242rc.github.io/gambit_logo.png"><meta property="og:image:alt" content="GAMBIT"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content><meta name=twitter:creator content><meta name=twitter:title content="file analyses/Analysis_ATLAS_8TeV_0LEPStop_20invfb.cpp"><meta name=twitter:description content="[No description available]"><meta name=twitter:image content="https://rc1242rc.github.io/gambit_logo.png"><meta name=twitter:image:alt content="file analyses/Analysis_ATLAS_8TeV_0LEPStop_20invfb.cpp"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://rc1242rc.github.io/#/schema/organization/1","name":"Doks","url":"https://rc1242rc.github.io/","sameAs":["https://github.com/GambitBSM"],"logo":{"@type":"ImageObject","@id":"https://rc1242rc.github.io/#/schema/image/1","url":"https://rc1242rc.github.io/logo-doks.png","width":450,"height":416,"caption":"Doks"},"image":{"@id":"https://rc1242rc.github.io/#/schema/image/1"}},{"@type":"WebSite","@id":"https://rc1242rc.github.io/#/schema/website/1","url":"https://rc1242rc.github.io/","name":"GAMBIT","description":"Documentation for the Global And Modular BSM Inference Tool","publisher":{"@id":"https://rc1242rc.github.io/#/schema/organization/1"}},{"@type":"WebPage","@id":"https://rc1242rc.github.io/documentation/code/main/files/analysis__atlas__8tev__0lepstop__20invfb_8cpp/","url":"https://rc1242rc.github.io/documentation/code/main/files/analysis__atlas__8tev__0lepstop__20invfb_8cpp/","name":"file analyses\/Analysis_ATLAS_8TeV_0LEPStop_20invfb.cpp","description":"[No description available]","isPartOf":{"@id":"https://rc1242rc.github.io/#/schema/website/1"},"about":{"@id":"https://rc1242rc.github.io/#/schema/organization/1"},"datePublished":"0001-01-01T00:00:00CET","dateModified":"0001-01-01T00:00:00CET","breadcrumb":{"@id":"https://rc1242rc.github.io/documentation/code/main/files/analysis__atlas__8tev__0lepstop__20invfb_8cpp/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://rc1242rc.github.io/documentation/code/main/files/analysis__atlas__8tev__0lepstop__20invfb_8cpp/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://rc1242rc.github.io/documentation/code/main/files/analysis__atlas__8tev__0lepstop__20invfb_8cpp/"]}]},{"@type":"BreadcrumbList","@id":"https://rc1242rc.github.io/documentation/code/main/files/analysis__atlas__8tev__0lepstop__20invfb_8cpp/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://rc1242rc.github.io/","url":"https://rc1242rc.github.io/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://rc1242rc.github.io/documentation/","url":"https://rc1242rc.github.io/documentation/","name":"Documentation"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://rc1242rc.github.io/documentation/code/","url":"https://rc1242rc.github.io/documentation/code/","name":"Code"}},{"@type":"ListItem","position":4,"item":{"@type":"WebPage","@id":"https://rc1242rc.github.io/documentation/code/main/","url":"https://rc1242rc.github.io/documentation/code/main/","name":"Main"}},{"@type":"ListItem","position":5,"item":{"@type":"WebPage","@id":"https://rc1242rc.github.io/documentation/code/main/files/","url":"https://rc1242rc.github.io/documentation/code/main/files/","name":"Files"}},{"@type":"ListItem","position":6,"item":{"@id":"https://rc1242rc.github.io/documentation/code/main/files/analysis__atlas__8tev__0lepstop__20invfb_8cpp/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://rc1242rc.github.io/documentation/code/main/files/analysis__atlas__8tev__0lepstop__20invfb_8cpp/#/schema/image/2","url":"https://rc1242rc.github.io/gambit_logo.png","contentUrl":"https://rc1242rc.github.io/gambit_logo.png","caption":"file analyses\/Analysis_ATLAS_8TeV_0LEPStop_20invfb.cpp"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=https://rc1242rc.github.io/favicon.ico sizes=any><link rel=icon type=image/svg+xml href=https://rc1242rc.github.io/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=https://rc1242rc.github.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://rc1242rc.github.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://rc1242rc.github.io/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://rc1242rc.github.io/site.webmanifest></head><body class="documentation single light"><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-md navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-md-nowrap" aria-label="Main navigation"><a class="navbar-brand p-0 me-auto" href=https://rc1242rc.github.io/ aria-label=GAMBIT><img class=logo-light src=https://rc1242rc.github.io//images/gambit_logo.png width=50px>
<img class="logo-dark d-none" src=https://rc1242rc.github.io//images/gambit_logo.png width=50px>
GAMBIT</a>
<button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=/>GAMBIT</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Documentation
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=/documentation/installation/introduction/>Installation</a></li><li><a class=dropdown-item href=/documentation/examples/colliderbit>Examples</a></li><li><a class=dropdown-item href=/documentation/help/faqs/>Help</a></li><li><a class=dropdown-item href=/documentation/code/index_classes>Code Reference</a></li></ul></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Community
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=/community/publications/>Publications</a></li><li><a class=dropdown-item href=/community/talks/>Talks</a></li><li><a class=dropdown-item href=/community/members/>Members</a></li><li><a class=dropdown-item href=/community/code_of_conduct/>Code of Conduct</a></li><li><a class=dropdown-item href=/community/contact/>Contact</a></li></ul></li></ul><hr class="text-black-50 my-4 d-lg-none"><form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2"><input id=search class="form-control is-search" type=search placeholder="Search site..." aria-label="Search site..." autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=https://github.com/GambitBSM><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-lg-none">GitHub</small></a></li></ul><hr class="text-black-50 my-4 d-lg-none"><div class=dropdown><button class="btn btn-doks-light dropdown-toggle" id=doks-versions data-bs-toggle=dropdown aria-expanded=false data-bs-display=static aria-label="Toggle version menu">
<span class=d-none>Doks</span>
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></button><ul class="dropdown-menu dropdown-menu-lg-end me-lg-2 shadow rounded border-0" aria-labelledby=doks-versions></ul></div></div></div></nav></header></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-installation aria-expanded=false>
Installation</button><div class=collapse id=section-installation><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/installation/introduction/>Getting Started</a></li><li><a class="docs-link rounded" href=/documentation/installation/docker_usage/>Docker Usage</a></li><li><a class="docs-link rounded" href=/documentation/installation/installation_for_linux/>Installation for Linux</a></li><li><a class="docs-link rounded" href=/documentation/installation/installation_for_windows/>Installation for Windows</a></li><li><a class="docs-link rounded" href=/documentation/installation/installation_for_macos/>Installation for macOS</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-examples aria-expanded=false>
Examples</button><div class=collapse id=section-examples><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/examples/colliderbit/>ColliderBit</a></li><li><a class="docs-link rounded" href=/documentation/examples/anotherbit/>AnotherBit</a></li><li><a class="docs-link rounded" href=/documentation/examples/anotherbit2/>AnotherBit2</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-help aria-expanded=false>
Help</button><div class=collapse id=section-help><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/help/faqs/>FAQs</a></li><li><a class="docs-link rounded" href=/documentation/help/compiler_matrix/>Compiler Matrix</a></li><li><a class="docs-link rounded" href=/documentation/help/known_issues/>Known Issues</a></li><li><a class="docs-link rounded" href=/documentation/help/configuration_examples/>Configuration Examples</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-code aria-expanded=false>
Code Reference</button></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section- aria-expanded=false>
GAMBIT_VERSION_HERE</button><div class=collapse id=section-><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/code/colliderbit_development/index_classes/>Classes</a></li><li><a class="docs-link rounded" href=/documentation/code/colliderbit_development/index_files/>Files</a></li><li><a class="docs-link rounded" href=/documentation/code/colliderbit_development/index_pages/>Pages</a></li><li><a class="docs-link rounded" href=/documentation/code/colliderbit_development/index_namespaces/>Namespaces</a></li></ul></div></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span>On this page</span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><ul><li><a href=#namespaces>Namespaces</a></li><li><a href=#classes>Classes</a></li><li><a href=#source-code>Source code</a></li></ul></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3>On this page</h3><nav id=TableOfContents><ul><li><ul><li><a href=#namespaces>Namespaces</a></li><li><a href=#classes>Classes</a></li><li><a href=#source-code>Source code</a></li></ul></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9 mx-xl-auto"><h1>file analyses/Analysis_ATLAS_8TeV_0LEPStop_20invfb.cpp</h1><p class=lead></p><p>[No description available]</p><h2 id=namespaces>Namespaces <a href=#namespaces class=anchor aria-hidden=true>#</a></h2><table><thead><tr><th>Name</th></tr></thead><tbody><tr><td><strong><a href=/documentation/code/main/namespaces/namespacegambit/>Gambit</a></strong><br>TODO: see if we can use this one:</td></tr><tr><td><strong><a href=/documentation/code/main/namespaces/namespacegambit_1_1colliderbit/>Gambit::ColliderBit</a></strong></td></tr></tbody></table><h2 id=classes>Classes <a href=#classes class=anchor aria-hidden=true>#</a></h2><table><thead><tr><th></th><th>Name</th></tr></thead><tbody><tr><td>class</td><td><strong><a href=/documentation/code/main/classes/classgambit_1_1colliderbit_1_1analysis__atlas__8tev__0lepstop__20invfb/>Gambit::ColliderBit::Analysis_ATLAS_8TeV_0LEPStop_20invfb</a></strong></td></tr></tbody></table><h2 id=source-code>Source code <a href=#source-code class=anchor aria-hidden=true>#</a></h2><pre><code>#include &lt;vector&gt;
#include &lt;cmath&gt;
#include &lt;memory&gt;
#include &lt;iomanip&gt;

#include &quot;gambit/ColliderBit/analyses/Analysis.hpp&quot;
#include &quot;gambit/ColliderBit/ATLASEfficiencies.hpp&quot;
#include &quot;gambit/ColliderBit/mt2_bisect.h&quot;

using namespace std;

/* The ATLAS 0 lepton direct stop analysis (20fb^-1) - `heavy stop'.

   Based originally on: ATLAS-CONF-2013-024
   Now updated to arXiv:1406.1122
   Code by Martin White, Sky French.
   Known errors:
   a) The isolation is already applied in the simulation rather than after overlap removal -&gt; the electron and muon veto technically require a veto on base-line electrons/muons not overlapping with jets
   b) ETmiss-track cuts ignored...

   Known features:
   a) Have removed the tau veto since it disagrees with ATLAS cutflow (we lose ~2/3 of the events whilst ATLAS see a minimal effect. So ditching it is fine. In fact the implementation below is incorrect since it does not take into account the number of tracks associated to the jets.
   b) Using mt2 bisect method from H. Cheng, Z. Han, arXiv:0810.5178 for mT2 calculation

*/

namespace Gambit {
  namespace ColliderBit {

    bool sortByPT(const HEPUtils::Jet* jet1, const HEPUtils::Jet* jet2) { return (jet1-&gt;pT() &gt; jet2-&gt;pT()); }

    class Analysis_ATLAS_8TeV_0LEPStop_20invfb : public Analysis {
    private:

      // Numbers passing cuts
      double _numSRA1, _numSRA2, _numSRA3, _numSRA4;
      double _numSRC1, _numSRC2, _numSRC3;

      vector&lt;int&gt; cutFlowVector;
      vector&lt;string&gt; cutFlowVector_str;
      int NCUTS; //=16;

      // Debug histos

      void JetLeptonOverlapRemoval(vector&lt;const HEPUtils::Jet*&gt; &amp;jetvec, vector&lt;const HEPUtils::Particle*&gt; &amp;lepvec, double DeltaRMax) {
        //Routine to do jet-lepton check
        //Discards jets if they are within DeltaRMax of a lepton

        vector&lt;const HEPUtils::Jet*&gt; Survivors;

        for(unsigned int itjet = 0; itjet &lt; jetvec.size(); itjet++) {
          bool overlap = false;
          HEPUtils::P4 jetmom=jetvec.at(itjet)-&gt;mom();
          for(unsigned int itlep = 0; itlep &lt; lepvec.size(); itlep++) {
            HEPUtils::P4 lepmom=lepvec.at(itlep)-&gt;mom();
            double dR;

            dR=jetmom.deltaR_eta(lepmom);

            if(fabs(dR) &lt;= DeltaRMax) overlap=true;
          }
          if(overlap) continue;
          Survivors.push_back(jetvec.at(itjet));
        }
        jetvec=Survivors;

        return;
      }

      void LeptonJetOverlapRemoval(vector&lt;const HEPUtils::Particle*&gt; &amp;lepvec, vector&lt;const HEPUtils::Jet*&gt; &amp;jetvec, double DeltaRMax) {
        //Routine to do lepton-jet check
        //Discards leptons if they are within DeltaRMax of a jet

        vector&lt;const HEPUtils::Particle*&gt; Survivors;

        for(unsigned int itlep = 0; itlep &lt; lepvec.size(); itlep++) {
          bool overlap = false;
          HEPUtils::P4 lepmom=lepvec.at(itlep)-&gt;mom();
          for(unsigned int itjet= 0; itjet &lt; jetvec.size(); itjet++) {
            HEPUtils::P4 jetmom=jetvec.at(itjet)-&gt;mom();
            double dR;

            dR=jetmom.deltaR_eta(lepmom);

            if(fabs(dR) &lt;= DeltaRMax) overlap=true;
          }
          if(overlap) continue;
          Survivors.push_back(lepvec.at(itlep));
        }
        lepvec=Survivors;

        return;
      }


    public:

      // Required detector sim
      static constexpr const char* detector = &quot;ATLAS&quot;;

      Analysis_ATLAS_8TeV_0LEPStop_20invfb() {

        set_analysis_name(&quot;ATLAS_8TeV_0LEPStop_20invfb&quot;);
        set_luminosity(20.1);

        _numSRA1 = 0 ; _numSRA2 = 0; _numSRA3 = 0; _numSRA4 = 0;
        _numSRC1 = 0 ; _numSRC2 = 0; _numSRC3 = 0;
        NCUTS=23;

        for(int i=0;i&lt;NCUTS;i++){
          cutFlowVector.push_back(0);
          cutFlowVector_str.push_back(&quot;&quot;);
        }

      }



      void run(const HEPUtils::Event* event) {

        // Missing energy
        HEPUtils::P4 ptot = event-&gt;missingmom();
        double met = event-&gt;met();


        // Baseline lepton objects
        vector&lt;const HEPUtils::Particle*&gt; baselineElectrons, baselineMuons, baselineTaus;
        for (const HEPUtils::Particle* electron : event-&gt;electrons()) {
          if (electron-&gt;pT() &gt; 10. &amp;&amp; electron-&gt;abseta() &lt; 2.47) baselineElectrons.push_back(electron);
        }

        // Apply electron efficiency
        ATLAS::applyElectronEff(baselineElectrons);

        for (const HEPUtils::Particle* muon : event-&gt;muons()) {
          if (muon-&gt;pT() &gt; 10. &amp;&amp; muon-&gt;abseta() &lt; 2.4) baselineMuons.push_back(muon);
        }

        // Apply muon efficiency
        ATLAS::applyMuonEff(baselineMuons);

        for (const HEPUtils::Particle* tau : event-&gt;taus()) {
          if (tau-&gt;pT() &gt; 10. &amp;&amp; tau-&gt;abseta() &lt; 2.47) baselineTaus.push_back(tau);
        }
        ATLAS::applyTauEfficiencyR1(baselineTaus);


        // Jets
        vector&lt;const HEPUtils::Jet*&gt; baselineJets;
        vector&lt;const HEPUtils::Jet*&gt; bJets;
        vector&lt;const HEPUtils::Jet*&gt; nonBJets;
        vector&lt;const HEPUtils::Jet*&gt; trueBJets; //for debugging

        // Get b jets
        const std::vector&lt;double&gt;  a = {0,10.};
        const std::vector&lt;double&gt;  b = {0,10000.};
        const std::vector&lt;double&gt; c = {0.7};
        HEPUtils::BinnedFn2D&lt;double&gt; _eff2d(a,b,c);
        for (const HEPUtils::Jet* jet : event-&gt;jets()) {
          if (jet-&gt;pT() &gt; 20. &amp;&amp; fabs(jet-&gt;eta()) &lt; 4.5) baselineJets.push_back(jet);
          bool hasTag=has_tag(_eff2d, fabs(jet-&gt;eta()), jet-&gt;pT());
          if (jet-&gt;pT() &gt; 20. &amp;&amp; fabs(jet-&gt;eta()) &lt; 4.5) {
            if(jet-&gt;btag() &amp;&amp; hasTag &amp;&amp; fabs(jet-&gt;eta()) &lt; 2.5 &amp;&amp; jet-&gt;pT() &gt; 20.){
              bJets.push_back(jet);
            } else {
              nonBJets.push_back(jet);
            }
          }
        }


        // Overlap removal
        vector&lt;const HEPUtils::Particle*&gt; signalElectrons;
        vector&lt;const HEPUtils::Particle*&gt; signalMuons;
        vector&lt;const HEPUtils::Particle*&gt; electronsForVeto;
        vector&lt;const HEPUtils::Particle*&gt; muonsForVeto;

        vector&lt;const HEPUtils::Jet*&gt; signalJets;
        vector&lt;const HEPUtils::Jet*&gt; signalBJets;
        vector&lt;const HEPUtils::Jet*&gt; signalNonBJets;

        JetLeptonOverlapRemoval(nonBJets,baselineElectrons,0.2);
        LeptonJetOverlapRemoval(baselineElectrons,nonBJets,0.4);
        LeptonJetOverlapRemoval(baselineElectrons,bJets,0.4);
        LeptonJetOverlapRemoval(baselineMuons,nonBJets,0.4);
        LeptonJetOverlapRemoval(baselineMuons,bJets,0.4);

        for (const HEPUtils::Jet* jet : bJets) {
          if (jet-&gt;pT() &gt; 35. &amp;&amp; fabs(jet-&gt;eta()) &lt; 2.8) {
            signalJets.push_back(jet);
            signalBJets.push_back(jet);
          }
        }

        for (const HEPUtils::Jet* jet : nonBJets) {
          if (jet-&gt;pT() &gt; 35. &amp;&amp; fabs(jet-&gt;eta()) &lt; 2.8){
            signalJets.push_back(jet);
            signalNonBJets.push_back(jet);
          }
        }

        //Put signal jets in pT order
        std::sort(signalJets.begin(), signalJets.end(), sortByPT);
        std::sort(signalBJets.begin(), signalBJets.end(), sortByPT);
        std::sort(signalNonBJets.begin(), signalNonBJets.end(), sortByPT);

        for (const HEPUtils::Particle* electron : baselineElectrons) {
          signalElectrons.push_back(electron);
        }

        for (const HEPUtils::Particle* muon : baselineMuons) {
          signalMuons.push_back(muon);
        }

        // We now have the signal electrons, muons, jets and b jets- move on to the analysis

        // Calculate common variables and cuts first
        int nElectrons = signalElectrons.size();
        int nMuons = signalMuons.size();
        int nJets = signalJets.size();

        //Lepton veto
        bool cut_LeptonVeto=true;
        if((nElectrons + nMuons)&gt;0.)cut_LeptonVeto=false;

        //Calculate dphi(jet,met) for the three leading jets
        bool cut_dPhiJets=false;
        bool cut_dPhiJet3=false;
        bool cut_dPhiJet2=false;
        bool cut_dPhiJet1=false;
        double dphi_jetmet1=9999;
        if(nJets&gt;0)dphi_jetmet1=std::acos(std::cos(signalJets.at(0)-&gt;phi()-ptot.phi()));
        double dphi_jetmet2=9999;
        if(nJets&gt;1)dphi_jetmet2=std::acos(std::cos(signalJets.at(1)-&gt;phi()-ptot.phi()));
        double dphi_jetmet3=9999;
        if(nJets&gt;2)dphi_jetmet3=std::acos(std::cos(signalJets.at(2)-&gt;phi()-ptot.phi()));

        if(dphi_jetmet3&gt;3.14/fabs(5.0))cut_dPhiJet3=true;
        if(dphi_jetmet2&gt;3.14/fabs(5.0))cut_dPhiJet2=true;
        if(dphi_jetmet1&gt;3.14/fabs(5.0))cut_dPhiJet1=true;
        if(cut_dPhiJet1 &amp;&amp; cut_dPhiJet2 &amp;&amp; cut_dPhiJet3)cut_dPhiJets=true;

        //Number of b jets
        bool passBJetCut=false;
        if(signalBJets.size()&gt;=2)passBJetCut=true;
        //MET &gt; 150 GeV
        bool cut_METGt150=false;
        if(met&gt;150.)cut_METGt150=true;

        //Calculate dphi(b,met) for the closest b-jet in phi to MET
        double dphi_bjetmet_min=9999.;
        double minphi =9999.;
        int whichb=0;
        for(size_t j=0; j&lt;signalBJets.size(); j++) {
          if(fabs(std::acos(std::cos(signalBJets.at(j)-&gt;phi()-ptot.phi())))&lt;minphi) {
            minphi = fabs(std::acos(std::cos(signalBJets.at(j)-&gt;phi()-ptot.phi())));
            dphi_bjetmet_min = minphi;
            whichb=j;

          }
        }


        double mT_bjetmet_min = 0;
        if(passBJetCut) mT_bjetmet_min = sqrt(2*signalBJets.at(whichb)-&gt;pT()*met*(1-std::cos(dphi_bjetmet_min)));

        bool cut_mTbjetmetGt175=false;
        if(mT_bjetmet_min&gt;175.)cut_mTbjetmetGt175=true;

        //Calculate dphi(b,met) for the furthest b-jet in phi to MET
        double dphi_bjetmet_max=0.;
        double maxphi =0.;
        int whichb_max=0;
        for(size_t j=0; j&lt;signalBJets.size(); j++) {

          if(fabs(std::acos(std::cos(signalBJets.at(j)-&gt;phi()-ptot.phi())))&gt;maxphi) {
            maxphi = fabs(std::acos(std::cos(signalBJets.at(j)-&gt;phi()-ptot.phi())));
            dphi_bjetmet_max = maxphi;
            whichb_max=j;
          }
        }

        double mT_bjetmet_max = 0;

        if(passBJetCut) mT_bjetmet_max = sqrt(2*signalBJets.at(whichb_max)-&gt;pT()*met*(1-std::cos(dphi_bjetmet_max)));

        //Common preselection for all signal regions in the fully resolved case
        bool passJetCutSRA=false;

        if(nJets&gt;=6){
          if(signalJets[0]-&gt;pT() &gt; 80.
             &amp;&amp; signalJets[1]-&gt;pT() &gt; 80.
             &amp;&amp; signalJets[2]-&gt;pT() &gt; 35.
             &amp;&amp; signalJets[3]-&gt;pT() &gt; 35.
             &amp;&amp; signalJets[4]-&gt;pT() &gt; 35.
             &amp;&amp; signalJets[5]-&gt;pT() &gt; 35.)passJetCutSRA=true;
        }

        //mjjj combinations

        HEPUtils::P4 mbjj0, mbjj1;

        double mindphi_12 = 9999.;

        HEPUtils::P4 W1;
        HEPUtils::P4 W2;
        HEPUtils::P4 T1;
        HEPUtils::P4 T2;
        HEPUtils::P4 jet1;
        HEPUtils::P4 jet2;
        HEPUtils::P4 jet3;
        HEPUtils::P4 jet4;
        HEPUtils::P4 jet5;
        HEPUtils::P4 jet6;

        //Need to form top quark four vectors from jets
        //Use the two leading b jets as the b jets (a slight departure from ATLAS which uses the two jets with the highest b weight)

        vector&lt;const HEPUtils::Jet*&gt; selectBJets;
        vector&lt;const HEPUtils::Jet*&gt; selectNonBJets;
        int bjetcount=0;

        for (const HEPUtils::Jet* jet : signalBJets) {
          if(bjetcount&lt;2){
            bjetcount++;
            selectBJets.push_back(jet);
          }
        }

        //Now take any remaining jets in b jet collection plus the non b jets
        int i=0;
        for (const HEPUtils::Jet* jet : signalBJets) {
          i++;
          if(i&gt;2)selectNonBJets.push_back(jet);
        }

        for (const HEPUtils::Jet* jet : signalNonBJets){
          selectNonBJets.push_back(jet);
        }

        if(nJets&gt;=6 and bjetcount==2) {
          unsigned int j1 = 0 ; unsigned int j2 = 0; //unsigned int j4 = 0; unsigned int j5 = 0; //int j6 = 0;
          unsigned int b1 = 0;
          for(unsigned int k=0; k&lt;selectNonBJets.size(); k++) {
            for(unsigned int l=k+1; l&lt;selectNonBJets.size(); l++) {
        jet1.setXYZE(selectNonBJets[k]-&gt;mom().px(),selectNonBJets[k]-&gt;mom().py(),selectNonBJets[k]-&gt;mom().pz(),selectNonBJets[k]-&gt;E());
        jet2.setXYZE(selectNonBJets[l]-&gt;mom().px(),selectNonBJets[l]-&gt;mom().py(),selectNonBJets[l]-&gt;mom().pz(),selectNonBJets[l]-&gt;E());

        if(jet1.deltaR_eta(jet2)&lt;mindphi_12) {
                j1 = k;
                j2 = l;
                mindphi_12 = jet1.deltaR_eta(jet2);
                W1 = jet1+jet2;

              }

            }
          }


          double mindphi_w1j3 = 9999.;
          for(unsigned int p=0; p&lt;selectBJets.size(); p++) {

            jet3.setXYZE(selectBJets[p]-&gt;mom().px(),selectBJets[p]-&gt;mom().py(),selectBJets[p]-&gt;mom().pz(),selectBJets[p]-&gt;E());
            if(jet3.deltaR_eta(W1)&lt;mindphi_w1j3) {
              b1 = p;
              mindphi_w1j3 = jet3.deltaR_eta(W1);
              T1 = W1+jet3;

            }
          }

          double mindphi_45 = 9999.;
          for(unsigned int k=0; k&lt;selectNonBJets.size(); k++) {
            for(unsigned int l=k; l&lt;selectNonBJets.size(); l++) {
              if(k!=j1 &amp;&amp; k!=j2 &amp;&amp; l!=j1 &amp;&amp; l!=j2) {

                jet4.setXYZE(selectNonBJets[k]-&gt;mom().px(),selectNonBJets[k]-&gt;mom().py(),selectNonBJets[k]-&gt;mom().pz(),selectNonBJets[k]-&gt;E());
                jet5.setXYZE(selectNonBJets[l]-&gt;mom().px(),selectNonBJets[l]-&gt;mom().py(),selectNonBJets[l]-&gt;mom().pz(),selectNonBJets[l]-&gt;E());

                if(jet4.deltaR_eta(jet5)&lt;mindphi_45) {
                  //j4 = k;
                  //j5 = l;
                  mindphi_45 = jet4.deltaR_eta(jet5);
                  W2 = jet4+jet5;

                }
              }
            }
          }
          double mindphi_w2j6 = 9999.;
          for(unsigned int p=0; p&lt;selectBJets.size(); p++) {
            if(p!=b1) {

              jet6.setXYZE(selectBJets[p]-&gt;mom().px(),selectBJets[p]-&gt;mom().py(),selectBJets[p]-&gt;mom().pz(),selectBJets[p]-&gt;E());

              if(jet6.deltaR_eta(W2)&lt;mindphi_w2j6) {
                //j6 = p;
                mindphi_w2j6 = jet6.deltaR_eta(W2);
                T2 = W2+jet6;

              }
            }
          }
          mbjj0 = T1;
          mbjj1 = T2;
        }

        bool cut_tau=true;

        /*
        //Tau Veto
        for (int j=0; j&lt;signalNonBJets.size(); j++) {
        if(std::acos(std::cos(signalNonBJets.at(j)-&gt;phi()-ptot.phi()))&lt;0.2*3.14)
        cut_tau=false;
        }*/

        //Cutflow flags
        //bool cut_mjjj0=false;
        //bool cut_mjjj1=false;

        bool cut_6jets=false;
        bool cut_Btag=false;

        bool cut_METGt130=false;
        //bool cut_METGt200=false;
        bool cut_METGt250=false;
        bool cut_METGt300=false;
        bool cut_METGt350=false;


        if(passJetCutSRA)cut_6jets=true;
        if(passBJetCut)cut_Btag=true;
        if(met&gt;130.)cut_METGt130=true;
        if(met&gt;250.)cut_METGt250=true;
        if(met&gt;300.)cut_METGt300=true;
        if(met&gt;350.)cut_METGt350=true;
        //if(nJets&gt;=6) {
        //if(mbjj0.m()&lt;270 &amp;&amp; mjjj0.m()&gt;80) cut_mjjj0=true;
        //if(mjjj1.m()&lt;270 &amp;&amp; mjjj1.m()&gt;80) cut_mjjj1=true;
        //}

        //Calculate min transverse mass between signal jets and ptmiss

        double mtMin=9999;
        for(const HEPUtils::Jet* jet : signalJets){
          double dphi_jetmet=std::acos(std::cos(jet-&gt;phi()-ptot.phi()));
          double mT=sqrt(2.*jet-&gt;pT()*met*(1. - cos(dphi_jetmet)));
          if(mT&lt;mtMin)mtMin=mT;
        }

        bool isSRA1=false;
        bool isSRA2=false;
        bool isSRA3=false;
        bool isSRA4=false;

        if(cut_LeptonVeto &amp;&amp; cut_Btag &amp;&amp; cut_METGt150 &amp;&amp; cut_dPhiJets &amp;&amp; cut_mTbjetmetGt175 &amp;&amp; cut_6jets &amp;&amp; mbjj0.m() &lt; 225. &amp;&amp; mbjj1.m() &lt; 250. &amp;&amp; cut_tau &amp;&amp; cut_METGt150)isSRA1=true;

        if(cut_LeptonVeto &amp;&amp; cut_Btag &amp;&amp; cut_METGt150 &amp;&amp; cut_dPhiJets &amp;&amp; cut_mTbjetmetGt175 &amp;&amp; cut_6jets &amp;&amp; mbjj0.m() &lt; 225. &amp;&amp; mbjj1.m() &lt; 250. &amp;&amp; cut_tau &amp;&amp; cut_METGt250)isSRA2=true;

        if(cut_LeptonVeto &amp;&amp; cut_Btag &amp;&amp; cut_METGt150 &amp;&amp; cut_dPhiJets &amp;&amp; cut_mTbjetmetGt175 &amp;&amp; cut_6jets &amp;&amp; mbjj0.m() &gt; 50. &amp;&amp; mbjj0.m() &lt; 250. &amp;&amp; mbjj1.m() &gt; 50. &amp;&amp; mbjj1.m() &lt; 400. &amp;&amp; mtMin &gt; 50. &amp;&amp; cut_tau &amp;&amp; cut_METGt300)isSRA3=true;

        if(cut_LeptonVeto &amp;&amp; cut_Btag &amp;&amp; cut_METGt150 &amp;&amp; cut_dPhiJets &amp;&amp; cut_mTbjetmetGt175 &amp;&amp; cut_6jets &amp;&amp; mbjj0.m() &gt; 50. &amp;&amp; mbjj0.m() &lt; 250. &amp;&amp; mbjj1.m() &gt; 50. &amp;&amp; mbjj1.m() &lt; 400. &amp;&amp; mtMin &gt; 50. &amp;&amp; cut_tau &amp;&amp; cut_METGt350)isSRA4=true;

        //Now do the mixed regions

        //Find highest pT b jet
        //Should no longe be necessary due to sorting of b jet collection
        /*double leadBJetPt=0;
          double leadBJetID=0;

          if(passBJetCut){
          for(int j=0; j&lt;nJets; j++) {
          if(signalJets[j]-&gt;btag()&amp;&amp;signalJets[j]-&gt;pT()&gt;leadBJetPt){
          leadBJetPt=signalJets[j]-&gt;pT();
          leadBJetID=j;
          }
          }
          }

          //Find sub-leading pT b jet
          double subBJetPt=0;
          double subBJetID=0;

          if(passBJetCut){
          for(int j=0; j&lt;nJets; j++) {
          if(signalJets[j]-&gt;btag()&amp;&amp;signalJets[j]-&gt;pT()&gt;subBJetPt &amp;&amp; j!=leadBJetPt){
          subBJetPt=signalJets[j]-&gt;pT();
          subBJetID=j;
          }
          }
          }*/

        //Work out dPhi between B jets
        double dPhiBB=0;
        double leadBJetID=0;
        double subBJetID=1;
        if(passBJetCut){
          dPhiBB=std::acos(std::cos(signalBJets.at(leadBJetID)-&gt;phi()-signalBJets.at(subBJetID)-&gt;phi()));
        }

        bool passJetCutSRC=false;

        /*std::cout &lt;&lt; &quot;JET PT CHECK &quot;;
          for(const HEPUtils::Jet* jet : signalJets){
          std::cout &lt;&lt; jet-&gt;pT() &lt;&lt; &quot; &quot;;
          }
          std::cout &lt;&lt; endl;*/

        if(nJets==5){
          if(signalJets[0]-&gt;pT() &gt; 80.
             &amp;&amp; signalJets[1]-&gt;pT() &gt; 80.
             &amp;&amp; signalJets[2]-&gt;pT() &gt; 35.
             &amp;&amp; signalJets[3]-&gt;pT() &gt; 35.
             &amp;&amp; signalJets[4]-&gt;pT() &gt; 35.)passJetCutSRC=true;
        }

        bool isSRC1=false;
        bool isSRC2=false;
        bool isSRC3=false;

        if(cut_LeptonVeto &amp;&amp; cut_Btag &amp;&amp; cut_METGt150 &amp;&amp; cut_dPhiJets &amp;&amp; cut_mTbjetmetGt175 &amp;&amp; cut_tau){

          if(passJetCutSRC &amp;&amp; mT_bjetmet_min &gt; 185. &amp;&amp; mT_bjetmet_max&gt;205. &amp;&amp; met&gt;160. &amp;&amp; dPhiBB &gt; (0.2*3.14))isSRC1=true;

          if(passJetCutSRC &amp;&amp; mT_bjetmet_min &gt; 200. &amp;&amp; mT_bjetmet_max&gt;290. &amp;&amp; met&gt;160. &amp;&amp; dPhiBB &gt; (0.2*3.14))isSRC2=true;

          if(passJetCutSRC &amp;&amp; mT_bjetmet_min &gt; 200. &amp;&amp; mT_bjetmet_max&gt;325. &amp;&amp; met&gt;215. &amp;&amp; dPhiBB &gt; (0.2*3.14))isSRC3=true;

        }

        cutFlowVector_str[0] = &quot;No cuts &quot;;
        cutFlowVector_str[1] = &quot;MET &gt; 130 GeV &quot;;
        cutFlowVector_str[2] = &quot;Lepton veto &quot;;
        cutFlowVector_str[3] = &quot;MET &gt; 150 GeV &quot;;
        cutFlowVector_str[4] = &quot;Jet multiplicity and pT &quot;;
        cutFlowVector_str[5] = &quot;dPhi(jet,MET) &gt; pi/5 &quot;;
        cutFlowVector_str[6] = &quot;&gt;=2 b jets &quot;;
        cutFlowVector_str[7] = &quot;tau veto &quot;;
        cutFlowVector_str[8] = &quot;mT(b,MET) &gt; 175 &quot;;
        cutFlowVector_str[9] = &quot;SRA1 &quot;;
        cutFlowVector_str[10] = &quot;SRA2 &quot;;
        cutFlowVector_str[11] = &quot;SRA3 &quot;;
        cutFlowVector_str[12] = &quot;SRA4 &quot;;
        cutFlowVector_str[13] = &quot;SRC: exactly 5 jets &quot;;
        cutFlowVector_str[14] = &quot;SRC: dPhi(jet,MET) &quot;;
        cutFlowVector_str[15] = &quot;SRC: &gt;=2 b jets &quot;;
        cutFlowVector_str[16] = &quot;SRC: tau veto &quot;;
        cutFlowVector_str[17] = &quot;SRC: dPhi(b,b) &quot;;
        cutFlowVector_str[18] = &quot;SRC1&quot;;
        cutFlowVector_str[19] = &quot;SRC2&quot;;
        cutFlowVector_str[20] = &quot;SRC3&quot;;

        for(int j=0;j&lt;NCUTS;j++){
          if(
             (j==0) ||

             (j==1 &amp;&amp; cut_METGt130) ||

             (j==2 &amp;&amp; cut_METGt130 &amp;&amp; cut_LeptonVeto) ||

             (j==3 &amp;&amp; cut_METGt150 &amp;&amp; cut_LeptonVeto) ||

             (j==4 &amp;&amp; cut_METGt150 &amp;&amp; cut_LeptonVeto &amp;&amp; cut_6jets) ||

             (j==5 &amp;&amp; cut_METGt150 &amp;&amp; cut_LeptonVeto &amp;&amp; cut_6jets &amp;&amp; cut_dPhiJets) ||

             (j==6 &amp;&amp; cut_METGt150 &amp;&amp; cut_LeptonVeto &amp;&amp; cut_6jets &amp;&amp; cut_dPhiJets &amp;&amp; cut_Btag) ||

             (j==7 &amp;&amp; cut_METGt150 &amp;&amp; cut_LeptonVeto &amp;&amp; cut_6jets &amp;&amp; cut_dPhiJets &amp;&amp; cut_Btag &amp;&amp; cut_tau) ||

             (j==8 &amp;&amp; cut_METGt150 &amp;&amp; cut_LeptonVeto &amp;&amp; cut_6jets &amp;&amp; cut_dPhiJets &amp;&amp; cut_Btag &amp;&amp; cut_tau &amp;&amp; cut_mTbjetmetGt175) ||

             (j==9 &amp;&amp; cut_METGt150 &amp;&amp; cut_LeptonVeto &amp;&amp; cut_6jets &amp;&amp; cut_dPhiJets &amp;&amp; cut_Btag &amp;&amp; cut_tau &amp;&amp; cut_mTbjetmetGt175 &amp;&amp; isSRA1) ||

             (j==10 &amp;&amp; cut_METGt150 &amp;&amp; cut_LeptonVeto &amp;&amp; cut_6jets &amp;&amp; cut_dPhiJets &amp;&amp; cut_Btag &amp;&amp; cut_tau &amp;&amp; cut_mTbjetmetGt175 &amp;&amp; isSRA2) ||

             (j==11 &amp;&amp; cut_METGt150 &amp;&amp; cut_LeptonVeto &amp;&amp; cut_6jets &amp;&amp; cut_dPhiJets &amp;&amp; cut_Btag &amp;&amp; cut_tau &amp;&amp; cut_mTbjetmetGt175 &amp;&amp; isSRA3) ||

             (j==12 &amp;&amp; cut_METGt150 &amp;&amp; cut_LeptonVeto &amp;&amp; cut_6jets &amp;&amp; cut_dPhiJets &amp;&amp; cut_Btag &amp;&amp; cut_tau &amp;&amp; cut_mTbjetmetGt175 &amp;&amp; isSRA4) ||

             (j==13 &amp;&amp; cut_METGt150 &amp;&amp; cut_LeptonVeto &amp;&amp; passJetCutSRC) ||

             (j==14 &amp;&amp; cut_METGt150 &amp;&amp; cut_LeptonVeto &amp;&amp; passJetCutSRC &amp;&amp; cut_dPhiJets) ||

             (j==15 &amp;&amp; cut_METGt150 &amp;&amp; cut_LeptonVeto &amp;&amp; passJetCutSRC &amp;&amp; cut_dPhiJets &amp;&amp; cut_Btag) ||

             (j==16 &amp;&amp; cut_METGt150 &amp;&amp; cut_LeptonVeto &amp;&amp; passJetCutSRC &amp;&amp; cut_dPhiJets &amp;&amp; cut_Btag &amp;&amp; cut_tau) ||

             (j==17 &amp;&amp; cut_METGt150 &amp;&amp; cut_LeptonVeto &amp;&amp; passJetCutSRC &amp;&amp; cut_dPhiJets &amp;&amp; cut_Btag &amp;&amp; cut_tau &amp;&amp; dPhiBB &gt; (0.2*3.14)) ||

             (j==18 &amp;&amp; isSRC1) ||

             (j==19 &amp;&amp; isSRC2) ||

             (j==20 &amp;&amp; isSRC3)

             ){

            cutFlowVector[j]++;

          }
        }


        /*for(int j=0;j&lt;NCUTS;j++){
          if(
          (j==0) ||

          (j==1 &amp;&amp; cut_MuonVeto) ||

          (j==2 &amp;&amp; cut_ElectronVeto &amp;&amp; cut_MuonVeto) ||

          (j==3 &amp;&amp; cut_ElectronVeto &amp;&amp; cut_MuonVeto &amp;&amp; cut_METGt130) ||

          (j==4 &amp;&amp; cut_ElectronVeto &amp;&amp; cut_MuonVeto &amp;&amp; cut_METGt130 &amp;&amp; cut_6jets) ||

          (j==5 &amp;&amp; cut_ElectronVeto &amp;&amp; cut_MuonVeto &amp;&amp; cut_METGt130 &amp;&amp; cut_6jets &amp;&amp; cut_dPhiJets) ||

          (j==6 &amp;&amp; cut_ElectronVeto &amp;&amp; cut_MuonVeto &amp;&amp; cut_METGt130 &amp;&amp; cut_6jets &amp;&amp; cut_dPhiJets &amp;&amp; cut_tau) ||

          (j==7 &amp;&amp; cut_ElectronVeto &amp;&amp; cut_MuonVeto &amp;&amp; cut_METGt130 &amp;&amp; cut_6jets &amp;&amp; cut_dPhiJets &amp;&amp; cut_tau &amp;&amp; cut_Btag) ||

          (j==8 &amp;&amp; cut_ElectronVeto &amp;&amp; cut_MuonVeto &amp;&amp; cut_METGt130 &amp;&amp; cut_6jets &amp;&amp; cut_dPhiJets &amp;&amp; cut_tau &amp;&amp; cut_Btag &amp;&amp; cut_mTbjetmetGt175) ||

          (j==9 &amp;&amp; cut_ElectronVeto &amp;&amp; cut_MuonVeto &amp;&amp; cut_METGt130 &amp;&amp; cut_6jets &amp;&amp; cut_dPhiJets &amp;&amp; cut_tau &amp;&amp; cut_Btag &amp;&amp; cut_mTbjetmetGt175 &amp;&amp; cut_mjjj0) ||

          (j==10 &amp;&amp; cut_ElectronVeto &amp;&amp; cut_MuonVeto &amp;&amp; cut_METGt130 &amp;&amp; cut_6jets &amp;&amp; cut_dPhiJets &amp;&amp; cut_tau &amp;&amp; cut_Btag &amp;&amp; cut_mTbjetmetGt175 &amp;&amp; cut_mjjj0 &amp;&amp; cut_mjjj1) ||

          (j==11 &amp;&amp; cut_ElectronVeto &amp;&amp; cut_MuonVeto &amp;&amp; cut_METGt130 &amp;&amp; cut_6jets &amp;&amp; cut_dPhiJets &amp;&amp; cut_tau &amp;&amp; cut_Btag &amp;&amp; cut_mTbjetmetGt175 &amp;&amp; cut_mjjj0 &amp;&amp; cut_mjjj1 &amp;&amp; cut_METGt150) ||

          (j==12 &amp;&amp; cut_ElectronVeto &amp;&amp; cut_MuonVeto &amp;&amp; cut_METGt130 &amp;&amp; cut_6jets &amp;&amp; cut_dPhiJets &amp;&amp; cut_tau &amp;&amp; cut_Btag &amp;&amp; cut_mTbjetmetGt175 &amp;&amp; cut_mjjj0 &amp;&amp; cut_mjjj1 &amp;&amp; cut_METGt200) ||

          (j==13 &amp;&amp; cut_ElectronVeto &amp;&amp; cut_MuonVeto &amp;&amp; cut_METGt130 &amp;&amp; cut_6jets &amp;&amp; cut_dPhiJets &amp;&amp; cut_tau &amp;&amp; cut_Btag &amp;&amp; cut_mTbjetmetGt175 &amp;&amp; cut_mjjj0 &amp;&amp; cut_mjjj1 &amp;&amp; cut_METGt250) ||

          (j==14 &amp;&amp; cut_ElectronVeto &amp;&amp; cut_MuonVeto &amp;&amp; cut_METGt130 &amp;&amp; cut_6jets &amp;&amp; cut_dPhiJets &amp;&amp; cut_tau &amp;&amp; cut_Btag &amp;&amp; cut_mTbjetmetGt175 &amp;&amp; cut_mjjj0 &amp;&amp; cut_mjjj1 &amp;&amp; cut_METGt300) ||

          (j==15 &amp;&amp; cut_ElectronVeto &amp;&amp; cut_MuonVeto &amp;&amp; cut_METGt130 &amp;&amp; cut_6jets &amp;&amp; cut_dPhiJets &amp;&amp; cut_tau &amp;&amp; cut_Btag &amp;&amp; cut_mTbjetmetGt175 &amp;&amp; cut_mjjj0 &amp;&amp; cut_mjjj1 &amp;&amp; cut_METGt350) )


          cutFlowVector[j]++;
          }*/

        //We're now ready to apply the cuts for each signal region
        //_numSR1, _numSR2, _numSR3;

        if(isSRA1) _numSRA1 += event-&gt;weight();
        if(isSRA2) _numSRA2 += event-&gt;weight();
        if(isSRA3) _numSRA3 += event-&gt;weight();
        if(isSRA4) _numSRA4 += event-&gt;weight();

        if(isSRC1) _numSRC1 += event-&gt;weight();
        if(isSRC2) _numSRC2 += event-&gt;weight();
        if(isSRC3) _numSRC3 += event-&gt;weight();

        return;

      }

      void combine(const Analysis* other)
      {
        const Analysis_ATLAS_8TeV_0LEPStop_20invfb* specificOther
                = dynamic_cast&lt;const Analysis_ATLAS_8TeV_0LEPStop_20invfb*&gt;(other);

        if (NCUTS != specificOther-&gt;NCUTS) NCUTS = specificOther-&gt;NCUTS;
        for (int j=0; j&lt;NCUTS; j++) {
          cutFlowVector[j] += specificOther-&gt;cutFlowVector[j];
          cutFlowVector_str[j] = specificOther-&gt;cutFlowVector_str[j];
        }
        _numSRA1 += specificOther-&gt;_numSRA1;
        _numSRA2 += specificOther-&gt;_numSRA2;
        _numSRA3 += specificOther-&gt;_numSRA3;
        _numSRA4 += specificOther-&gt;_numSRA4;
        _numSRC1 += specificOther-&gt;_numSRC1;
        _numSRC2 += specificOther-&gt;_numSRC2;
        _numSRC3 += specificOther-&gt;_numSRC3;
      }


      void collect_results() {

        // add_result(SignalRegionData(&quot;SR label&quot;, n_obs, {n_sig_MC, n_sig_MC_sys}, {n_bkg, n_bkg_err}));

        add_result(SignalRegionData(&quot;SRA1&quot;, 11., {_numSRA1, 0.}, {15.8, 1.9}));
        add_result(SignalRegionData(&quot;SRA2&quot;, 4., {_numSRA2, 0.}, {4.1, 0.8}));
        add_result(SignalRegionData(&quot;SRA3&quot;, 5., {_numSRA3, 0.}, {4.1, 0.9}));
        add_result(SignalRegionData(&quot;SRA4&quot;, 4., {_numSRA4, 0.}, {2.4, 0.7}));
        add_result(SignalRegionData(&quot;SRC1&quot;, 59., {_numSRC1, 0.}, {68., 7.}));
        add_result(SignalRegionData(&quot;SRC2&quot;, 30., {_numSRC2, 0.}, {34., 5.}));
        add_result(SignalRegionData(&quot;SRC3&quot;, 15., {_numSRC3, 0.}, {20.3, 3.}));

        return;
      }


    protected:
      void analysis_specific_reset() {
        _numSRA1 = 0 ; _numSRA2 = 0; _numSRA3 = 0; _numSRA4 = 0;
        _numSRC1 = 0 ; _numSRC2 = 0; _numSRC3 = 0;

        std::fill(cutFlowVector.begin(), cutFlowVector.end(), 0);
      }

    };

    DEFINE_ANALYSIS_FACTORY(ATLAS_8TeV_0LEPStop_20invfb)


  }
}
</code></pre><hr><p>Updated on 2022-08-02 at 18:18:37 +0000</p><div class=edit-page><a href=https://github.com/RC1242RC/gambit_gh_pages/blob/master/content/en/documentation/code/main/Files/Analysis__ATLAS__8TeV__0LEPStop__20invfb_8cpp.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on GitHub</a></div></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a class=text-muted href=https://www.netlify.com/>Netlify</a>, <a class=text-muted href=https://gohugo.io/>Hugo</a>, and <a class=text-muted href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline><li class=list-inline-item><a href=/license/>License</a></li></ul></div></div></div></footer><script src=/js/bootstrap.min.54bf0932b8a36d0e152b1635b099a6ef1394d35327e2437550a075c9c8ed1bd8aed5847c21b36fc02ed24014c031d9ca24017b0c78b1639d7e2fa8329898b842.js integrity="sha512-VL8JMrijbQ4VKxY1sJmm7xOU01Mn4kN1UKB1ycjtG9iu1YR8IbNvwC7SQBTAMdnKJAF7DHixY51+L6gymJi4Qg==" crossorigin=anonymous defer></script>
<script src=/js/highlight.min.5b48bc253dc75aeea5fb366ecf700f4925e2b6eb1a1466f2124b722d68148d67bc0a9365d2b8ad9c585161b46372d23b08509a16f1fd518542b894756d4752d0.js integrity="sha512-W0i8JT3HWu6l+zZuz3APSSXitusaFGbyEktyLWgUjWe8CpNl0ritnFhRYbRjctI7CFCaFvH9UYVCuJR1bUdS0A==" crossorigin=anonymous defer></script>
<script src=/main.min.40265e9a032aeba5eaf67baac3cbbc22667a7533215d326eeb3e9f4d5e4be40f9ff4dcd22949db73ae527ca26a19d7998091a8973c82af760b2c0daa335190ed.js integrity="sha512-QCZemgMq66Xq9nuqw8u8ImZ6dTMhXTJu6z6fTV5L5A+f9NzSKUnbc65SfKJqGdeZgJGolzyCr3YLLA2qM1GQ7Q==" crossorigin=anonymous defer></script>
<script src=https://rc1242rc.github.io/index.min.bf15e814991a9d3ef02f52a26d135d3cd0a098afc407e971daad9f276d437236be129db79cd96bd09f86d0730d8272253cdaff9edd528739d4fc2013efa8d4ba.js integrity="sha512-vxXoFJkanT7wL1KibRNdPNCgmK/EB+lx2q2fJ21Dcja+Ep23nNlr0J+G0HMNgnIlPNr/nt1ShznU/CAT76jUug==" crossorigin=anonymous defer></script></body></html>