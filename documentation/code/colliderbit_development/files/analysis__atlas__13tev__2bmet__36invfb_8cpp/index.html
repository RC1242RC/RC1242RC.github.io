<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://rc1242rc.github.io/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://rc1242rc.github.io/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://rc1242rc.github.io/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var e=localStorage.getItem("theme");e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=https://rc1242rc.github.io/main.f12f7e04ea768acebec10c86baf049d74d6a79f24bc0dfb7ed77aa60462432916dd1ce8f41c78b69496adf650b3039a28a210183cce598f09b95d6fecb5ff999.css integrity="sha512-8S9+BOp2is6+wQyGuvBJ101qefJLwN+37XeqYEYkMpFt0c6PQceLaUlq32ULMDmiiiEBg8zlmPCbldb+y1/5mQ==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>file analyses/Analysis_ATLAS_13TeV_2bMET_36invfb.cpp - GAMBIT</title><meta name=description content="[No description available]"><link rel=canonical href=https://rc1242rc.github.io/documentation/code/colliderbit_development/files/analysis__atlas__13tev__2bmet__36invfb_8cpp/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="file analyses/Analysis_ATLAS_13TeV_2bMET_36invfb.cpp"><meta property="og:description" content="[No description available]"><meta property="og:url" content="https://rc1242rc.github.io/documentation/code/colliderbit_development/files/analysis__atlas__13tev__2bmet__36invfb_8cpp/"><meta property="og:site_name" content="GAMBIT"><meta property="og:image" content="https://rc1242rc.github.io/gambit_logo.png"><meta property="og:image:alt" content="GAMBIT"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content><meta name=twitter:creator content><meta name=twitter:title content="file analyses/Analysis_ATLAS_13TeV_2bMET_36invfb.cpp"><meta name=twitter:description content="[No description available]"><meta name=twitter:image content="https://rc1242rc.github.io/gambit_logo.png"><meta name=twitter:image:alt content="file analyses/Analysis_ATLAS_13TeV_2bMET_36invfb.cpp"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://rc1242rc.github.io/#/schema/organization/1","name":"Doks","url":"https://rc1242rc.github.io/","sameAs":["https://github.com/GambitBSM"],"logo":{"@type":"ImageObject","@id":"https://rc1242rc.github.io/#/schema/image/1","url":"https://rc1242rc.github.io/logo-doks.png","width":450,"height":416,"caption":"Doks"},"image":{"@id":"https://rc1242rc.github.io/#/schema/image/1"}},{"@type":"WebSite","@id":"https://rc1242rc.github.io/#/schema/website/1","url":"https://rc1242rc.github.io/","name":"GAMBIT","description":"Documentation for the Global And Modular BSM Inference Tool","publisher":{"@id":"https://rc1242rc.github.io/#/schema/organization/1"}},{"@type":"WebPage","@id":"https://rc1242rc.github.io/documentation/code/colliderbit_development/files/analysis__atlas__13tev__2bmet__36invfb_8cpp/","url":"https://rc1242rc.github.io/documentation/code/colliderbit_development/files/analysis__atlas__13tev__2bmet__36invfb_8cpp/","name":"file analyses\/Analysis_ATLAS_13TeV_2bMET_36invfb.cpp","description":"[No description available]","isPartOf":{"@id":"https://rc1242rc.github.io/#/schema/website/1"},"about":{"@id":"https://rc1242rc.github.io/#/schema/organization/1"},"datePublished":"0001-01-01T00:00:00CET","dateModified":"0001-01-01T00:00:00CET","breadcrumb":{"@id":"https://rc1242rc.github.io/documentation/code/colliderbit_development/files/analysis__atlas__13tev__2bmet__36invfb_8cpp/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://rc1242rc.github.io/documentation/code/colliderbit_development/files/analysis__atlas__13tev__2bmet__36invfb_8cpp/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://rc1242rc.github.io/documentation/code/colliderbit_development/files/analysis__atlas__13tev__2bmet__36invfb_8cpp/"]}]},{"@type":"BreadcrumbList","@id":"https://rc1242rc.github.io/documentation/code/colliderbit_development/files/analysis__atlas__13tev__2bmet__36invfb_8cpp/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://rc1242rc.github.io/","url":"https://rc1242rc.github.io/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://rc1242rc.github.io/documentation/","url":"https://rc1242rc.github.io/documentation/","name":"Documentation"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://rc1242rc.github.io/documentation/code/","url":"https://rc1242rc.github.io/documentation/code/","name":"Code"}},{"@type":"ListItem","position":4,"item":{"@type":"WebPage","@id":"https://rc1242rc.github.io/documentation/code/colliderbit_development/","url":"https://rc1242rc.github.io/documentation/code/colliderbit_development/","name":"Colliderbit Development"}},{"@type":"ListItem","position":5,"item":{"@type":"WebPage","@id":"https://rc1242rc.github.io/documentation/code/colliderbit_development/files/","url":"https://rc1242rc.github.io/documentation/code/colliderbit_development/files/","name":"Files"}},{"@type":"ListItem","position":6,"item":{"@id":"https://rc1242rc.github.io/documentation/code/colliderbit_development/files/analysis__atlas__13tev__2bmet__36invfb_8cpp/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://rc1242rc.github.io/documentation/code/colliderbit_development/files/analysis__atlas__13tev__2bmet__36invfb_8cpp/#/schema/image/2","url":"https://rc1242rc.github.io/gambit_logo.png","contentUrl":"https://rc1242rc.github.io/gambit_logo.png","caption":"file analyses\/Analysis_ATLAS_13TeV_2bMET_36invfb.cpp"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=https://rc1242rc.github.io/favicon.ico sizes=any><link rel=icon type=image/svg+xml href=https://rc1242rc.github.io/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=https://rc1242rc.github.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://rc1242rc.github.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://rc1242rc.github.io/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://rc1242rc.github.io/site.webmanifest></head><body class="documentation single light"><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-md navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-md-nowrap" aria-label="Main navigation"><a class="navbar-brand p-0 me-auto" href=https://rc1242rc.github.io/ aria-label=GAMBIT><img class=logo-light src=https://rc1242rc.github.io//images/gambit_logo.png width=50px>
<img class="logo-dark d-none" src=https://rc1242rc.github.io//images/gambit_logo.png width=50px>
GAMBIT</a>
<button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=/>GAMBIT</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Documentation
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=/documentation/installation/introduction/>Installation</a></li><li><a class=dropdown-item href=/documentation/examples/colliderbit>Examples</a></li><li><a class=dropdown-item href=/documentation/help/faqs/>Help</a></li><li><a class=dropdown-item href=/documentation/code/index_classes>Code Reference</a></li></ul></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Community
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=/community/publications/>Publications</a></li><li><a class=dropdown-item href=/community/talks/>Talks</a></li><li><a class=dropdown-item href=/community/members/>Members</a></li><li><a class=dropdown-item href=/community/code_of_conduct/>Code of Conduct</a></li><li><a class=dropdown-item href=/community/contact/>Contact</a></li></ul></li></ul><hr class="text-black-50 my-4 d-lg-none"><form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2"><input id=search class="form-control is-search" type=search placeholder="Search site..." aria-label="Search site..." autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=https://github.com/GambitBSM><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-lg-none">GitHub</small></a></li></ul><hr class="text-black-50 my-4 d-lg-none"><div class=dropdown><button class="btn btn-doks-light dropdown-toggle" id=doks-versions data-bs-toggle=dropdown aria-expanded=false data-bs-display=static aria-label="Toggle version menu">
<span class=d-none>Doks</span>
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></button><ul class="dropdown-menu dropdown-menu-lg-end me-lg-2 shadow rounded border-0" aria-labelledby=doks-versions></ul></div></div></div></nav></header></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-installation aria-expanded=false>
Installation</button><div class=collapse id=section-installation><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/installation/introduction/>Getting Started</a></li><li><a class="docs-link rounded" href=/documentation/installation/docker_usage/>Docker Usage</a></li><li><a class="docs-link rounded" href=/documentation/installation/installation_for_linux/>Installation for Linux</a></li><li><a class="docs-link rounded" href=/documentation/installation/installation_for_windows/>Installation for Windows</a></li><li><a class="docs-link rounded" href=/documentation/installation/installation_for_macos/>Installation for macOS</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-examples aria-expanded=false>
Examples</button><div class=collapse id=section-examples><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/examples/colliderbit/>ColliderBit</a></li><li><a class="docs-link rounded" href=/documentation/examples/anotherbit/>AnotherBit</a></li><li><a class="docs-link rounded" href=/documentation/examples/anotherbit2/>AnotherBit2</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-help aria-expanded=false>
Help</button><div class=collapse id=section-help><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/help/faqs/>FAQs</a></li><li><a class="docs-link rounded" href=/documentation/help/compiler_matrix/>Compiler Matrix</a></li><li><a class="docs-link rounded" href=/documentation/help/known_issues/>Known Issues</a></li><li><a class="docs-link rounded" href=/documentation/help/configuration_examples/>Configuration Examples</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-code aria-expanded=false>
Code Reference</button></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section- aria-expanded=false>
GAMBIT_VERSION_HERE</button><div class=collapse id=section-><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/code/colliderbit_development/index_classes/>Classes</a></li><li><a class="docs-link rounded" href=/documentation/code/colliderbit_development/index_files/>Files</a></li><li><a class="docs-link rounded" href=/documentation/code/colliderbit_development/index_pages/>Pages</a></li><li><a class="docs-link rounded" href=/documentation/code/colliderbit_development/index_namespaces/>Namespaces</a></li></ul></div></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span>On this page</span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><ul><li><a href=#namespaces>Namespaces</a></li><li><a href=#classes>Classes</a></li><li><a href=#source-code>Source code</a></li></ul></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3>On this page</h3><nav id=TableOfContents><ul><li><ul><li><a href=#namespaces>Namespaces</a></li><li><a href=#classes>Classes</a></li><li><a href=#source-code>Source code</a></li></ul></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9 mx-xl-auto"><h1>file analyses/Analysis_ATLAS_13TeV_2bMET_36invfb.cpp</h1><p class=lead></p><p>[No description available]</p><h2 id=namespaces>Namespaces <a href=#namespaces class=anchor aria-hidden=true>#</a></h2><table><thead><tr><th>Name</th></tr></thead><tbody><tr><td><strong><a href=/documentation/code/colliderbit_development/namespaces/namespacegambit/>Gambit</a></strong><br>Simulation of &ldquo;Search for photonic signatures of gauge-mediated supersymmetry in 13 TeV pp collisions with the ATLAS detector&rdquo;.</td></tr><tr><td><strong><a href=/documentation/code/colliderbit_development/namespaces/namespacegambit_1_1colliderbit/>Gambit::ColliderBit</a></strong></td></tr></tbody></table><h2 id=classes>Classes <a href=#classes class=anchor aria-hidden=true>#</a></h2><table><thead><tr><th></th><th>Name</th></tr></thead><tbody><tr><td>class</td><td><strong><a href=/documentation/code/colliderbit_development/classes/classgambit_1_1colliderbit_1_1mt2/>Gambit::ColliderBit::MT2</a></strong><br>A useful <a href>MT2</a> class for this module.</td></tr><tr><td>class</td><td><strong><a href=/documentation/code/colliderbit_development/classes/classgambit_1_1colliderbit_1_1analysis__atlas__13tev__2bmet__36invfb/>Gambit::ColliderBit::Analysis_ATLAS_13TeV_2bMET_36invfb</a></strong></td></tr></tbody></table><h2 id=source-code>Source code <a href=#source-code class=anchor aria-hidden=true>#</a></h2><pre><code>#include &lt;vector&gt;
#include &lt;map&gt;
#include &lt;cmath&gt;
#include &lt;memory&gt;
#include &lt;iomanip&gt;

#include &quot;gambit/ColliderBit/analyses/Analysis.hpp&quot;
#include &quot;gambit/ColliderBit/ATLASEfficiencies.hpp&quot;
#include &quot;gambit/ColliderBit/mt2_bisect.h&quot;
#include &quot;gambit/ColliderBit/lester_mt2_bisect.h&quot;

using namespace std;

// Based on arXiv:1708.09266
// Code by Martin White, January 2018
// Based on ATLAS public code snippet

// Known issues: No lepton isolation cuts applied
// The b tagging working point keeps changing in the ATLAS code snippet, but this is not referred to in the paper
// Have gone with the code snippet version (60% working point for the signal B jets)
//

namespace Gambit {
  namespace ColliderBit {

    class MT2 {
    public:
      MT2(){
        MT2tauB=0;
        aMT2_BM=0;
      }

      double MT2tauB;
      double aMT2_BM;
    };

    class Analysis_ATLAS_13TeV_2bMET_36invfb : public Analysis {
    private:

      // Variables that hold the number of events passing signal region cuts

      std::map&lt;string, EventCounter&gt; _counters = {
        {&quot;0L_SRA350&quot;, EventCounter(&quot;0L_SRA350&quot;)},
        {&quot;0L_SRA450&quot;, EventCounter(&quot;0L_SRA450&quot;)},
        {&quot;0L_SRA550&quot;, EventCounter(&quot;0L_SRA550&quot;)},
        {&quot;0L_SRB&quot;, EventCounter(&quot;0L_SRB&quot;)},
        {&quot;0L_SRC&quot;, EventCounter(&quot;0L_SRC&quot;)},
        {&quot;1L_SRA600&quot;, EventCounter(&quot;1L_SRA600&quot;)},
        {&quot;1L_SRA750&quot;, EventCounter(&quot;1L_SRA750&quot;)},
        {&quot;1L_SRA300_2j&quot;, EventCounter(&quot;1L_SRA300_2j&quot;)},
        {&quot;1L_SRB&quot;, EventCounter(&quot;1L_SRB&quot;)},
      };

      vector&lt;int&gt; cutFlowVector;
      vector&lt;string&gt; cutFlowVector_str;
      int NCUTS;

    public:

      // Required detector sim
      static constexpr const char* detector = &quot;ATLAS&quot;;

      static bool sortByPT(const HEPUtils::Jet* jet1, const HEPUtils::Jet* jet2) { return (jet1-&gt;pT() &gt; jet2-&gt;pT()); }

      Analysis_ATLAS_13TeV_2bMET_36invfb() {

        set_analysis_name(&quot;ATLAS_13TeV_2bMET_36invfb&quot;);
        set_luminosity(36.1);

        NCUTS=70;

        for(int i=0;i&lt;NCUTS;i++){
          cutFlowVector.push_back(0);
          cutFlowVector_str.push_back(&quot;&quot;);
        }

      }

      // The following section copied from Analysis_ATLAS_1LEPStop_20invfb.cpp
      void JetLeptonOverlapRemoval(vector&lt;const HEPUtils::Jet*&gt; &amp;jetvec, vector&lt;const HEPUtils::Particle*&gt; &amp;lepvec, double DeltaRMax) {
        //Routine to do jet-lepton check
        //Discards jets if they are within DeltaRMax of a lepton

        vector&lt;const HEPUtils::Jet*&gt; Survivors;

        for(unsigned int itjet = 0; itjet &lt; jetvec.size(); itjet++) {
          bool overlap = false;
          HEPUtils::P4 jetmom=jetvec.at(itjet)-&gt;mom();
          for(unsigned int itlep = 0; itlep &lt; lepvec.size(); itlep++) {
            HEPUtils::P4 lepmom=lepvec.at(itlep)-&gt;mom();
            double dR;

            dR=jetmom.deltaR_eta(lepmom);

            if(fabs(dR) &lt;= DeltaRMax) overlap=true;
          }
          if(overlap) continue;
          Survivors.push_back(jetvec.at(itjet));
        }
        jetvec=Survivors;

        return;
      }

      void LeptonJetOverlapRemoval(vector&lt;const HEPUtils::Particle*&gt; &amp;lepvec, vector&lt;const HEPUtils::Jet*&gt; &amp;jetvec) {
        //Routine to do lepton-jet check
        //Discards leptons if they are within dR of a jet as defined in analysis paper

        vector&lt;const HEPUtils::Particle*&gt; Survivors;

        for(unsigned int itlep = 0; itlep &lt; lepvec.size(); itlep++) {
          bool overlap = false;
          HEPUtils::P4 lepmom=lepvec.at(itlep)-&gt;mom();
          for(unsigned int itjet= 0; itjet &lt; jetvec.size(); itjet++) {
            HEPUtils::P4 jetmom=jetvec.at(itjet)-&gt;mom();
            double dR;
            double DeltaRMax = std::max(0.1,std::min(0.4, 0.04 + 10 / lepmom.pT()));
            dR=jetmom.deltaR_eta(lepmom);

            if(fabs(dR) &lt;= DeltaRMax) overlap=true;
          }
          if(overlap) continue;
          Survivors.push_back(lepvec.at(itlep));
        }
        lepvec=Survivors;

        return;
      }

      void SpecialLeptonJetOverlapRemoval(vector&lt;const HEPUtils::Particle*&gt; &amp;lepvec, vector&lt;const HEPUtils::Jet*&gt; &amp;jetvec) {
        //Routine to do lepton-jet check
        //Discards leptons if they are within dR of a jet as defined in analysis paper

        vector&lt;const HEPUtils::Particle*&gt; Survivors;

        for(unsigned int itlep = 0; itlep &lt; lepvec.size(); itlep++) {
          bool overlap = false;
          HEPUtils::P4 lepmom=lepvec.at(itlep)-&gt;mom();
          for(unsigned int itjet= 0; itjet &lt; jetvec.size(); itjet++) {
            HEPUtils::P4 jetmom=jetvec.at(itjet)-&gt;mom();
            double dR;
            double DeltaRMax = std::min(0.4, 0.04 + 10/lepvec[itlep]-&gt;pT());
            dR=jetmom.deltaR_eta(lepmom);

            if(fabs(dR) &lt;= DeltaRMax) overlap=true;
          }
          if(overlap) continue;
          Survivors.push_back(lepvec.at(itlep));
        }
        lepvec=Survivors;

        return;
      }


      MT2 MT2helper(vector&lt;const HEPUtils::Jet*&gt; jets, vector&lt;const HEPUtils::Particle*&gt;  electrons,  vector&lt;const HEPUtils::Particle*&gt; muons, HEPUtils::P4 metVec){

        MT2 results;

        bool passmu = false;
        if(muons.size()==1)passmu=true;

        bool passel = false;
        if(electrons.size()==1)passel=true;

        int nJet = jets.size();
        if(nJet &lt; 2)return results;

        //ATLAS use the two jets with highest MV1 weights
        //DELPHES does not have a continuous b weight

        //We have all b jets tagged (with 100% efficiency), so can use the two highest pT b jets
        //This corresponds to using the 2 b jets that are first in the collection

        const HEPUtils::Jet* trueBjet1 = NULL; //need to assign this
        const HEPUtils::Jet* trueBjet2 = NULL; //nee to assign this

        int nTrueBJets=0;
        for(const HEPUtils::Jet* tmpJet: jets){
          if(tmpJet-&gt;btag()){
            trueBjet1=tmpJet;
            nTrueBJets++;
            break;
          }
        }

        for(const HEPUtils::Jet* tmpJet: jets){
          if(tmpJet-&gt;btag() &amp;&amp; tmpJet!=trueBjet1){
            trueBjet2=tmpJet;
            nTrueBJets++;
            break;
          }
        }

        if(nTrueBJets&lt;2)return results;


        HEPUtils::P4 jet1B, jet2B;
        jet1B.setXYZE(trueBjet1-&gt;mom().px(), trueBjet1-&gt;mom().py(), trueBjet1-&gt;mom().pz(), trueBjet1-&gt;E());
        jet2B.setXYZE(trueBjet2-&gt;mom().px(), trueBjet2-&gt;mom().py(), trueBjet2-&gt;mom().pz(), trueBjet2-&gt;E());


        HEPUtils::P4 leptontmp;
        // double leptonmass = 0;
        if(passel){
          // leptonmass = 0.510998910; //MeV
          leptontmp = electrons[0]-&gt;mom();
        }
        else if(passmu){
          // leptonmass =  105.658367; // MeV
          leptontmp = muons[0]-&gt;mom();
        }


        HEPUtils::P4 lepton;
        lepton.setXYZE(leptontmp.px(),leptontmp.py(),leptontmp.pz(),leptontmp.E());


        HEPUtils::P4 lepton_plus_jet1B;
        HEPUtils::P4 lepton_plus_jet2B;

        lepton_plus_jet1B = lepton+jet1B;
        lepton_plus_jet2B = lepton+jet2B;

        double pa_a[3] = { 0, lepton_plus_jet1B.px(), lepton_plus_jet1B.py() };
        double pb_a[3] = { 80, jet2B.px(), jet2B.py() };
        double pmiss_a[3] = { 0, metVec.px(), metVec.py() };
        double mn_a = 0.;

        mt2_bisect::mt2 mt2_event_a;

        mt2_event_a.set_momenta(pa_a,pb_a,pmiss_a);
        mt2_event_a.set_mn(mn_a);

        double mt2a = mt2_event_a.get_mt2();

        double pa_b[3] = { 0, lepton_plus_jet2B.px(), lepton_plus_jet2B.py() };
        double pb_b[3] = { 80, jet1B.px(), jet1B.py() };
        double pmiss_b[3] = { 0, metVec.px(), metVec.py() };
        double mn_b = 0.;

        mt2_bisect::mt2 mt2_event_b;

        mt2_event_b.set_momenta(pa_b,pb_b,pmiss_b);
        mt2_event_b.set_mn(mn_b);
        double mt2b = mt2_event_b.get_mt2();

        double aMT2_BM = min(mt2a,mt2b);
        results.aMT2_BM=aMT2_BM;

        if (nJet &gt; 3){
          const HEPUtils::Jet* jet3=0;
          for(const HEPUtils::Jet* current: jets){
            if (current == trueBjet1)continue;
            if (current == trueBjet2)continue;
            jet3 = current;
            break;
          }


          HEPUtils::P4 jet3B;
          jet3B.setXYZE(jet3-&gt;mom().px(), jet3-&gt;mom().py(), jet3-&gt;mom().pz(), jet3-&gt;mom().E());

          double pa_tau[3] = { 0, jet3B.px(), jet3B.py() };
          double pb_tau[3] = { 0, lepton.px(), lepton.py() };
          double pmiss_tau[3] = { 0, metVec.px(), metVec.py() };
          double mn_tau = 0.;

          mt2_bisect::mt2 mt2_event_tau;

          mt2_event_tau.set_momenta(pa_tau,pb_tau,pmiss_tau);
          mt2_event_tau.set_mn(mn_tau);

          //ComputeMT2 stuff3(jet3B,lepton,MET,0.,0.);
          //double MT2tauB = stuff3.ComputeNumeric();
          double MT2tauB = mt2_event_tau.get_mt2();//calcMT2(0,jet3B.Pt(),jet3B.Eta(),jet3B.Phi(),jet3B.E(),0,lepton.Pt(),lepton.Eta(),lepton.Phi(),lepton.E(),MET.Px(),MET.Py(),0);
          results.MT2tauB=MT2tauB;
        }
        return results;
      }


      void run(const HEPUtils::Event* event) {

        // Get the missing energy and momentum in the event
        HEPUtils::P4 metVec = event-&gt;missingmom();
        double met = event-&gt;met();

        // Now define vectors of baseline objects, including:
        // - retrieval of electron, muon and jets from the event
        // - application of basic pT and eta cuts
        vector&lt;const HEPUtils::Particle*&gt; electrons;
        for (const HEPUtils::Particle* electron : event-&gt;electrons()) {
          if (electron-&gt;pT() &gt; 10.
              &amp;&amp; fabs(electron-&gt;eta()) &lt; 2.47)
            electrons.push_back(electron);
        }

        // Apply electron efficiency
        ATLAS::applyElectronEff(electrons);

        vector&lt;const HEPUtils::Particle*&gt; muons;
        for (const HEPUtils::Particle* muon : event-&gt;muons()) {
          if (muon-&gt;pT() &gt; 10.
              &amp;&amp; fabs(muon-&gt;eta()) &lt; 2.7)
            muons.push_back(muon);
        }

        // Apply muon efficiency
        ATLAS::applyMuonEff(muons);

        //vector&lt;const HEPUtils::Jet*&gt; candJets;
        //for (const HEPUtils::Jet* jet : event-&gt;jets()) {
        //if (jet-&gt;pT() &gt; 20.
        //    &amp;&amp; fabs(jet-&gt;eta()) &lt; 2.8)
        //  candJets.push_back(jet);
        //}

        // Jets
        vector&lt;const HEPUtils::Jet*&gt; bJets;
        vector&lt;const HEPUtils::Jet*&gt; nonBJets;

        // Get b jets

        const std::vector&lt;double&gt;  a = {0,10.};
        const std::vector&lt;double&gt;  b = {0,10000.};
        const std::vector&lt;double&gt; c = {0.77}; // set b-tag efficiency to 77%
        HEPUtils::BinnedFn2D&lt;double&gt; _eff2d(a,b,c);
        for (const HEPUtils::Jet* jet : event-&gt;jets()) {
          bool hasTag=has_tag(_eff2d, fabs(jet-&gt;eta()), jet-&gt;pT());
          if (jet-&gt;pT() &gt; 20. &amp;&amp; fabs(jet-&gt;eta()) &lt; 4.8) {
            if(jet-&gt;btag() &amp;&amp; hasTag &amp;&amp; fabs(jet-&gt;eta()) &lt; 2.5 &amp;&amp; jet-&gt;pT() &gt; 20.){
              bJets.push_back(jet);
            } else {
              nonBJets.push_back(jet);
            }
          }
        }

        // Overlap removal
        JetLeptonOverlapRemoval(nonBJets,electrons,0.2);
        LeptonJetOverlapRemoval(electrons,nonBJets);
        LeptonJetOverlapRemoval(electrons,bJets);
        JetLeptonOverlapRemoval(nonBJets,muons,0.2);
        SpecialLeptonJetOverlapRemoval(muons,nonBJets);
        SpecialLeptonJetOverlapRemoval(muons,bJets);

        // Fill a jet-pointer-to-bool map to make it easy to check
        // if a given jet is treated as a b-jet in this analysis
        map&lt;const HEPUtils::Jet*,bool&gt; analysisBtags;
        for (const HEPUtils::Jet* jet : bJets) {
          analysisBtags[jet] = true;
        }
        for (const HEPUtils::Jet* jet : nonBJets) {
          analysisBtags[jet] = false;
        }

        // Signal object containers
        vector&lt;const HEPUtils::Jet*&gt; signalJets20;
        vector&lt;const HEPUtils::Jet*&gt; signalJets35;
        vector&lt;const HEPUtils::Particle*&gt; signalElectrons;
        vector&lt;const HEPUtils::Particle*&gt; signalMuons;
        vector&lt;const HEPUtils::Particle*&gt; signalLeptons;
        vector&lt;const HEPUtils::Jet*&gt; signalBJets20;
        vector&lt;const HEPUtils::Jet*&gt; signalBJets35;

        // Now apply signal jet cuts
        for (const HEPUtils::Jet* jet : bJets) {
          if(jet-&gt;pT() &gt; 20. &amp;&amp; fabs(jet-&gt;eta())&lt;2.8){
            signalJets20.push_back(jet);
            if(fabs(jet-&gt;eta())&lt;2.5)signalBJets20.push_back(jet);
          }

          if(jet-&gt;pT() &gt; 35. &amp;&amp; fabs(jet-&gt;eta())&lt;2.8){
            signalJets35.push_back(jet);
            if(fabs(jet-&gt;eta())&lt;2.5)signalBJets35.push_back(jet);
          }

        }

        for (const HEPUtils::Jet* jet : nonBJets) {
          if(jet-&gt;pT() &gt; 20. &amp;&amp; fabs(jet-&gt;eta())&lt;2.8){
            signalJets20.push_back(jet);
          }

          if(jet-&gt;pT() &gt; 35. &amp;&amp; fabs(jet-&gt;eta())&lt;2.8){
            signalJets35.push_back(jet);
          }

        }

        // Now order the jet collections by pT

        std::sort(signalJets35.begin(), signalJets35.end(), sortByPT);
        std::sort(signalBJets35.begin(), signalBJets35.end(), sortByPT);
        std::sort(signalJets20.begin(), signalJets20.end(), sortByPT);
        std::sort(signalBJets20.begin(), signalBJets20.end(), sortByPT);


        for (const HEPUtils::Particle* electron : electrons) {
          if(electron-&gt;pT() &gt; 20. &amp;&amp; fabs(electron-&gt;eta()) &lt; 2.47){
            signalElectrons.push_back(electron);
            signalLeptons.push_back(electron);
          }
        }

        for (const HEPUtils::Particle* muon : muons) {
          if(muon-&gt;pT() &gt; 20. &amp;&amp; fabs(muon-&gt;eta()) &lt; 2.5){
            signalMuons.push_back(muon);
            signalLeptons.push_back(muon);
          }
        }

        HEPUtils::P4 metVecCorr = metVec;

        for(const HEPUtils::Particle* lep : signalLeptons){
          metVecCorr+=lep-&gt;mom();
        }

        // double metCorr = metVecCorr.pT();


        //Common Selection
        int nJets20  = signalJets20.size();
        int nBjets20 = signalBJets20.size();
        int nJets35  = signalJets35.size();
        int nBjets35 = signalBJets35.size();

        bool zeroLep = (signalLeptons.size()==0);
        bool oneLep  = (signalLeptons.size()==1);
        // bool twoLep  = ((signalElectrons.size()==2 &amp;&amp; muons.size()==0) || (signalMuons.size()==2 &amp;&amp; electrons.size()==0)); //DF

        double meff2j = met;
        double meff = met;
        double ht=0;

        for(int jet=0;jet&lt;nJets35;jet++){
          if(jet&lt;2) meff2j += signalJets35[jet]-&gt;pT();
          meff += signalJets35[jet]-&gt;pT();
          ht +=  signalJets35[jet]-&gt;pT();
        }

        double dphib1 = -99.;
        double dphib2 = -99.;

        if(signalBJets35.size()&gt;0)dphib1=signalBJets35[0]-&gt;mom().deltaPhi(metVec);
        if(signalBJets35.size()&gt;1)dphib2=signalBJets35[1]-&gt;mom().deltaPhi(metVec);

        double dphiMin4=9999.;

        for(int j=0; j&lt;nJets35; j++){
          double dPhij=fabs(signalJets35[j]-&gt;mom().deltaPhi(metVec));
          if(j&lt;=3)dphiMin4= min(dphiMin4, dPhij);
        }

        double mjj_35 = 0;
        double mCT = 0;
        double mblmin = 0;
        bool  bjetsLeading = false;


        if(nJets35&gt;=2) {
          mjj_35 = (signalJets35[0]-&gt;mom() + signalJets35[1]-&gt;mom()).m();   // = mbb for leading-bjets events

          double jet1_ET = sqrt(signalJets35[0]-&gt;mom().pT()*signalJets35[0]-&gt;mom().pT()+signalJets35[0]-&gt;mom().m()*signalJets35[0]-&gt;mom().m());
          double jet2_ET = sqrt(signalJets35[1]-&gt;mom().pT()*signalJets35[1]-&gt;mom().pT()+signalJets35[1]-&gt;mom().m()*signalJets35[1]-&gt;mom().m());

          double modPTdiff_squared=(signalJets35[0]-&gt;mom().px()-signalJets35[1]-&gt;mom().px())*(signalJets35[0]-&gt;mom().px()-signalJets35[1]-&gt;mom().px())
            +            (signalJets35[0]-&gt;mom().py()-signalJets35[1]-&gt;mom().py())*(signalJets35[0]-&gt;mom().py()-signalJets35[1]-&gt;mom().py());

          double mct_squared = pow(jet1_ET+jet2_ET,2)-modPTdiff_squared;
          mCT = sqrt(mct_squared);

          if(oneLep){
            if(nBjets35&gt;1) mblmin = std::min( (signalLeptons[0]-&gt;mom() + signalBJets35[0]-&gt;mom()).m(), (signalLeptons[0]-&gt;mom() + signalBJets35[1]-&gt;mom()).m());
            else if(nBjets35&gt;0) mblmin = (signalLeptons[0]-&gt;mom() + signalBJets35[0]-&gt;mom()).m();
          }

          // Check if the two leading jets in signalJets35 have been b-tagged
          bjetsLeading = ( analysisBtags.at(signalJets35[0]) &amp;&amp; analysisBtags.at(signalJets35[1]) );
        }


        double mt = 0.;
        if(oneLep)mt =  sqrt(2.*signalLeptons[0]-&gt;pT()*met*(1. - cos(signalLeptons[0]-&gt;mom().deltaPhi(metVec))));

        // Calculate minimum mT with any of the leading four jets and the met

        double mtmin = 9999.;

        for(unsigned int jet=0;jet&lt;signalJets35.size();jet++){
          double mt_tmp = sqrt(2.*signalJets35[jet]-&gt;pT()*met*(1. - cos(signalJets35[jet]-&gt;mom().deltaPhi(metVec))));
          if(mt_tmp&lt;mtmin &amp;&amp; jet&lt;=3)mtmin=mt_tmp;
        }

        double mtminb = 9999.;

        for(unsigned int jet=0;jet&lt;signalBJets35.size();jet++){
          double mt_tmp = sqrt(2.*signalBJets35[jet]-&gt;pT()*met*(1. - cos(signalBJets35[jet]-&gt;mom().deltaPhi(metVec))));
          if(mt_tmp&lt;mtminb &amp;&amp; jet&lt;=1)mtminb=mt_tmp;
        }



        double amt2 = 0; //need to identify the two bjets here
        // double mbb  = 0;

        /*int bj1=-1; int bj2=-1;
        for(unsigned int ij=0; ij &lt; signalJets35.size() ; ij++){
          if( analysisBtags.at(signalJets35[ij]) ){
            if(bj1&lt;0){
              bj1=ij;
            }else{
              bj2=ij;
              break;
            }
          }
          }*/

        // Scrap the ATLAS identification of b jets and simply use the signal b jets instead


        //cout &lt;&lt; &quot;nBjets35 &quot; &lt;&lt; nBjets35 &lt;&lt; &quot; bj2 &quot; &lt;&lt; bj2 &lt;&lt; endl;

        if(nBjets35==2){
          // mbb = (signalBJets35[0]-&gt;mom() + signalBJets35[1]-&gt;mom()).m();
          int bj1=0;
          int bj2=1;
          if(oneLep){
            float mbl1 = (signalLeptons[0]-&gt;mom()+signalBJets35[bj1]-&gt;mom()).m();
            float mbl2 = (signalLeptons[0]-&gt;mom()+signalBJets35[bj2]-&gt;mom()).m();

            if(mbl1 &gt;= 170. &amp;&amp; mbl2 &lt; 170.) {
              // The ATLAS code snippet looks obviously wrong here (doesn't match the paper)
              // Have corrected it
              // Question: Is the first entry correct?
              double pa_a[3] = { (signalLeptons[0]-&gt;mom()+signalBJets35[bj2]-&gt;mom()).m(), (signalLeptons[0]-&gt;mom()+signalBJets35[bj2]-&gt;mom()).px(), (signalLeptons[0]-&gt;mom()+signalJets35[bj2]-&gt;mom()).py() };
              double pb_a[3] = { signalJets35[bj1]-&gt;mom().m(), signalJets35[bj1]-&gt;mom().px(), signalJets35[bj1]-&gt;mom().py() };
              double pmiss_a[3] = { 0, metVec.px(), metVec.py() };
              double mn_a = 0.;

              mt2_bisect::mt2 mt2_event_a;

              mt2_event_a.set_momenta(pa_a,pb_a,pmiss_a);
              mt2_event_a.set_mn(mn_a);

              // double amt2 = mt2_event_a.get_mt2();

              // Now try new Lester method

              // double amt2_new = asymm_mt2_lester_bisect::get_mT2((signalLeptons[0]-&gt;mom()+signalJets35[bj2]-&gt;mom()).m(), (signalLeptons[0]-&gt;mom()+signalJets35[bj2]-&gt;mom()).px(), (signalLeptons[0]-&gt;mom()+signalJets35[bj2]-&gt;mom()).py(), signalJets35[bj1]-&gt;mom().m(), signalJets35[bj1]-&gt;mom().px(), signalJets35[bj1]-&gt;mom().py(), metVec.px(), metVec.py(), 0., 0.);

              //cout &lt;&lt; &quot;MT2 original &quot; &lt;&lt; amt2 &lt;&lt; &quot; amt2_new &quot; &lt;&lt; amt2_new &lt;&lt; endl;

              //amt2 = calcMT2(signalLeptons[0]+myjets[bj1], myjets[bj1], metVec);

            }
            else if(mbl1 &lt; 170. &amp;&amp; mbl2 &gt;= 170.) {

              double pa_a[3] = { (signalLeptons[0]-&gt;mom()+signalJets35[bj1]-&gt;mom()).m(), (signalLeptons[0]-&gt;mom()+signalJets35[bj1]-&gt;mom()).px(), (signalLeptons[0]-&gt;mom()+signalJets35[bj1]-&gt;mom()).py() };
              double pb_a[3] = {signalJets35[bj2]-&gt;mom().m() , signalJets35[bj2]-&gt;mom().px(), signalJets35[bj2]-&gt;mom().py() };
              double pmiss_a[3] = { 0, metVec.px(), metVec.py() };
              double mn_a = 0.;

              mt2_bisect::mt2 mt2_event_a;

              mt2_event_a.set_momenta(pa_a,pb_a,pmiss_a);
              mt2_event_a.set_mn(mn_a);

              // double amt2 = mt2_event_a.get_mt2();

            }
            //amt2 = calcMT2(myjets[bj1], signalLeptons[0]+myjets[bj1], metVec);
            else if(mbl1 &lt; 170. &amp;&amp; mbl2 &lt; 170.){

              double pa_a[3] = {(signalLeptons[0]-&gt;mom()+signalJets35[bj1]-&gt;mom()).m() , (signalLeptons[0]-&gt;mom()+signalJets35[bj1]-&gt;mom()).px(), (signalLeptons[0]-&gt;mom()+signalJets35[bj1]-&gt;mom()).py() };
              double pb_a[3] = {signalJets35[bj2]-&gt;mom().m() , signalJets35[bj2]-&gt;mom().px(), signalJets35[bj2]-&gt;mom().py() };
              double pa_b[3] = {(signalLeptons[0]-&gt;mom()+signalJets35[bj2]-&gt;mom()).m() , (signalLeptons[0]-&gt;mom()+signalJets35[bj2]-&gt;mom()).px(), (signalLeptons[0]-&gt;mom()+signalJets35[bj2]-&gt;mom()).py() };
              double pb_b[3] = {signalJets35[bj1]-&gt;mom().m() , signalJets35[bj1]-&gt;mom().px(), signalJets35[bj1]-&gt;mom().py() };
              double pmiss_a[3] = { 0, metVec.px(), metVec.py() };
              double mn_a = 0.;

              mt2_bisect::mt2 mt2_event_a;
              mt2_bisect::mt2 mt2_event_b;
              mt2_event_a.set_momenta(pa_a,pb_a,pmiss_a);
              mt2_event_a.set_mn(mn_a);

              mt2_event_b.set_momenta(pa_b,pb_b,pmiss_a);
              mt2_event_b.set_mn(mn_a);

              double amt2_a = mt2_event_a.get_mt2();
              double amt2_b = mt2_event_b.get_mt2();
              amt2 = std::min(amt2_a, amt2_b);
            }
          }
        }



        // Define variables using 20 GeV jets

        double ht4=0;
        double meff4j = met;
        for(size_t jet=0;jet&lt;signalJets20.size();jet++){
          if(jet&lt;3)continue;
          ht4 += signalJets20[jet]-&gt;pT();
          meff4j += signalJets20[jet]-&gt;pT();
        }

        bool bjetsSublead = (nJets20&gt;=3 &amp;&amp; !analysisBtags.at(signalJets20[0])
                                        &amp;&amp; analysisBtags.at(signalJets20[1])
                                        &amp;&amp; ( analysisBtags.at(signalJets20[2])
                                             || (nJets20&gt;=4 &amp;&amp; analysisBtags.at(signalJets20[3]) ) ) );
        // NOTE:
        //   Table 1 in the paper suggests that we should also allow for a b-tagged signalJets20[4]
        //   in the definition of bjetsSublead above, but the ATLAS code snippet at
        //   https://www.hepdata.net/record/79317 only check the jets up to signalJets20[3].
        //   We follow the ATLAS code snippet here.


        double  dphiMin1  = 0;
        if(nJets20&gt;0)dphiMin1 = fabs(signalJets20[0]-&gt;mom().deltaPhi(metVec));

        double dphiMin2 = 9999.;
        for(int jet=0;jet &lt; nJets20;jet++){
          if(jet&gt;1)continue;
          double dphi_tmp = fabs(signalJets20[jet]-&gt;mom().deltaPhi(metVec));
          if(dphi_tmp &lt; dphiMin2)dphiMin2=dphi_tmp;
        }

        double mjj_20 = 0.;
        double asym = 0.;
        if(nJets20 &gt; 1){
          mjj_20 = (signalJets20[0]-&gt;mom() + signalJets20[1]-&gt;mom()).m();
          asym = (signalJets20[0]-&gt;pT()-signalJets20[1]-&gt;pT()) / (signalJets20[0]-&gt;pT()+signalJets20[1]-&gt;pT());
        }

        double mbb_35 = 0.;
        if(nBjets35&gt;=2)mbb_35=(signalBJets35[0]-&gt;mom()+signalBJets35[1]-&gt;mom()).m();

        // Increment cutFlowVector elements
        cutFlowVector_str[0]  = &quot;No cuts &quot;;
        cutFlowVector_str[1]  = &quot;b0L-SRA: MET &gt; 250 GeV&quot;;
        cutFlowVector_str[2]  = &quot;b0L-SRA: dPhiMin4 &gt; 0.4&quot;;
        cutFlowVector_str[3]  = &quot;b0L-SRA: MET/meff &gt; 0.25 &quot;;
        cutFlowVector_str[4]  = &quot;b0L-SRA: 2-4 jets (pT &gt; 25 GeV)&quot;;
        cutFlowVector_str[5]  = &quot;b0L-SRA: pT j0 &gt; 130 GeV&quot;;
        cutFlowVector_str[6]  = &quot;b0L-SRA: pT j1 &gt; 50 GeV&quot;;
        cutFlowVector_str[7]  = &quot;b0L-SRA: pT j3 &lt; 50 GeV&quot;;
        cutFlowVector_str[8]  = &quot;b0L-SRA: 0 leptons&quot;;
        cutFlowVector_str[9]  = &quot;b0L-SRA: 2 b jets &quot;;
        cutFlowVector_str[10] = &quot;b0L-SRA: 2 leading b jets &quot;;
        cutFlowVector_str[11] = &quot;b0L-SRA: mbb &gt; 200 GeV &quot;;
        cutFlowVector_str[12] = &quot;b0L-SRA: mCT &gt; 350 GeV &quot;;
        cutFlowVector_str[13] = &quot;b0L-SRA: mCT &gt; 450 GeV &quot;;
        cutFlowVector_str[14] = &quot;b0L-SRA: mCT &gt; 550 GeV &quot;;

        cutFlowVector_str[15] = &quot;b0L-SRB: pT j1 &gt; 50 GeV &quot;;
        cutFlowVector_str[16] = &quot;b0L-SRB: 0 leptons &quot;;
        cutFlowVector_str[17] = &quot;b0L-SRB: 2 bjets &quot;;
        cutFlowVector_str[18] = &quot;b0L-SRB: dphi(b1,met) &lt; 2.0 &quot;;
        cutFlowVector_str[19] = &quot;b0L-SRB: dphi(b2,met) &lt; 2.5 &quot;;
        cutFlowVector_str[20] = &quot;b0L-SRB: mTmin(j1-4,met)&gt;250 GeV &quot;;
        cutFlowVector_str[21] = &quot;b0L-SRC: Zero leptons &quot;;
        cutFlowVector_str[22] = &quot;b0L-SRC: 2-5 jets (pT &gt; 20 GeV) &quot;;
        cutFlowVector_str[23] = &quot;b0L-SRC: Leading light jet &quot;;
        cutFlowVector_str[24] = &quot;b0L-SRC: dPhi(j1,met) &gt; 2.5&quot;;
        cutFlowVector_str[25] = &quot;b0L-SRC: dPhi(j2,met) &gt; 0.2&quot;;
        cutFlowVector_str[26] = &quot;b0L-SRC: Subleading jet b-tagged &quot;;
        cutFlowVector_str[27] = &quot;b0L-SRC: 2 b jets &quot;;
        cutFlowVector_str[28] = &quot;b0L-SRC: HT4 &lt; 70 &quot;;
        cutFlowVector_str[29] = &quot;b0L-SRC: met &gt; 500 GeV &quot;;
        cutFlowVector_str[30] = &quot;b0L-SRC: pT(j1) &gt; 500 GeV &quot;;
        cutFlowVector_str[31] = &quot;b0L-SRC: meff &gt; 1300 GeV &quot;;
        cutFlowVector_str[32] = &quot;b0L-SRC: A &gt; 0.8 &quot;;
        cutFlowVector_str[33] = &quot;b0L-SRC: mjj &gt; 200 GeV &quot;;
        cutFlowVector_str[34] = &quot;b1L-SRA: 1 lepton &quot;;
        cutFlowVector_str[35] = &quot;b1L-SRA: pT(l1) &gt; 27 GeV &quot;;
        cutFlowVector_str[36] = &quot;b1L-SRA: &gt;= 2 jets (pT &gt; 35 GeV) &quot;;
        cutFlowVector_str[37] = &quot;b1L-SRA: dphi j min &gt; 0.4 &quot;;
        cutFlowVector_str[38] = &quot;b1L-SRA: 2 b jets &quot;;
        cutFlowVector_str[39] = &quot;b1L-SRA: met &gt; 200 GeV &quot;;
        cutFlowVector_str[40] = &quot;b1L-SRA: met/sqrt(HT) &quot;;
        cutFlowVector_str[41] = &quot;b1L-SRA: mT &gt; 140 GeV &quot;;
        cutFlowVector_str[42] = &quot;b1L-SRA: mblmin &lt; 170 GeV &quot;;
        cutFlowVector_str[43] = &quot;b1L-SRA: amT2 &gt; 250 GeV &quot;;
        cutFlowVector_str[44] = &quot;b1L-SRA: mbb &gt; 200 GeV &quot;;
        cutFlowVector_str[45] = &quot;b1L-SRA: meff &gt; 450 GeV &quot;;
        cutFlowVector_str[46] = &quot;b1L-SRA: meff &gt; 600 GeV &quot;;
        cutFlowVector_str[47] = &quot;b1L-SRA: meff &gt; 750 GeV &quot;;
        cutFlowVector_str[48] = &quot;b1L-SRA300-2j: met/sqrt(HT) &quot;;
        cutFlowVector_str[49] = &quot;b1L-SRA300-2j: mT  &gt; 140 GeV &quot;;
        cutFlowVector_str[50] = &quot;b1L-SRA300-2j: mblmin &lt; 170 GeV &quot;;
        cutFlowVector_str[51] = &quot;b1L-SRA300-2j: amt2 &gt; 250 GeV &quot;;
        cutFlowVector_str[52] = &quot;b1L-SRA300-2j: mbb &gt; 200 GeV &quot;;
        cutFlowVector_str[53] = &quot;b1L-SRA300-2j: meff &gt; 300 GeV &quot;;
        cutFlowVector_str[54] = &quot;b1L-SRA300-2j: &lt; 3 jets (pT &gt; 35 GeV) &quot;;
        cutFlowVector_str[55] = &quot;b1L-SRB: mT &gt; 120 GeV &quot;;
        cutFlowVector_str[56] = &quot;b1L-SRB: mblmin &lt; 170 GeV &quot;;
        cutFlowVector_str[57] = &quot;b1L-SRB: amt2 &gt; 200 GeV &quot;;
        cutFlowVector_str[58] = &quot;b1L-SRB: mbb &lt; 200 GeV &quot;;
        cutFlowVector_str[59] = &quot;b1L-SRB: dphi(b1,met) &gt; 2.0 &quot;;
        cutFlowVector_str[60] = &quot;b1L-SRB: mTmin(b1-2,met) &gt; 200 GeV &quot;;

        // Apply cuts to each signal region

        for(int j=0;j&lt;NCUTS;j++){
          if(
             (j==0) ||

             (j==1 &amp;&amp; met &gt; 250.) ||

             (j==2 &amp;&amp; met &gt; 250. &amp;&amp; dphiMin4 &gt; 0.4) ||

             (j==3 &amp;&amp; met &gt; 250. &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; met/meff2j&gt;0.25) ||

             (j==4 &amp;&amp; met &gt; 250. &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; met/meff2j&gt;0.25 &amp;&amp; nJets35&gt;=2 &amp;&amp; nJets35&lt;=4) ||

             (j==5 &amp;&amp; met &gt; 250. &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; met/meff2j&gt;0.25 &amp;&amp; nJets35&gt;=2 &amp;&amp; nJets35&lt;=4 &amp;&amp;  signalJets35[0]-&gt;pT() &gt; 130.) ||

             (j==6 &amp;&amp; met &gt; 250. &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; met/meff2j&gt;0.25 &amp;&amp; nJets35&gt;=2 &amp;&amp; nJets35&lt;=4 &amp;&amp;  signalJets35[0]-&gt;pT() &gt; 130. &amp;&amp; signalJets35[1]-&gt;pT() &gt; 50.) ||

             (j==7 &amp;&amp; met &gt; 250. &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; met/meff2j&gt;0.25 &amp;&amp; nJets35&gt;=2 &amp;&amp; nJets35&lt;=4 &amp;&amp;  signalJets35[0]-&gt;pT() &gt; 130. &amp;&amp; signalJets35[1]-&gt;pT() &gt; 50. &amp;&amp; (nJets35&lt;4 || signalJets35[3]-&gt;pT() &lt; 50.)) ||

             (j==8 &amp;&amp; met &gt; 250. &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; met/meff2j&gt;0.25 &amp;&amp; nJets35&gt;=2 &amp;&amp; nJets35&lt;=4 &amp;&amp;  signalJets35[0]-&gt;pT() &gt; 130. &amp;&amp; signalJets35[1]-&gt;pT() &gt; 50. &amp;&amp; (nJets35&lt;4 || signalJets35[3]-&gt;pT() &lt; 50.) &amp;&amp; zeroLep) ||

             (j==9 &amp;&amp; met &gt; 250. &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; met/meff2j&gt;0.25 &amp;&amp; nJets35&gt;=2 &amp;&amp; nJets35&lt;=4 &amp;&amp;  signalJets35[0]-&gt;pT() &gt; 130. &amp;&amp; signalJets35[1]-&gt;pT() &gt; 50. &amp;&amp; (nJets35&lt;4 || signalJets35[3]-&gt;pT() &lt; 50.) &amp;&amp; zeroLep &amp;&amp; nBjets35==2) ||

             (j==10 &amp;&amp; met &gt; 250. &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; met/meff2j&gt;0.25 &amp;&amp; nJets35&gt;=2 &amp;&amp; nJets35&lt;=4 &amp;&amp;  signalJets35[0]-&gt;pT() &gt; 130. &amp;&amp; signalJets35[1]-&gt;pT() &gt; 50. &amp;&amp; (nJets35&lt;4 || signalJets35[3]-&gt;pT() &lt; 50.) &amp;&amp; zeroLep &amp;&amp; nBjets35==2 &amp;&amp; bjetsLeading) ||

             (j==11 &amp;&amp; met &gt; 250. &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; met/meff2j&gt;0.25 &amp;&amp; nJets35&gt;=2 &amp;&amp; nJets35&lt;=4 &amp;&amp;  signalJets35[0]-&gt;pT() &gt; 130. &amp;&amp; signalJets35[1]-&gt;pT() &gt; 50. &amp;&amp; (nJets35&lt;4 || signalJets35[3]-&gt;pT() &lt; 50.) &amp;&amp; zeroLep &amp;&amp; nBjets35==2 &amp;&amp; bjetsLeading &amp;&amp; mjj_35 &gt; 200.) ||

             (j==12 &amp;&amp; met &gt; 250. &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; met/meff2j&gt;0.25 &amp;&amp; nJets35&gt;=2 &amp;&amp; nJets35&lt;=4 &amp;&amp;  signalJets35[0]-&gt;pT() &gt; 130. &amp;&amp; signalJets35[1]-&gt;pT() &gt; 50. &amp;&amp; (nJets35&lt;4 || signalJets35[3]-&gt;pT() &lt; 50.) &amp;&amp; zeroLep &amp;&amp; nBjets35==2 &amp;&amp; bjetsLeading &amp;&amp; mjj_35 &gt; 200. &amp;&amp; mCT &gt; 350.) ||

             (j==13 &amp;&amp; met &gt; 250. &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; met/meff2j&gt;0.25 &amp;&amp; nJets35&gt;=2 &amp;&amp; nJets35&lt;=4 &amp;&amp;  signalJets35[0]-&gt;pT() &gt; 130. &amp;&amp; signalJets35[1]-&gt;pT() &gt; 50. &amp;&amp; (nJets35&lt;4 || signalJets35[3]-&gt;pT() &lt; 50.) &amp;&amp; zeroLep &amp;&amp; nBjets35==2 &amp;&amp; bjetsLeading &amp;&amp; mjj_35 &gt; 200. &amp;&amp; mCT &gt; 450.) ||

             (j==14 &amp;&amp; met &gt; 250. &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; met/meff2j&gt;0.25 &amp;&amp; nJets35&gt;=2 &amp;&amp; nJets35&lt;=4 &amp;&amp;  signalJets35[0]-&gt;pT() &gt; 130. &amp;&amp; signalJets35[1]-&gt;pT() &gt; 50. &amp;&amp; (nJets35&lt;4 || signalJets35[3]-&gt;pT() &lt; 50.) &amp;&amp; zeroLep &amp;&amp; nBjets35==2 &amp;&amp; bjetsLeading &amp;&amp; mjj_35 &gt; 200. &amp;&amp; mCT &gt; 550.) ||

             // b0L-SRB

             (j==15 &amp;&amp; met &gt; 250. &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nJets35&gt;=2 &amp;&amp; nJets35&lt;=4 &amp;&amp; signalJets35[1]-&gt;pT() &gt; 50.) ||

             (j==16 &amp;&amp; met &gt; 250. &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nJets35&gt;=2 &amp;&amp; nJets35&lt;=4 &amp;&amp; signalJets35[1]-&gt;pT() &gt; 50. &amp;&amp; zeroLep) ||

             (j==17 &amp;&amp; met &gt; 250. &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nJets35&gt;=2 &amp;&amp; nJets35&lt;=4 &amp;&amp; signalJets35[1]-&gt;pT() &gt; 50. &amp;&amp; zeroLep &amp;&amp; nBjets35==2) ||

             (j==18 &amp;&amp; met &gt; 250. &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nJets35&gt;=2 &amp;&amp; nJets35&lt;=4 &amp;&amp; signalJets35[1]-&gt;pT() &gt; 50. &amp;&amp; zeroLep &amp;&amp; nBjets35==2 &amp;&amp; dphib1 &lt; 2.0) ||

             (j==19 &amp;&amp; met &gt; 250. &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nJets35&gt;=2 &amp;&amp; nJets35&lt;=4 &amp;&amp; signalJets35[1]-&gt;pT() &gt; 50. &amp;&amp; zeroLep &amp;&amp; nBjets35==2 &amp;&amp; dphib1 &lt; 2.0 &amp;&amp; dphib2 &lt; 2.5) ||

             (j==20 &amp;&amp; met &gt; 250. &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nJets35&gt;=2 &amp;&amp; nJets35&lt;=4 &amp;&amp; signalJets35[1]-&gt;pT() &gt; 50. &amp;&amp; zeroLep &amp;&amp; nBjets35==2 &amp;&amp; dphib1 &lt; 2.0 &amp;&amp; dphib2 &lt; 2.5 &amp;&amp; mtmin &gt; 250.) ||

             // b0L-SRC

             (j==21 &amp;&amp; zeroLep) ||

             (j==22 &amp;&amp; zeroLep &amp;&amp; nJets20&gt;=2 &amp;&amp; nJets20&lt;=5) ||

             (j==23 &amp;&amp; zeroLep &amp;&amp; nJets20&gt;=2 &amp;&amp; nJets20&lt;=5 &amp;&amp; !analysisBtags.at(signalJets20[0])) ||

             (j==24 &amp;&amp; zeroLep &amp;&amp; nJets20&gt;=2 &amp;&amp; nJets20&lt;=5 &amp;&amp; !analysisBtags.at(signalJets20[0]) &amp;&amp; dphiMin1 &gt; 2.5) ||

             (j==25 &amp;&amp; zeroLep &amp;&amp; nJets20&gt;=2 &amp;&amp; nJets20&lt;=5 &amp;&amp; !analysisBtags.at(signalJets20[0]) &amp;&amp; dphiMin1 &gt; 2.5 &amp;&amp; dphiMin2 &gt; 0.2) ||

             (j==26 &amp;&amp; zeroLep &amp;&amp; nJets20&gt;=2 &amp;&amp; nJets20&lt;=5 &amp;&amp; bjetsSublead &amp;&amp; dphiMin1 &gt; 2.5 &amp;&amp; dphiMin2 &gt; 0.2) ||

             (j==27 &amp;&amp; zeroLep &amp;&amp; nJets20&gt;=2 &amp;&amp; nJets20&lt;=5 &amp;&amp; bjetsSublead &amp;&amp; dphiMin1 &gt; 2.5 &amp;&amp; dphiMin2 &gt; 0.2 &amp;&amp; nBjets20==2) ||

             (j==28 &amp;&amp; zeroLep &amp;&amp; nJets20&gt;=2 &amp;&amp; nJets20&lt;=5 &amp;&amp; bjetsSublead &amp;&amp; dphiMin1 &gt; 2.5 &amp;&amp; dphiMin2 &gt; 0.2 &amp;&amp; nBjets20==2 &amp;&amp; ht4 &lt; 70.) ||

             (j==29 &amp;&amp; zeroLep &amp;&amp; nJets20&gt;=2 &amp;&amp; nJets20&lt;=5 &amp;&amp; bjetsSublead &amp;&amp; dphiMin1 &gt; 2.5 &amp;&amp; dphiMin2 &gt; 0.2 &amp;&amp; nBjets20==2 &amp;&amp; ht4 &lt; 70. &amp;&amp; met &gt; 500.) ||

             (j==30 &amp;&amp; zeroLep &amp;&amp; nJets20&gt;=2 &amp;&amp; nJets20&lt;=5 &amp;&amp; bjetsSublead &amp;&amp; dphiMin1 &gt; 2.5 &amp;&amp; dphiMin2 &gt; 0.2 &amp;&amp; nBjets20==2 &amp;&amp; ht4 &lt; 70. &amp;&amp; met &gt; 500. &amp;&amp; signalJets20[0]-&gt;pT() &gt; 500.) ||

             (j==31 &amp;&amp; zeroLep &amp;&amp; nJets20&gt;=2 &amp;&amp; nJets20&lt;=5 &amp;&amp; bjetsSublead &amp;&amp; dphiMin1 &gt; 2.5 &amp;&amp; dphiMin2 &gt; 0.2 &amp;&amp; nBjets20==2 &amp;&amp; ht4 &lt; 70. &amp;&amp; met &gt; 500. &amp;&amp; signalJets20[0]-&gt;pT() &gt; 500. &amp;&amp; meff4j &gt; 1300.) ||

             (j==32 &amp;&amp; zeroLep &amp;&amp; nJets20&gt;=2 &amp;&amp; nJets20&lt;=5 &amp;&amp; bjetsSublead &amp;&amp; dphiMin1 &gt; 2.5 &amp;&amp; dphiMin2 &gt; 0.2 &amp;&amp; nBjets20==2 &amp;&amp; ht4 &lt; 70. &amp;&amp; met &gt; 500. &amp;&amp; signalJets20[0]-&gt;pT() &gt; 500. &amp;&amp; meff4j &gt; 1300. &amp;&amp; asym &gt; 0.8) ||

             (j==33 &amp;&amp; zeroLep &amp;&amp; nJets20&gt;=2 &amp;&amp; nJets20&lt;=5 &amp;&amp; bjetsSublead &amp;&amp; dphiMin1 &gt; 2.5 &amp;&amp; dphiMin2 &gt; 0.2 &amp;&amp; nBjets20==2 &amp;&amp; ht4 &lt; 70. &amp;&amp; met &gt; 500. &amp;&amp; signalJets20[0]-&gt;pT() &gt; 500. &amp;&amp; meff4j &gt; 1300. &amp;&amp; asym &gt; 0.8 &amp;&amp; mjj_20 &gt; 200.) ||

             // b1L-SRA

             (j==34 &amp;&amp; oneLep) ||

             (j==35 &amp;&amp; oneLep &amp;&amp; signalLeptons[0]-&gt;pT() &gt; 27.) ||

             (j==36 &amp;&amp; oneLep &amp;&amp; signalLeptons[0]-&gt;pT() &gt; 27. &amp;&amp;  nJets35&gt;=2) ||

             (j==37 &amp;&amp; oneLep &amp;&amp; signalLeptons[0]-&gt;pT() &gt; 27. &amp;&amp;  nJets35&gt;=2 &amp;&amp; dphiMin4 &gt; 0.4) ||

             (j==38 &amp;&amp; oneLep &amp;&amp; signalLeptons[0]-&gt;pT() &gt; 27. &amp;&amp;  nJets35&gt;=2 &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nBjets35==2) ||

             (j==39 &amp;&amp; oneLep &amp;&amp; signalLeptons[0]-&gt;pT() &gt; 27. &amp;&amp;  nJets35&gt;=2 &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nBjets35==2 &amp;&amp; met &gt; 200.) ||

             (j==40 &amp;&amp; oneLep &amp;&amp; signalLeptons[0]-&gt;pT() &gt; 27. &amp;&amp;  nJets35&gt;=2 &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nBjets35==2 &amp;&amp; met &gt; 200. &amp;&amp; met/sqrt(ht) &gt; 8) ||

             (j==41 &amp;&amp; oneLep &amp;&amp; signalLeptons[0]-&gt;pT() &gt; 27. &amp;&amp;  nJets35&gt;=2 &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nBjets35==2 &amp;&amp; met &gt; 200. &amp;&amp; met/sqrt(ht) &gt; 8 &amp;&amp; mt &gt; 140.) ||

             (j==42 &amp;&amp; oneLep &amp;&amp; signalLeptons[0]-&gt;pT() &gt; 27. &amp;&amp;  nJets35&gt;=2 &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nBjets35==2 &amp;&amp; met &gt; 200. &amp;&amp; met/sqrt(ht) &gt; 8 &amp;&amp; mt &gt; 140. &amp;&amp; mblmin &lt; 170) ||

             (j==43 &amp;&amp; oneLep &amp;&amp; signalLeptons[0]-&gt;pT() &gt; 27. &amp;&amp;  nJets35&gt;=2 &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nBjets35==2 &amp;&amp; met &gt; 200. &amp;&amp; met/sqrt(ht) &gt; 8 &amp;&amp; mt &gt; 140. &amp;&amp; mblmin &lt; 170 &amp;&amp; amt2 &gt; 250) ||

             (j==44 &amp;&amp; oneLep &amp;&amp; signalLeptons[0]-&gt;pT() &gt; 27. &amp;&amp;  nJets35&gt;=2 &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nBjets35==2 &amp;&amp; met &gt; 200. &amp;&amp; met/sqrt(ht) &gt; 8 &amp;&amp; mt &gt; 140. &amp;&amp; mblmin &lt; 170 &amp;&amp; amt2 &gt; 250 &amp;&amp; mbb_35 &gt; 200.) ||

             (j==45 &amp;&amp; oneLep &amp;&amp; signalLeptons[0]-&gt;pT() &gt; 27. &amp;&amp;  nJets35&gt;=2 &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nBjets35==2 &amp;&amp; met &gt; 200. &amp;&amp; met/sqrt(ht) &gt; 8 &amp;&amp; mt &gt; 140. &amp;&amp; mblmin &lt; 170 &amp;&amp; amt2 &gt; 250 &amp;&amp; mbb_35 &gt; 200. &amp;&amp; meff &gt; 450.) ||

             (j==46 &amp;&amp; oneLep &amp;&amp; signalLeptons[0]-&gt;pT() &gt; 27. &amp;&amp;  nJets35&gt;=2 &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nBjets35==2 &amp;&amp; met &gt; 200. &amp;&amp; met/sqrt(ht) &gt; 8 &amp;&amp; mt &gt; 140. &amp;&amp; mblmin &lt; 170 &amp;&amp; amt2 &gt; 250 &amp;&amp; mbb_35 &gt; 200. &amp;&amp; meff &gt; 600.) ||

             (j==47 &amp;&amp; oneLep &amp;&amp; signalLeptons[0]-&gt;pT() &gt; 27. &amp;&amp;  nJets35&gt;=2 &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nBjets35==2 &amp;&amp; met &gt; 200. &amp;&amp; met/sqrt(ht) &gt; 8 &amp;&amp; mt &gt; 140. &amp;&amp; mblmin &lt; 170 &amp;&amp; amt2 &gt; 250 &amp;&amp; mbb_35 &gt; 200. &amp;&amp; meff &gt; 750.) ||

             // b1L-SRA300-2j

             (j==48 &amp;&amp; oneLep &amp;&amp; signalLeptons[0]-&gt;pT() &gt; 27. &amp;&amp;  nJets35&gt;=2 &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nBjets35==2 &amp;&amp; met &gt; 200. &amp;&amp; met/sqrt(ht) &gt; 8) ||

             (j==49 &amp;&amp; oneLep &amp;&amp; signalLeptons[0]-&gt;pT() &gt; 27. &amp;&amp;  nJets35&gt;=2 &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nBjets35==2 &amp;&amp; met &gt; 200. &amp;&amp; met/sqrt(ht) &gt; 8 &amp;&amp; mt &gt; 140.) ||

             (j==50 &amp;&amp; oneLep &amp;&amp; signalLeptons[0]-&gt;pT() &gt; 27. &amp;&amp;  nJets35&gt;=2 &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nBjets35==2 &amp;&amp; met &gt; 200. &amp;&amp; met/sqrt(ht) &gt; 8 &amp;&amp; mt &gt; 140. &amp;&amp; mblmin &lt; 170.) ||

             (j==51 &amp;&amp; oneLep &amp;&amp; signalLeptons[0]-&gt;pT() &gt; 27. &amp;&amp;  nJets35&gt;=2 &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nBjets35==2 &amp;&amp; met &gt; 200. &amp;&amp; met/sqrt(ht) &gt; 8 &amp;&amp; mt &gt; 140. &amp;&amp; mblmin &lt; 170. &amp;&amp; amt2 &gt; 250.) ||

             (j==52 &amp;&amp; oneLep &amp;&amp; signalLeptons[0]-&gt;pT() &gt; 27. &amp;&amp;  nJets35&gt;=2 &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nBjets35==2 &amp;&amp; met &gt; 200. &amp;&amp; met/sqrt(ht) &gt; 8 &amp;&amp; mt &gt; 140. &amp;&amp; mblmin &lt; 170. &amp;&amp; amt2 &gt; 250. &amp;&amp; mbb_35 &gt; 200.) ||
             (j==53 &amp;&amp; oneLep &amp;&amp; signalLeptons[0]-&gt;pT() &gt; 27. &amp;&amp;  nJets35&gt;=2 &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nBjets35==2 &amp;&amp; met &gt; 200. &amp;&amp; met/sqrt(ht) &gt; 8 &amp;&amp; mt &gt; 140. &amp;&amp; mblmin &lt; 170. &amp;&amp; amt2 &gt; 250. &amp;&amp; mbb_35 &gt; 200. &amp;&amp; meff&gt;300.) ||

             (j==54 &amp;&amp; oneLep &amp;&amp; signalLeptons[0]-&gt;pT() &gt; 27. &amp;&amp;  nJets35&gt;=2 &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nBjets35==2 &amp;&amp; met &gt; 200. &amp;&amp; met/sqrt(ht) &gt; 8 &amp;&amp; mt &gt; 140. &amp;&amp; mblmin &lt; 170. &amp;&amp; amt2 &gt; 250. &amp;&amp; mbb_35 &gt; 200. &amp;&amp; meff&gt;300. &amp;&amp; nJets35==2) ||

             // b1L-SRB

             (j==55 &amp;&amp; oneLep &amp;&amp; signalLeptons[0]-&gt;pT() &gt; 27. &amp;&amp;  nJets35&gt;=2 &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nBjets35==2 &amp;&amp; met &gt; 200. &amp;&amp; met/sqrt(ht) &gt; 8 &amp;&amp; mt &gt; 120.) ||

             (j==56 &amp;&amp; oneLep &amp;&amp; signalLeptons[0]-&gt;pT() &gt; 27. &amp;&amp;  nJets35&gt;=2 &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nBjets35==2 &amp;&amp; met &gt; 200. &amp;&amp; met/sqrt(ht) &gt; 8 &amp;&amp; mt &gt; 120. &amp;&amp; mblmin &lt; 170.) ||

             (j==57 &amp;&amp; oneLep &amp;&amp; signalLeptons[0]-&gt;pT() &gt; 27. &amp;&amp;  nJets35&gt;=2 &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nBjets35==2 &amp;&amp; met &gt; 200. &amp;&amp; met/sqrt(ht) &gt; 8 &amp;&amp; mt &gt; 120. &amp;&amp; mblmin &lt; 170. &amp;&amp; amt2 &gt; 200.) ||

             (j==58 &amp;&amp; oneLep &amp;&amp; signalLeptons[0]-&gt;pT() &gt; 27. &amp;&amp;  nJets35&gt;=2 &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nBjets35==2 &amp;&amp; met &gt; 200. &amp;&amp; met/sqrt(ht) &gt; 8 &amp;&amp; mt &gt; 120. &amp;&amp; mblmin &lt; 170. &amp;&amp; amt2 &gt; 200. &amp;&amp; mbb_35 &lt; 200.) ||
             (j==59 &amp;&amp; oneLep &amp;&amp; signalLeptons[0]-&gt;pT() &gt; 27. &amp;&amp;  nJets35&gt;=2 &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nBjets35==2 &amp;&amp; met &gt; 200. &amp;&amp; met/sqrt(ht) &gt; 8 &amp;&amp; mt &gt; 120. &amp;&amp; mblmin &lt; 170. &amp;&amp; amt2 &gt; 200. &amp;&amp; mbb_35 &lt; 200. &amp;&amp; fabs(signalBJets35[0]-&gt;mom().deltaPhi(metVec)) &gt; 2.0) ||

             (j==60 &amp;&amp; oneLep &amp;&amp; signalLeptons[0]-&gt;pT() &gt; 27. &amp;&amp;  nJets35&gt;=2 &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nBjets35==2 &amp;&amp; met &gt; 200. &amp;&amp; met/sqrt(ht) &gt; 8 &amp;&amp; mt &gt; 120. &amp;&amp; mblmin &lt; 170. &amp;&amp; amt2 &gt; 200. &amp;&amp; mbb_35 &lt; 200. &amp;&amp; fabs(signalBJets35[0]-&gt;mom().deltaPhi(metVec)) &gt; 2.0 &amp;&amp; mtminb &gt; 200.)

             )cutFlowVector[j]++;
        }


        // Now increment signal region variables

        if(met &gt; 250. &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; met/meff2j&gt;0.25 &amp;&amp; nJets35&gt;=2 &amp;&amp; nJets35&lt;=4 &amp;&amp;  signalJets35[0]-&gt;pT() &gt; 130. &amp;&amp; signalJets35[1]-&gt;pT() &gt; 50. &amp;&amp; (nJets35&lt;4 || signalJets35[3]-&gt;pT() &lt; 50.) &amp;&amp; zeroLep &amp;&amp; nBjets35==2 &amp;&amp; bjetsLeading &amp;&amp; mjj_35 &gt; 200. &amp;&amp; mCT &gt; 550.) _counters.at(&quot;0L_SRA550&quot;).add_event(event);

        if(met &gt; 250. &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; met/meff2j&gt;0.25 &amp;&amp; nJets35&gt;=2 &amp;&amp; nJets35&lt;=4 &amp;&amp;  signalJets35[0]-&gt;pT() &gt; 130. &amp;&amp; signalJets35[1]-&gt;pT() &gt; 50. &amp;&amp; (nJets35&lt;4 || signalJets35[3]-&gt;pT() &lt; 50.) &amp;&amp; zeroLep &amp;&amp; nBjets35==2 &amp;&amp; bjetsLeading &amp;&amp; mjj_35 &gt; 200. &amp;&amp; mCT &gt; 450.) _counters.at(&quot;0L_SRA450&quot;).add_event(event);

        if(met &gt; 250. &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; met/meff2j&gt;0.25 &amp;&amp; nJets35&gt;=2 &amp;&amp; nJets35&lt;=4 &amp;&amp;  signalJets35[0]-&gt;pT() &gt; 130. &amp;&amp; signalJets35[1]-&gt;pT() &gt; 50. &amp;&amp; (nJets35&lt;4 || signalJets35[3]-&gt;pT() &lt; 50.) &amp;&amp; zeroLep &amp;&amp; nBjets35==2 &amp;&amp; bjetsLeading &amp;&amp; mjj_35 &gt; 200. &amp;&amp; mCT &gt; 350.) _counters.at(&quot;0L_SRA350&quot;).add_event(event);

        if(met &gt; 250. &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nJets35&gt;=2 &amp;&amp; nJets35&lt;=4 &amp;&amp; signalJets35[1]-&gt;pT() &gt; 50. &amp;&amp; zeroLep &amp;&amp; nBjets35==2 &amp;&amp; dphib1 &lt; 2.0 &amp;&amp; dphib2 &lt; 2.5 &amp;&amp; mtmin &gt; 250.) _counters.at(&quot;0L_SRB&quot;).add_event(event);

        if(zeroLep &amp;&amp; nJets20&gt;=2 &amp;&amp; nJets20&lt;=5 &amp;&amp; bjetsSublead &amp;&amp; dphiMin1 &gt; 2.5 &amp;&amp; dphiMin2 &gt; 0.2 &amp;&amp; nBjets20==2 &amp;&amp; ht4 &lt; 70. &amp;&amp; met &gt; 500. &amp;&amp; signalJets20[0]-&gt;pT() &gt; 500. &amp;&amp; meff4j &gt; 1300. &amp;&amp; asym &gt; 0.8 &amp;&amp; mjj_20 &gt; 200.) _counters.at(&quot;0L_SRC&quot;).add_event(event);

        if(oneLep &amp;&amp; signalLeptons[0]-&gt;pT() &gt; 27. &amp;&amp;  nJets35&gt;=2 &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nBjets35==2 &amp;&amp; met &gt; 200. &amp;&amp; met/sqrt(ht) &gt; 8 &amp;&amp; mt &gt; 140. &amp;&amp; mblmin &lt; 170 &amp;&amp; amt2 &gt; 250 &amp;&amp; mbb_35 &gt; 200. &amp;&amp; meff &gt; 600.) _counters.at(&quot;1L_SRA600&quot;).add_event(event);

        if(oneLep &amp;&amp; signalLeptons[0]-&gt;pT() &gt; 27. &amp;&amp;  nJets35&gt;=2 &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nBjets35==2 &amp;&amp; met &gt; 200. &amp;&amp; met/sqrt(ht) &gt; 8 &amp;&amp; mt &gt; 140. &amp;&amp; mblmin &lt; 170 &amp;&amp; amt2 &gt; 250 &amp;&amp; mbb_35 &gt; 200. &amp;&amp; meff &gt; 750.) _counters.at(&quot;1L_SRA750&quot;).add_event(event);

        if(oneLep &amp;&amp; signalLeptons[0]-&gt;pT() &gt; 27. &amp;&amp;  nJets35&gt;=2 &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nBjets35==2 &amp;&amp; met &gt; 200. &amp;&amp; met/sqrt(ht) &gt; 8 &amp;&amp; mt &gt; 140. &amp;&amp; mblmin &lt; 170. &amp;&amp; amt2 &gt; 250. &amp;&amp; mbb_35 &gt; 200. &amp;&amp; meff&gt;300. &amp;&amp; nJets35==2) _counters.at(&quot;1L_SRA300_2j&quot;).add_event(event);

        if(oneLep &amp;&amp; signalLeptons[0]-&gt;pT() &gt; 27. &amp;&amp;  nJets35&gt;=2 &amp;&amp; dphiMin4 &gt; 0.4 &amp;&amp; nBjets35==2 &amp;&amp; met &gt; 200. &amp;&amp; met/sqrt(ht) &gt; 8 &amp;&amp; mt &gt; 120. &amp;&amp; mblmin &lt; 170. &amp;&amp; amt2 &gt; 200. &amp;&amp; mbb_35 &lt; 200. &amp;&amp; fabs(signalBJets35[0]-&gt;mom().deltaPhi(metVec)) &gt; 2.0 &amp;&amp; mtminb &gt; 200.) _counters.at(&quot;1L_SRB&quot;).add_event(event);

        return;

      }

      void combine(const Analysis* other)
      {
        const Analysis_ATLAS_13TeV_2bMET_36invfb* specificOther
          = dynamic_cast&lt;const Analysis_ATLAS_13TeV_2bMET_36invfb*&gt;(other);

        for (auto&amp; pair : _counters) { pair.second += specificOther-&gt;_counters.at(pair.first); }

        if (NCUTS != specificOther-&gt;NCUTS) NCUTS = specificOther-&gt;NCUTS;
        for (int j=0; j&lt;NCUTS; j++)
        {
          cutFlowVector[j] += specificOther-&gt;cutFlowVector[j];
          cutFlowVector_str[j] = specificOther-&gt;cutFlowVector_str[j];
        }

      }


      void collect_results() {

        // double scale_by=1.;

        // cout &lt;&lt; &quot;-------------------------------------------------------------------------------------------------------------------------------------------------&quot;&lt;&lt;endl;
        // cout &lt;&lt; &quot;CUT FLOW: ATLAS multi lepton paper &quot;&lt;&lt;endl;
        // cout &lt;&lt; &quot;-------------------------------------------------------------------------------------------------------------------------------------------------&quot;&lt;&lt;endl;

        // cout &lt;&lt; left &lt;&lt; setw(45) &lt;&lt; &quot;CUT&quot; &lt;&lt; right &lt;&lt; setw(20) &lt;&lt; &quot;RAW&quot; &lt;&lt; setw(20) &lt;&lt; &quot;SCALED&quot; &lt;&lt; setw(20) &lt;&lt; &quot;%&quot; &lt;&lt; setw(20) &lt;&lt; &quot;clean adj RAW&quot;&lt;&lt; setw(20) &lt;&lt; &quot;clean adj %&quot; &lt;&lt; std::endl;
        // for (int j=0; j&lt;NCUTS; j++) {
        //   cout &lt;&lt; left &lt;&lt; setw(45) &lt;&lt; right &lt;&lt; cutFlowVector_str[j].c_str() &lt;&lt; setw(20) &lt;&lt; cutFlowVector[j] &lt;&lt; setw(20) &lt;&lt; cutFlowVector[j]*scale_by &lt;&lt; setw(20) &lt;&lt; 100.*cutFlowVector[j]/cutFlowVector[0] &lt;&lt; &quot;%&quot; &lt;&lt; setw(20) &lt;&lt; cutFlowVector[j]*scale_by &lt;&lt; setw(20) &lt;&lt; 100.*cutFlowVector[j]/cutFlowVector[0]&lt;&lt; &quot;%&quot; &lt;&lt; std::endl;
        // }
        // cout &lt;&lt; &quot;-------------------------------------------------------------------------------------------------------------------------------------------------&quot;&lt;&lt;endl;


        // add_result(SignalRegionData(&quot;SR label&quot;, n_obs, {n_sig_MC, n_sig_MC_sys}, {n_bkg, n_bkg_err}));

        add_result(SignalRegionData(_counters.at(&quot;0L_SRA350&quot;), 81., { 70., 13.}));
        add_result(SignalRegionData(_counters.at(&quot;0L_SRA450&quot;), 24., { 22., 5.}));
        add_result(SignalRegionData(_counters.at(&quot;0L_SRA550&quot;), 10., { 7.2, 1.5}));
        add_result(SignalRegionData(_counters.at(&quot;0L_SRB&quot;), 45., { 37., 7.}));
        add_result(SignalRegionData(_counters.at(&quot;0L_SRC&quot;), 7., { 5.5, 1.5}));

        // MJW removes these regions for the Feb 2018 MareNostrum scans, since the aMT2 variable is not well-described.

        /*
        add_result(SignalRegionData(_counters.at(&quot;1L_SRA600&quot;), 21., { 24., 6.}));
        add_result(SignalRegionData(_counters.at(&quot;1L_SR750&quot;), 13., { 15., 4.}));
        add_result(SignalRegionData(_counters.at(&quot;1L_SR300-2j&quot;), 12., { 6.7, 2.3}));
        add_result(SignalRegionData(_counters.at(&quot;1L_SRB&quot;), 69., { 53., 12.}));
        */

        return;
      }

      void analysis_specific_reset() {
        for (auto&amp; pair : _counters) { pair.second.reset(); }
        std::fill(cutFlowVector.begin(), cutFlowVector.end(), 0);
      }



    };

    DEFINE_ANALYSIS_FACTORY(ATLAS_13TeV_2bMET_36invfb)

  }
}
</code></pre><hr><p>Updated on 2022-08-02 at 18:18:38 +0000</p><div class=edit-page><a href=https://github.com/RC1242RC/gambit_gh_pages/blob/master/content/en/documentation/code/ColliderBit_development/Files/Analysis__ATLAS__13TeV__2bMET__36invfb_8cpp.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on GitHub</a></div></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a class=text-muted href=https://www.netlify.com/>Netlify</a>, <a class=text-muted href=https://gohugo.io/>Hugo</a>, and <a class=text-muted href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline><li class=list-inline-item><a href=/license/>License</a></li></ul></div></div></div></footer><script src=/js/bootstrap.min.54bf0932b8a36d0e152b1635b099a6ef1394d35327e2437550a075c9c8ed1bd8aed5847c21b36fc02ed24014c031d9ca24017b0c78b1639d7e2fa8329898b842.js integrity="sha512-VL8JMrijbQ4VKxY1sJmm7xOU01Mn4kN1UKB1ycjtG9iu1YR8IbNvwC7SQBTAMdnKJAF7DHixY51+L6gymJi4Qg==" crossorigin=anonymous defer></script>
<script src=/js/highlight.min.5b48bc253dc75aeea5fb366ecf700f4925e2b6eb1a1466f2124b722d68148d67bc0a9365d2b8ad9c585161b46372d23b08509a16f1fd518542b894756d4752d0.js integrity="sha512-W0i8JT3HWu6l+zZuz3APSSXitusaFGbyEktyLWgUjWe8CpNl0ritnFhRYbRjctI7CFCaFvH9UYVCuJR1bUdS0A==" crossorigin=anonymous defer></script>
<script src=/main.min.40265e9a032aeba5eaf67baac3cbbc22667a7533215d326eeb3e9f4d5e4be40f9ff4dcd22949db73ae527ca26a19d7998091a8973c82af760b2c0daa335190ed.js integrity="sha512-QCZemgMq66Xq9nuqw8u8ImZ6dTMhXTJu6z6fTV5L5A+f9NzSKUnbc65SfKJqGdeZgJGolzyCr3YLLA2qM1GQ7Q==" crossorigin=anonymous defer></script>
<script src=https://rc1242rc.github.io/index.min.97d6402d7a34cdd5bd42756d4cab0cf30d540a9cfd60b87b21ea49bb4e8ab243c43c3171889d41e133bd95a5c6d18e02d0f4cd3d09c2e02e58f2cc367481d403.js integrity="sha512-l9ZALXo0zdW9QnVtTKsM8w1UCpz9YLh7IepJu06KskPEPDFxiJ1B4TO9laXG0Y4C0PTNPQnC4C5Y8sw2dIHUAw==" crossorigin=anonymous defer></script></body></html>