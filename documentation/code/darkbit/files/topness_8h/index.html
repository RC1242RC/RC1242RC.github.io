<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://rc1242rc.github.io/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://rc1242rc.github.io/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://rc1242rc.github.io/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var e=localStorage.getItem("theme");e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=https://rc1242rc.github.io/main.f12f7e04ea768acebec10c86baf049d74d6a79f24bc0dfb7ed77aa60462432916dd1ce8f41c78b69496adf650b3039a28a210183cce598f09b95d6fecb5ff999.css integrity="sha512-8S9+BOp2is6+wQyGuvBJ101qefJLwN+37XeqYEYkMpFt0c6PQceLaUlq32ULMDmiiiEBg8zlmPCbldb+y1/5mQ==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>file ColliderBit/topness.h - GAMBIT</title><meta name=description content="[No description available]"><link rel=canonical href=https://rc1242rc.github.io/documentation/code/darkbit/files/topness_8h/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="file ColliderBit/topness.h"><meta property="og:description" content="[No description available]"><meta property="og:url" content="https://rc1242rc.github.io/documentation/code/darkbit/files/topness_8h/"><meta property="og:site_name" content="GAMBIT"><meta property="og:image" content="https://rc1242rc.github.io/gambit_logo.png"><meta property="og:image:alt" content="GAMBIT"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content><meta name=twitter:creator content><meta name=twitter:title content="file ColliderBit/topness.h"><meta name=twitter:description content="[No description available]"><meta name=twitter:image content="https://rc1242rc.github.io/gambit_logo.png"><meta name=twitter:image:alt content="file ColliderBit/topness.h"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://rc1242rc.github.io/#/schema/organization/1","name":"Doks","url":"https://rc1242rc.github.io/","sameAs":["https://github.com/GambitBSM"],"logo":{"@type":"ImageObject","@id":"https://rc1242rc.github.io/#/schema/image/1","url":"https://rc1242rc.github.io/logo-doks.png","width":450,"height":416,"caption":"Doks"},"image":{"@id":"https://rc1242rc.github.io/#/schema/image/1"}},{"@type":"WebSite","@id":"https://rc1242rc.github.io/#/schema/website/1","url":"https://rc1242rc.github.io/","name":"GAMBIT","description":"Documentation for the Global And Modular BSM Inference Tool","publisher":{"@id":"https://rc1242rc.github.io/#/schema/organization/1"}},{"@type":"WebPage","@id":"https://rc1242rc.github.io/documentation/code/darkbit/files/topness_8h/","url":"https://rc1242rc.github.io/documentation/code/darkbit/files/topness_8h/","name":"file ColliderBit\/topness.h","description":"[No description available]","isPartOf":{"@id":"https://rc1242rc.github.io/#/schema/website/1"},"about":{"@id":"https://rc1242rc.github.io/#/schema/organization/1"},"datePublished":"0001-01-01T00:00:00CET","dateModified":"0001-01-01T00:00:00CET","breadcrumb":{"@id":"https://rc1242rc.github.io/documentation/code/darkbit/files/topness_8h/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://rc1242rc.github.io/documentation/code/darkbit/files/topness_8h/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://rc1242rc.github.io/documentation/code/darkbit/files/topness_8h/"]}]},{"@type":"BreadcrumbList","@id":"https://rc1242rc.github.io/documentation/code/darkbit/files/topness_8h/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://rc1242rc.github.io/","url":"https://rc1242rc.github.io/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://rc1242rc.github.io/documentation/","url":"https://rc1242rc.github.io/documentation/","name":"Documentation"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://rc1242rc.github.io/documentation/code/","url":"https://rc1242rc.github.io/documentation/code/","name":"Code"}},{"@type":"ListItem","position":4,"item":{"@type":"WebPage","@id":"https://rc1242rc.github.io/documentation/code/darkbit/","url":"https://rc1242rc.github.io/documentation/code/darkbit/","name":"Darkbit"}},{"@type":"ListItem","position":5,"item":{"@type":"WebPage","@id":"https://rc1242rc.github.io/documentation/code/darkbit/files/","url":"https://rc1242rc.github.io/documentation/code/darkbit/files/","name":"Files"}},{"@type":"ListItem","position":6,"item":{"@id":"https://rc1242rc.github.io/documentation/code/darkbit/files/topness_8h/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://rc1242rc.github.io/documentation/code/darkbit/files/topness_8h/#/schema/image/2","url":"https://rc1242rc.github.io/gambit_logo.png","contentUrl":"https://rc1242rc.github.io/gambit_logo.png","caption":"file ColliderBit\/topness.h"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=https://rc1242rc.github.io/favicon.ico sizes=any><link rel=icon type=image/svg+xml href=https://rc1242rc.github.io/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=https://rc1242rc.github.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://rc1242rc.github.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://rc1242rc.github.io/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://rc1242rc.github.io/site.webmanifest></head><body class="documentation single light"><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-md navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-md-nowrap" aria-label="Main navigation"><a class="navbar-brand p-0 me-auto" href=https://rc1242rc.github.io/ aria-label=GAMBIT><img class=logo-light src=https://rc1242rc.github.io//images/gambit_logo.png width=50px>
<img class="logo-dark d-none" src=https://rc1242rc.github.io//images/gambit_logo.png width=50px>
GAMBIT</a>
<button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=/>GAMBIT</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Documentation
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=/documentation/installation/introduction/>Installation</a></li><li><a class=dropdown-item href=/documentation/examples/colliderbit_example>Examples</a></li><li><a class=dropdown-item href=/documentation/help/faqs/>Help</a></li><li><a class=dropdown-item href=/documentation/code/gambit_sphinx/index_classes>Code Reference</a></li></ul></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Community
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=/community/publications/>Publications</a></li><li><a class=dropdown-item href=/community/talks/>Talks</a></li><li><a class=dropdown-item href=/community/members/>Members</a></li><li><a class=dropdown-item href=/community/code_of_conduct/>Code of Conduct</a></li><li><a class=dropdown-item href=/community/contact/>Contact</a></li></ul></li></ul><hr class="text-black-50 my-4 d-lg-none"><form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2"><input id=search class="form-control is-search" type=search placeholder="Search site..." aria-label="Search site..." autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=https://github.com/GambitBSM><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-lg-none">GitHub</small></a></li></ul><hr class="text-black-50 my-4 d-lg-none"><div class=dropdown><button class="btn btn-doks-light dropdown-toggle" id=doks-versions data-bs-toggle=dropdown aria-expanded=false data-bs-display=static aria-label="Toggle version menu">
<span class=d-none>Doks</span>
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></button><ul class="dropdown-menu dropdown-menu-lg-end me-lg-2 shadow rounded border-0" aria-labelledby=doks-versions></ul></div></div></div></nav></header></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-installation aria-expanded=false>
Installation</button><div class=collapse id=section-installation><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/installation/introduction/>Getting Started</a></li><li><a class="docs-link rounded" href=/documentation/installation/docker_usage/>Docker Usage</a></li><li><a class="docs-link rounded" href=/documentation/installation/installation_for_linux/>Installation for Linux</a></li><li><a class="docs-link rounded" href=/documentation/installation/installation_for_windows/>Installation for Windows</a></li><li><a class="docs-link rounded" href=/documentation/installation/installation_for_macos/>Installation for macOS</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-examples aria-expanded=false>
Examples</button><div class=collapse id=section-examples><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/examples/colliderbit_example/>ColliderBit Example</a></li><li><a class="docs-link rounded" href=/documentation/examples/anotherbit/>AnotherBit</a></li><li><a class="docs-link rounded" href=/documentation/examples/anotherbit2/>AnotherBit2</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-help aria-expanded=false>
Help</button><div class=collapse id=section-help><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/help/faqs/>FAQs</a></li><li><a class="docs-link rounded" href=/documentation/help/compiler_matrix/>Compiler Matrix</a></li><li><a class="docs-link rounded" href=/documentation/help/known_issues/>Known Issues</a></li><li><a class="docs-link rounded" href=/documentation/help/configuration_examples/>Configuration Examples</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-code aria-expanded=true>
Code Reference</button><div class="collapse show" id=section-code><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-gambit_sphinx aria-expanded=true>
<font style="color: #5d2f86;" size=-6>release</font> &nbsp; gambit sphinx</button><div class="collapse show" id=section-gambit_sphinx><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/code/gambit_sphinx/index_classes/>Classes</a></li><li><a class="docs-link rounded" href=/documentation/code/gambit_sphinx/index_files/>Files</a></li><li><a class="docs-link rounded" href=/documentation/code/gambit_sphinx/index_pages/>Pages</a></li><li><a class="docs-link rounded" href=/documentation/code/gambit_sphinx/index_namespaces/>Namespaces</a></li></ul></div></li><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-ColliderBit aria-expanded=true>
<font style="color: #5d2f86;" size=-6>development</font> &nbsp; ColliderBit</button><div class="collapse show" id=section-ColliderBit><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/code/colliderbit/index_classes/>Classes</a></li><li><a class="docs-link rounded" href=/documentation/code/colliderbit/index_files/>Files</a></li><li><a class="docs-link rounded" href=/documentation/code/colliderbit/index_pages/>Pages</a></li><li><a class="docs-link rounded" href=/documentation/code/colliderbit/index_namespaces/>Namespaces</a></li></ul></div></li><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-DarkBit aria-expanded=true>
<font style="color: #5d2f86;" size=-6>development</font> &nbsp; DarkBit</button><div class="collapse show" id=section-DarkBit><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/code/darkbit/index_classes/>Classes</a></li><li><a class="docs-link rounded" href=/documentation/code/darkbit/index_files/>Files</a></li><li><a class="docs-link rounded" href=/documentation/code/darkbit/index_pages/>Pages</a></li><li><a class="docs-link rounded" href=/documentation/code/darkbit/index_namespaces/>Namespaces</a></li></ul></div></li><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-main aria-expanded=true>
<font style="color: #5d2f86;" size=-6>development</font> &nbsp; main</button><div class="collapse show" id=section-main><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/code/main/index_classes/>Classes</a></li><li><a class="docs-link rounded" href=/documentation/code/main/index_files/>Files</a></li><li><a class="docs-link rounded" href=/documentation/code/main/index_pages/>Pages</a></li><li><a class="docs-link rounded" href=/documentation/code/main/index_namespaces/>Namespaces</a></li></ul></div></li></ul></div></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span>On this page</span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><ul><li><a href=#classes>Classes</a></li><li><a href=#functions>Functions</a></li><li><a href=#attributes>Attributes</a></li><li><a href=#functions-documentation>Functions Documentation</a><ul><li><a href=#function-my_lp>function my_lp</a></li><li><a href=#function-my_add>function my_add</a></li><li><a href=#function-my_dot>function my_dot</a></li><li><a href=#function-my_dot-1>function my_dot</a></li><li><a href=#function-my_enorm>function my_enorm</a></li><li><a href=#function-topnesscompute>function topnesscompute</a></li></ul></li><li><a href=#attributes-documentation>Attributes Documentation</a><ul><li><a href=#variable-mt>variable mt</a></li><li><a href=#variable-mw>variable mW</a></li><li><a href=#variable-dmax>variable DMAX</a></li></ul></li><li><a href=#source-code>Source code</a></li></ul></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3>On this page</h3><nav id=TableOfContents><ul><li><ul><li><a href=#classes>Classes</a></li><li><a href=#functions>Functions</a></li><li><a href=#attributes>Attributes</a></li><li><a href=#functions-documentation>Functions Documentation</a><ul><li><a href=#function-my_lp>function my_lp</a></li><li><a href=#function-my_add>function my_add</a></li><li><a href=#function-my_dot>function my_dot</a></li><li><a href=#function-my_dot-1>function my_dot</a></li><li><a href=#function-my_enorm>function my_enorm</a></li><li><a href=#function-topnesscompute>function topnesscompute</a></li></ul></li><li><a href=#attributes-documentation>Attributes Documentation</a><ul><li><a href=#variable-mt>variable mt</a></li><li><a href=#variable-mw>variable mW</a></li><li><a href=#variable-dmax>variable DMAX</a></li></ul></li><li><a href=#source-code>Source code</a></li></ul></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9 mx-xl-auto"><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=/>Home</a></li><li class=breadcrumb-item><a href=/documentation/>Documentation</a></li><li class=breadcrumb-item><a href=/documentation/code/>Code Reference</a></li><li class=breadcrumb-item><a href=/documentation/code/darkbit/>DarkBit</a></li><li class="breadcrumb-item active" aria-current=page>file ColliderBit/topness.h</li></ol></nav><h1>file ColliderBit/topness.h</h1><p class=lead></p><p>[No description available]</p><h2 id=classes>Classes <a href=#classes class=anchor aria-hidden=true>#</a></h2><table><thead><tr><th></th><th>Name</th></tr></thead><tbody><tr><td>struct</td><td><strong><a href=/documentation/code/darkbit/classes/structmy__func/>my_func</a></strong></td></tr><tr><td>class</td><td><strong><a href=/documentation/code/darkbit/classes/classmy__simplex/>my_simplex</a></strong></td></tr><tr><td>class</td><td><strong><a href=/documentation/code/darkbit/classes/classmy__nelder__mead/>my_Nelder_Mead</a></strong></td></tr></tbody></table><h2 id=functions>Functions <a href=#functions class=anchor aria-hidden=true>#</a></h2><table><thead><tr><th></th><th>Name</th></tr></thead><tbody><tr><td>double</td><td><strong><a href=/documentation/code/darkbit/files/topness_8h/#function-my-lp>my_lp</a></strong>(double u[4], double v[4])</td></tr><tr><td>void</td><td><strong><a href=/documentation/code/darkbit/files/topness_8h/#function-my-add>my_add</a></strong>(double a[4], double b[4], double c[4])</td></tr><tr><td>double</td><td><strong><a href=/documentation/code/darkbit/files/topness_8h/#function-my-dot>my_dot</a></strong>(double p1[], double p2[], int d)</td></tr><tr><td>double</td><td><strong><a href=/documentation/code/darkbit/files/topness_8h/#function-my-dot>my_dot</a></strong>(double p1[], double p2[], double a[], int d)</td></tr><tr><td>double</td><td><strong><a href=/documentation/code/darkbit/files/topness_8h/#function-my-enorm>my_enorm</a></strong>(double p[], int d)</td></tr><tr><td>double</td><td><strong><a href=/documentation/code/darkbit/files/topness_8h/#function-topnesscompute>topnesscompute</a></strong>(double pb1[4], double pl[4], double MET[4], double sigmat, double sigmaW)</td></tr></tbody></table><h2 id=attributes>Attributes <a href=#attributes class=anchor aria-hidden=true>#</a></h2><table><thead><tr><th></th><th>Name</th></tr></thead><tbody><tr><td>const double</td><td><strong><a href=/documentation/code/darkbit/files/topness_8h/#variable-mt>mt</a></strong></td></tr><tr><td>const double</td><td><strong><a href=/documentation/code/darkbit/files/topness_8h/#variable-mw>mW</a></strong></td></tr><tr><td>const int</td><td><strong><a href=/documentation/code/darkbit/files/topness_8h/#variable-dmax>DMAX</a></strong></td></tr></tbody></table><h2 id=functions-documentation>Functions Documentation <a href=#functions-documentation class=anchor aria-hidden=true>#</a></h2><h3 id=function-my_lp>function my_lp <a href=#function-my_lp class=anchor aria-hidden=true>#</a></h3><pre><code>double my_lp(
    double u[4],
    double v[4]
)
</code></pre><h3 id=function-my_add>function my_add <a href=#function-my_add class=anchor aria-hidden=true>#</a></h3><pre><code>void my_add(
    double a[4],
    double b[4],
    double c[4]
)
</code></pre><h3 id=function-my_dot>function my_dot <a href=#function-my_dot class=anchor aria-hidden=true>#</a></h3><pre><code>double my_dot(
    double p1[],
    double p2[],
    int d
)
</code></pre><h3 id=function-my_dot-1>function my_dot <a href=#function-my_dot-1 class=anchor aria-hidden=true>#</a></h3><pre><code>double my_dot(
    double p1[],
    double p2[],
    double a[],
    int d
)
</code></pre><h3 id=function-my_enorm>function my_enorm <a href=#function-my_enorm class=anchor aria-hidden=true>#</a></h3><pre><code>double my_enorm(
    double p[],
    int d
)
</code></pre><h3 id=function-topnesscompute>function topnesscompute <a href=#function-topnesscompute class=anchor aria-hidden=true>#</a></h3><pre><code>double topnesscompute(
    double pb1[4],
    double pl[4],
    double MET[4],
    double sigmat,
    double sigmaW
)
</code></pre><h2 id=attributes-documentation>Attributes Documentation <a href=#attributes-documentation class=anchor aria-hidden=true>#</a></h2><h3 id=variable-mt>variable mt <a href=#variable-mt class=anchor aria-hidden=true>#</a></h3><pre><code>const double mt =172.;
</code></pre><h3 id=variable-mw>variable mW <a href=#variable-mw class=anchor aria-hidden=true>#</a></h3><pre><code>const double mW =80.4;
</code></pre><h3 id=variable-dmax>variable DMAX <a href=#variable-dmax class=anchor aria-hidden=true>#</a></h3><pre><code>const int DMAX =4;
</code></pre><h2 id=source-code>Source code <a href=#source-code class=anchor aria-hidden=true>#</a></h2><pre><code>#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;cstdlib&gt;
#include &lt;cmath&gt;

#include &quot;gambit/Utils/threadsafe_rng.hpp&quot;

// ****** Copy from https://github.com/michaelgraesser/topness *****
// ****** arXiv:1212.4495 ******************************************
// Modified according to https://arxiv.org/pdf/1612.03877.pdf
/* &quot;The definition of topness used in this analysis is modified from
    the one originally proposed in [arXiv:1212.4495]: namely, the terms
    corresponding to the detected leptonic top quark decay and the
    centre-of-mass energy are dropped since in events with low jet
    multiplicity the second b jet is often not identified.
    In these cases, the discriminating power of the topness variable
    is reduced when a light-flavour jet is used instead in the calculation.

    Modified further by Pat Scott, Feb 9 2019, to use GAMBIT random
    number generator.

    This is a BSD License. Code written by Michael L. Graesser.

    Copyright (c) 2016, Los Alamos National Security, LLC
    All rights reserved.
    Copyright 2016. Los Alamos National Security, LLC. This software was produced under U.S. Government contract DE-AC52-06NA25396 for Los Alamos National Laboratory (LANL), which is operated by Los Alamos National Security, LLC for the U.S. Department of Energy. The U.S. Government has rights to use, reproduce, and distribute this software.  NEITHER THE GOVERNMENT NOR LOS ALAMOS NATIONAL SECURITY, LLC MAKES ANY WARRANTY, EXPRESS OR IMPLIED, OR ASSUMES ANY LIABILITY FOR THE USE OF THIS SOFTWARE.  If software is modified to produce derivative works, such modified software should be clearly marked, so as not to confuse it with the version available from LANL.

    Additionally, redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
    1.       Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
    2.      Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
    3.      Neither the name of Los Alamos National Security, LLC, Los Alamos National Laboratory, LANL, the U.S. Government, nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY LOS ALAMOS NATIONAL SECURITY, LLC AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL LOS ALAMOS NATIONAL SECURITY, LLC OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  */

// using namespace std;
// &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
// &gt;&gt;&gt;&gt;&gt;&gt; topness_struct.cpp &amp; topness_struct.h in &quot;topness&quot; &lt;&lt;&lt;&lt;&lt;&lt;&lt;
const double mt=172.;  // top quark mass
const double mW=80.4;  // W mass
double my_lp(double u[4], double v[4])
{    // Lorentz product . assume x, y Lorentz vectors ordered as (px,py,pz,E) etc. Initialize with
  // metric g==(-1,-1,-1,1)

  double g[]={-1.,-1.,-1.,1.};
  double s=0;
  for (int j=0;j&lt;4;j++)
    {s+= u[j]*g[j]*v[j]; }
  return s;
}
void my_add(double a[4], double b[4], double c[4])
{
  for (int i=0; i&lt;4; i++)
    {
      c[i]=a[i]+b[i];
    }
}
struct my_func
{
  double pb1[4];
//  double pb2[4];
  double pl[4];
  double pMET[4];
  double sigmat, sigmaW, sign;
  // ***Modified by Yang Zhang 23.1.2018
  my_func(double ppb1[4], double ppl[4], double ppMET[4], double sigmatt, double sigmaWW, double ssign) :
  sigmat (sigmatt), sigmaW(sigmaWW), sign(ssign) {
    pb1[0]=ppb1[0];
    pb1[1]=ppb1[1];
    pb1[2]=ppb1[2];
    pb1[3]=ppb1[3];
//    pb2[0]=ppb2[0];
//    pb2[1]=ppb2[1];
//    pb2[2]=ppb2[2];
//    pb2[3]=ppb2[3];
    pl[0]=ppl[0];
    pl[1]=ppl[1];
    pl[2]=ppl[2];
    pl[3]=ppl[3];
    pMET[0]=ppMET[0];
    pMET[1]=ppMET[1];
    pMET[2]=ppMET[2];
    pMET[3]=ppMET[3];
  }
  double operator()(double points[],int /*d*/) {  // points[0]=pv_x, points[1]=pv_y, points[2]=pv_z, points[3]=pW_z
    // d is size of points = 4
    // pv_x, pv_y, pv_z
    double pvx=points[0];
    double pvy=points[1];
    double pvz=points[2];
    // neutrino energy assuming mass-shell condition
    double Ev=sqrt(pow(pvx,2)+pow(pvy,2)+pow(pvz,2));

    double pv[]={pvx,pvy,pvz,Ev};

    // pW_z
    double pWz=points[3];
    // std::cout &lt;&lt; &quot;points=&quot; &lt;&lt; pvx &lt;&lt; &quot;, &quot; &lt;&lt; pvy &lt;&lt; &quot;, &quot; &lt;&lt; pvz &lt;&lt; &quot;, &quot; &lt;&lt; pWz &lt;&lt; std::endl;
    // W momenta from neutrino and MET
    double pW[]={-pvx+pMET[0],-pvy+pMET[1],pWz,sqrt(pow(-pvx+pMET[0],2)+pow(-pvy+pMET[1],2)+pow(pWz,2) + pow(mW,2))};

    double pb1W[4];
    my_add(pb1,pW,pb1W);
    double plv[4];
    my_add(pl,pv,plv);
//    double pb2lv[4];
//    my_add(pb2,plv,pb2lv);
    // function to minimize
    double fsum=0.;
    // ***Modified by Yang Zhang 23.1.2018
    fsum= pow(my_lp(pb1W,pb1W)-pow(mt,2),2)/pow(sigmat,4)+pow(my_lp(plv,plv)-pow(mW,2),2)/pow(sigmaW,4);
    //+pow(my_lp(pb2lv,pb2lv)-pow(mt,2),2)/pow(sigmat,4)+pow(my_lp(plv,plv)-pow(mW,2),2)/pow(sigmaW,4);
    //std::cout &lt;&lt; &quot;fsum = &quot; &lt;&lt; fsum &lt;&lt; std::endl;
    return sign*fsum;
  }
};

// &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
// &gt;&gt;&gt;&gt;&gt;&gt; simplex.cpp &amp; simplex.h in &quot;my_Nelder_Mead&quot; &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
const int DMAX=4; // # parameters to scan over, not the space-time dimension! Number of points in the simplex is DMAX+1.
double my_dot(double p1[], double p2[], int d)   // d is size of arrays
{
// compute euclidean dot product between p1 and p2
  double value=0.;
  for (int i=0; i&lt;d; i++)
    {
      //      std::cout &lt;&lt; &quot;p1: &quot; &lt;&lt; p1[i] &lt;&lt;&quot;, p2:&quot; &lt;&lt; p2[i] &lt;&lt; std::endl;
      value+=p1[i]*p2[i];
    }
  //std::cout &lt;&lt; &quot;dp value is &quot; &lt;&lt; value &lt;&lt; std::endl;
  return value;
}
double my_dot(double p1[], double p2[], double a[], int d)   // d is size of arrays
{
  // compute euclidean dot product between p1 and p2 with weights a

  double value=0.;
  for (int i=0; i&lt;d; i++)
    {
      value+=a[i]*p1[i]*p2[i];
    }
  return value;
}
double my_enorm(double p[], int d)
{
  // compute euclidean norm of p
  double value=0.;
  double norm=0.;
  for (int i=0; i&lt;d; i++)
    {
      value+=p[i]*p[i];
    }
  if (value&gt;0.)
    {
      norm=sqrt(value);
    }
  else
    {
      norm=0.;
    }
  return norm;
}
class my_simplex{
// co-ordinate space is d dimensional. analysis uses N=d+1 points
 private:
  int d;
  double alpha, beta, gamma;

 public:
  my_func *f;
  my_simplex(int, double, double, double, my_func *);
  double xstart[DMAX*(DMAX+1)]; // length (d+1)*d. d elements are coordinates
  double x[DMAX*(DMAX+1)]; //    current polygon instance containing d+1 points of d dimension each, so size is d(d+1)
  double xh[DMAX]; // coordinates of point with highest value
  double xl[DMAX]; // coordinates of point with lowest value
  double y[DMAX+1]; // function values at x
  double yl, ynh, yh; // lowest, next highest, and highest function values
  double xCentroid[DMAX]; // current centroid;
  double yReflect, yExpand, yContract; // function values at these points
  double xReflect[DMAX]; // P* reflection
  double xExpand[DMAX]; // P** expansion
  double xContract[DMAX]; // P*** contraction
  void find_min();
  void find_max();
  int imin,imax, inmax;
  void my_SetUp(double xin[]);
  void set_y();
  void my_Centroid(int);
  void my_Reflection();
  void my_Expansion();
  void my_Contraction();
  void replace_all();
  double get_yavg();
  double get_sigma();
  void print_Centroid();
  void print_Reflect();
  void print_Expand();
  void print_Contract();
  void print_max();
  void print_min();
  void print_all();
  void print_xy();
  void print_xyl();
  void print_xyh();
};

class my_Nelder_Mead {
 private:
  int d;
  int Ntry;      // N cycles of Nelder-Mead algorithm
  double eps;

 public:
  my_func *f;
  my_simplex simplex;
  bool convergeYes; // set to True when algorithm has converged
  my_Nelder_Mead(int, double, double, double, int, double, my_func *);
  bool one_cycle(my_simplex *);
  bool find_global_min(double xin[DMAX*(DMAX+1)]);
  double yfinal;
  double xfinal[DMAX*(DMAX+1)];
};


my_simplex::my_simplex(int dd, double aalpha, double bbeta, double ggamma,  my_func (*ff)) : d(dd), alpha(aalpha), beta(bbeta), gamma(ggamma), f(ff){}
// check d and size of xin agree

void my_simplex::my_SetUp(double xin[DMAX*(DMAX+1)])
{
  int D=d*(d+1);
  std::copy(xin,xin+D,xstart);
  for (int i=0; i&lt;D; i++)
    {
      x[i]=xstart[i];
    }

  for (int i=0; i&lt;d+1; i++)
    {
      double xi[d];
      std::copy(x+d*i,x+d*i+d,xi);  // get coordinates of i'th point and copy into xi
           y[i]=(*f)(xi,d);
    }
}

void my_simplex::set_y()
{
  for (int i=0; i&lt;d+1; i++)
    {
      double xi[d];
      std::copy(x+d*i,x+d*i+d,xi);  // get coordinates of i'th point and copy into xi
      y[i]=(*f)(xi,d);
    }
}

void my_simplex::find_max()
{
  for (int i=0; i&lt;d+1; i++)
    {
      if (y[i]&gt; y[imax])
    imax=i;
    }
  // now find second highest
  if (imax==1)
    inmax=0;

  for (int i=0; i&lt;d+1; i++)
    {
      if (i==imax) continue;
      if (y[i] &gt; y[inmax])
    {
      inmax=i;
    }
    }

  yh=y[imax];
  ynh=y[inmax];
  // find coordinates with maximum value
  for (int j=0; j&lt;d; j++)
    {
      xh[j]=x[d*imax+j];
    }
}

void my_simplex::find_min()
{
  imin=0;   // first function value f(x_1)
  for (int i=0; i&lt;d+1; i++)
    {
       if (y[i]&lt; y[imin])
       {
        imin=i;
       }
    }

  yl=y[imin];

  // find coordinates with minimum value
  for (int j=0; j&lt;d; j++)
    {
      xl[j]=x[d*imin+j];
    }

}

void my_simplex::my_Centroid(int h)
/* return P_bar */
{
  // compute centroid
  for (int j=0; j&lt;d; j++)
    {
      xCentroid[j]=0;
      for (int i=0; i&lt; d+1; i++)
    {
      if (i==h) continue;
      xCentroid[j]+=x[d*i+j];
    }
    }
}

void my_simplex::my_Reflection() // h is highest point
/* return P*
   REFLECTION  P*=(1+alpha)P_bar - alpha*P_h   */
{
  for (int i=0; i&lt;d;i++)
  {
    xReflect[i] = xCentroid[i]*(1+alpha)/d- alpha*xh[i];
  }
  yReflect=(*f)(xReflect,d);
}

void my_simplex:: my_Expansion()
/* return EXPANSION P** =(1+gamma)*P* -gamma* P_bar */
{
  for (int j=0; j&lt;d; j++)
  {
    xExpand[j] =xCentroid[j]*(1-gamma)/d+ (gamma)*xReflect[j];
  }
  yExpand=(*f)(xExpand,d);

}

void my_simplex:: my_Contraction()
/* return CONTRACTION P*** =beta* Ph +(1-beta)*P_bar */
{
  for (int j=0; j&lt;d; j++)
  {
    xContract[j]=xCentroid[j]*(1-beta)/d+beta*xh[j];
  }
  yContract=(*f)(xContract,d);
}

void my_simplex::replace_all()
{
  for (int i=0; i&lt;d+1; i++)
    {
      if (i==imin) continue;
      for (int j=0; j&lt;d; j++)
    {
      x[d*i+j]=0.5*(x[d*i+j]+xl[j]);
    }
    }
}

double my_simplex::get_yavg()
{
  double yavg=0.;
  for (int i=0; i&lt;d+1; i++)
    {
      yavg+=y[i];
    }
  yavg=yavg/(d+1);
  return yavg;
}

double my_simplex::get_sigma()
{
  double yavg=0.;
  double sigma=0;
  for (int i=0; i&lt;d+1; i++)
    {
      yavg+=y[i];
    }
  yavg=yavg/(d+1);
  for (int i=0; i&lt;d+1; i++)
    {
      sigma+=pow((y[i]-yavg),2);
    }

  sigma=sigma/(d+1);
  return sigma;
}

void my_simplex::print_Centroid()
{

  std::cout &lt;&lt; &quot;Current xCentroid is : &quot; &lt;&lt; std::endl;
  for (int k=0;k&lt;d; k++)
    {
      std::cout &lt;&lt; xCentroid[k];
      if (k==d-1)
    std::cout &lt;&lt; std::endl;
      else std::cout&lt;&lt; &quot;, &quot;;

    }
}

void my_simplex::print_Reflect()
{
  std::cout &lt;&lt; &quot;Current xReflect and y value are : &quot; &lt;&lt; std::endl;
  for (int k=0;k&lt;d; k++)
    {
      std::cout &lt;&lt; xReflect[k];
      if (k==d-1)
    std::cout &lt;&lt;&quot;, &quot; &lt;&lt; yReflect &lt;&lt; std::endl;
      else std::cout&lt;&lt; &quot;, &quot;;

    }
}

void my_simplex::print_Expand()
{

  std::cout &lt;&lt; &quot;Current xExpand and y value are : &quot; &lt;&lt; std::endl;
  for (int k=0;k&lt;d; k++)
    {
      std::cout &lt;&lt; xExpand[k];
      if (k==d-1)
    std::cout &lt;&lt; &quot;, &quot; &lt;&lt; yExpand &lt;&lt; std::endl;
      else std::cout&lt;&lt; &quot;, &quot;;

    }
}

void my_simplex::print_Contract()
{
  std::cout &lt;&lt; &quot;Current xContract and y value are : &quot; &lt;&lt; std::endl;
  for (int k=0; k&lt;d; k++)
    {
      std::cout &lt;&lt; xContract[k];
      if (k==d-1)
    std::cout &lt;&lt; &quot;, &quot; &lt;&lt; yContract &lt;&lt; std::endl;
      else std::cout &lt;&lt; &quot;, &quot;;

    }

}

void my_simplex::print_max()
{
  std::cout &lt;&lt; &quot;Printing imax and inmax and their values &quot; &lt;&lt; std::endl;
  std::cout &lt;&lt; &quot;imax = &quot; &lt;&lt; imax &lt;&lt; &quot;, y[imax] = &quot; &lt;&lt; yh &lt;&lt; std::endl;
  std::cout &lt;&lt; &quot;inmax = &quot; &lt;&lt; inmax &lt;&lt; &quot;, y[inmax] = &quot; &lt;&lt; ynh &lt;&lt; std::endl;
}

void my_simplex::print_min()
{
  std::cout &lt;&lt; &quot;Printing imin and its value &quot; &lt;&lt; std::endl;
  std::cout &lt;&lt; &quot;imin = &quot; &lt;&lt; imin &lt;&lt; &quot;, y[imin] = &quot; &lt;&lt; yl &lt;&lt; std::endl;
}

void my_simplex::print_xyh()
{
  std::cout &lt;&lt; &quot;The highest value is &quot; &lt;&lt; std::endl;
  for (int i=0; i&lt;d; i++)
    {
      std::cout &lt;&lt; xh[i];
      if ((i+1)% d !=0)
        {
          std::cout &lt;&lt; &quot;, &quot; ;
        }
      else
        {
          std::cout &lt;&lt; &quot;, &quot; &lt;&lt; yh &lt;&lt; std::endl;
        }
    }
}

void my_simplex::print_xyl()
{
  std::cout &lt;&lt; &quot;The lowest value is &quot; &lt;&lt; std::endl;
  for (int i=0; i&lt;d; i++)
    {
      std::cout &lt;&lt; xl[i];
      if ((i+1)% d !=0)
        {
          std::cout &lt;&lt; &quot;, &quot; ;
        }
      else
        {
          std::cout &lt;&lt; &quot;, &quot; &lt;&lt; yl &lt;&lt; std::endl;
        }
    }

}

void my_simplex::print_xy()
{
  // print current x and y
  std::cout &lt;&lt; &quot;Current x and y values are: &quot; &lt;&lt; std::endl;
  for (int i=0; i&lt; d*(d+1); i++)
    {
      std::cout &lt;&lt; x[i];
      if ((i+1) % d !=0)
        {
          std::cout &lt;&lt; &quot;, &quot;;
        }
      else
        {
          div_t ratio;
          ratio=div(i,d);
      std::cout &lt;&lt; &quot;, &quot; &lt;&lt; y[ratio.quot] &lt;&lt; std::endl;
        }
    }

}
void my_simplex::print_all()
{
// print current x
  std::cout &lt;&lt; &quot;Current x values are: &quot; &lt;&lt; std::endl;
  for (int i=0; i&lt; d*(d+1); i++)
    {
      std::cout &lt;&lt; x[i];
      if ((i+1) % d !=0)
    {
      std::cout &lt;&lt; &quot;, &quot;;
    }
      else
    {
      div_t ratio;
      ratio=div(i,d);
      std::cout &lt;&lt; &quot;, &quot; &lt;&lt; y[ratio.quot]&lt;&lt;std::endl;
    }
    }
  std::cout &lt;&lt; &quot;Current centroid: &quot; &lt;&lt; std::endl;
  for (int i=0; i&lt; d; i++)
      {
    std::cout &lt;&lt; xCentroid[i];
          if ((i+1) % d !=0)
          {
          std::cout &lt;&lt; &quot;, &quot;;
           }
          else
          {
        std::cout &lt;&lt; std::endl;
          }
     }
  std::cout &lt;&lt; &quot;Current Reflection: &quot; &lt;&lt; std::endl;
  for (int i=0; i&lt; d; i++)
     {
         std::cout &lt;&lt; xReflect[i];
     if ((i+1) % d !=0)
     {
         std::cout &lt;&lt; &quot;, &quot;;
     }
     else
     {
       std::cout &lt;&lt; &quot;, &quot; &lt;&lt; yReflect &lt;&lt; std::endl;
     }
    }
  std::cout &lt;&lt; &quot;Current Expansion: &quot; &lt;&lt; std::endl;
  for (int i=0; i&lt; d; i++)
      {
    std::cout &lt;&lt; xExpand[i];
      if ((i+1) % d !=0)
      {
          std::cout &lt;&lt; &quot;, &quot;;
      }
      else
      {
        std::cout &lt;&lt; &quot;, &quot; &lt;&lt; yExpand &lt;&lt; std::endl;
      }
      }
  std::cout &lt;&lt; &quot;Current Contraction: &quot; &lt;&lt; std::endl;
  for (int i=0; i&lt; d; i++)
      {
    std::cout &lt;&lt; xContract[i];
      if ((i+1) % d !=0)
      {
          std::cout &lt;&lt; &quot;, &quot;;
      }
      else
      {
        std::cout &lt;&lt; &quot;, &quot; &lt;&lt; yContract &lt;&lt; std::endl;
      }
     }
  std::cout &lt;&lt; &quot;The highest value is &quot; &lt;&lt; std::endl;
  for (int i=0; i&lt;d; i++)
    {
      std::cout &lt;&lt; xh[i];
      if ((i+1)% d !=0)
    {
      std::cout &lt;&lt; &quot;, &quot; ;
    }
      else
    {
      std::cout &lt;&lt; &quot;, &quot; &lt;&lt; yh &lt;&lt; std::endl;
    }
    }
  std::cout &lt;&lt; &quot;The lowest value is &quot; &lt;&lt; std::endl;
  for (int i=0; i&lt;d; i++)
    {
      std::cout &lt;&lt; xl[i];
      if ((i+1)% d !=0)
        {
          std::cout &lt;&lt; &quot;, &quot; ;
        }
      else
        {
          std::cout &lt;&lt; &quot;, &quot; &lt;&lt; yl &lt;&lt; std::endl;
        }
    }
    std::cout &lt;&lt; &quot;The lowest point is imin=&quot; &lt;&lt; imin &lt;&lt; std::endl;

    std::cout &lt;&lt; &quot;The highest point is imax=&quot; &lt;&lt; imax &lt;&lt; std::endl;

    std::cout &lt;&lt; &quot;The next highest point is inmax=&quot; &lt;&lt; inmax &lt;&lt; std::endl;
}


my_Nelder_Mead::my_Nelder_Mead(int dd, double alpha, double beta, double gamma, int NNtry, double eeps, my_func *ff): d(dd), Ntry(NNtry), eps(eeps), f(ff), simplex(dd, alpha, beta, gamma, f){}

bool my_Nelder_Mead::one_cycle(my_simplex *s)
{
// execute one-iteration of Nelder-Mead method
  (*s).my_Centroid((*s).imax);
  //  (*s).print_Centroid();
  (*s).my_Reflection();
  // (*s).print_Reflect();
  if ((*s).yReflect &lt;= (*s).yl)
    {
      // do expansion
      (*s).my_Expansion();
      //      (*s).print_Expand();
      if ((*s).yExpand &lt; (*s).yl)
    {
      // replace P_h with P_**
      std::copy((*s).xExpand,(*s).xExpand+d, (*s).x+d*((*s).imax));
      (*s).set_y();
      return false;
    }
      else
    {
      // replace P_h with P_*
      std::copy((*s).xReflect,(*s).xReflect+d, (*s).x+d*((*s).imax));
      (*s).set_y();
      return true;
    }
    }
  else if (((*s).yReflect) &gt;= (*s).ynh ) // do contraction
    {
      if (((*s).yReflect) &lt; (*s).yh)
    {
      std::copy((*s).xReflect,(*s).xReflect+d, (*s).x+d*((*s).imax));
      (*s).set_y();
      (*s).find_max();
    }
      (*s).my_Contraction();
      //    (*s).print_Contract();
      if ((*s).yContract &lt; (*s).yh)
    {
      std::copy((*s).xContract,(*s).xContract+d, (*s).x+d*((*s).imax));
      (*s).set_y();
      return false;

    }
      else
    {
      (*s).replace_all();
      (*s).set_y();
      return false;
    }
     }
  else {
    // replace P_h with P_*
    std::copy((*s).xReflect,(*s).xReflect+d, (*s).x+d*((*s).imax));
    (*s).set_y();
    return true;
  }


}

bool my_Nelder_Mead::find_global_min(double xin[DMAX*(DMAX+1)])
/* try Nelder-Mead cycle Ntry times; if values converge then restart using point near new
minimum  */
{
  // initialize
  yfinal=10000000000000.; // a very large number
  simplex.imax=0;
  simplex.inmax=1;
  simplex.imin=2;
  simplex.my_SetUp(xin);
  simplex.find_max();
  simplex.find_min();
  //  simplex.print_xy();
  //simplex.print_xyh();
  //simplex.print_xyl();
  //simplex.print_max();
  //simplex.print_min();
  convergeYes=false;
  // bool reflectYes=false;
  //  double xnew[DMAX*(DMAX+1)];
  for (int i=0; i&lt;Ntry; i++)
    {
      //reflectYes=
      one_cycle(&amp;simplex);
      //if (reflectYes==true) --i;
      simplex.find_max();
      simplex.find_min();
      double ynewmin=simplex.yl;
      double ynewmax=simplex.yh;
      //     std::cout &lt;&lt; &quot;i=&quot; &lt;&lt; i &lt;&lt; std::endl;
      //std::cout &lt;&lt; std::endl &lt;&lt; std::endl &lt;&lt; std::endl;
      //simplex.print_xy();
      //simplex.print_xyh();
      //simplex.print_xyl();
      //simplex.print_max();
      //simplex.print_min();
      //std::cout &lt;&lt; std::endl &lt;&lt; std::endl &lt;&lt; std::endl;
      // double yavg=simplex.get_yavg();
      //  double sigma=simplex.get_sigma();
      if (std::abs(ynewmax -ynewmin)/(std::abs(ynewmax)+std::abs(ynewmin)+eps) &lt; eps)
      {
        convergeYes=true;

        // save old xi, generate new xstarti = xbest/rndm + rndm*step
        if (ynewmin&lt; yfinal)
          {
        std::copy(simplex.x,simplex.x+d*(d+1),xfinal);
        yfinal=ynewmin;
        //      std::cout &lt;&lt; &quot;final i=&quot; &lt;&lt; i &lt;&lt; &quot;, ymin = &quot; &lt;&lt; ynewmin &lt;&lt; &quot;, ymax = &quot; &lt;&lt; ynewmax &lt;&lt; std::endl;
        break;
          }
    }
    }

  return convergeYes;
}



// &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
// &gt;&gt;&gt;&gt;&gt;&gt; Wrappertopness.cpp &amp; Wrappertopness.h in &quot;topness&quot; &lt;&lt;&lt;&lt;&lt;&lt;&lt;
double topnesscompute(double pb1[4], double pl[4], double MET[4], double sigmat, double sigmaW)
{

  double alpha=1.0; // parameter for reflection
  double beta=0.5;  // parameter for contraction
  double gamma=2.0;  // parameter for expansion

  const int d=4;    // number of parameters to scan over, not the space-time dimension!
  const int DIMMAX=d*(d+1);  // dimension of simplex
  double xin[d+1][d];    // starting point
  double xstart[DIMMAX]; // algorithm stores d+1 points of simplex in a single array


  double eps=0.000002;   // tolerance
  double Deltastep=20.;  // initial spacing of points, in GeV
  int Ntry=100000;    // maximum number of Nelder-Mead cycles to perform for a given initial seed
  int Nattempts=15; //   number of initial starts

  double edir[]={1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1};
  double ybest=1000000000.; // a big number
  double ybest1=100000000.;
  double xbest1[]={1000.,1000.,1000.,1000.};
//  double ybest2=100000000.;  // a big number
//  double xbest2[]={1000.,1000.,1000.,1000.};
  int i,j,k;
  // int tid;
  bool converge1;
// converge2;

  // initialize topness function  ***Modified by Yang Zhang 23.1.2018
  my_func topstat1(pb1,pl,MET,sigmat,sigmaW,1.0);
//  my_func topstat2(pb2,pb1,pl,MET,sigmat,sigmaW,1.0); // other combination

  // initialize topness computation
  my_Nelder_Mead my_check1(d,alpha,beta,gamma, Ntry, eps, &amp;topstat1);
//  my_Nelder_Mead my_check2(d,alpha,beta,gamma, Ntry, eps, &amp;topstat2);
  double yl;
  // begin loop over Nattempts
  for (k=0; k&lt;Nattempts; k++)
    {
      // initialize starting point
      for (i=0;i&lt;d+1; i++)
        {
          for (j=0; j&lt;d; j++)
            {
              if (i==0)
                {
                  xin[0][j]=8000.0*(Gambit::Random::draw()-0.5);
                }
              else
                {
                  xin[i][j]=xin[0][j]+Deltastep*edir[d*(i-1)+j];
                }
            }
          std::copy(xin[i],xin[i]+d, xstart+d*i);  // copy initial data into xstart
        }
      // now first combination
      converge1=my_check1.find_global_min(xstart);
      if (converge1==true)
        {

          yl=my_check1.yfinal;
          if (yl &lt; ybest1)
            {
              ybest1=yl;
              std::copy(my_check1.xfinal,my_check1.xfinal+d,xbest1);
            }
        }
      else
        {
          std::cout &lt;&lt; &quot; Minimum not found...exiting &quot; &lt;&lt; std::endl;
        }
//      // now do second combination
//      converge2=my_check2.find_global_min(xstart);
//      if (converge2==true)
//        {
//          yl=my_check2.yfinal;
//          if (yl &lt; ybest2)
//            {
//              ybest2=yl;
//              std::copy(my_check2.xfinal,my_check2.xfinal+d,xbest2);
//            }
//        }
//      else
//      {
//          std::cout &lt;&lt; &quot; Minimum not found...exiting &quot; &lt;&lt; std::endl;
//        }

    }

//  if (ybest1 &lt; ybest2)
//    {
    ybest=ybest1;
//    std::copy(xbest1,xbest1+d,xbest);
//    }
//   else
//   {
//     ybest=ybest2;
//     std::copy(xbest2,xbest2+d,xbest);
//   }

  return ybest;

}
</code></pre><hr><p>Updated on 2022-08-03 at 12:58:04 +0000</p><div class=edit-page><a href=https://github.com/RC1242RC/gambit_gh_pages/blob/master/content/en/documentation/code/DarkBit/Files/topness_8h.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on GitHub</a></div></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a class=text-muted href=https://www.netlify.com/>Netlify</a>, <a class=text-muted href=https://gohugo.io/>Hugo</a>, and <a class=text-muted href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline><li class=list-inline-item><a href=/license/>License</a></li></ul></div></div></div></footer><script src=/js/bootstrap.min.54bf0932b8a36d0e152b1635b099a6ef1394d35327e2437550a075c9c8ed1bd8aed5847c21b36fc02ed24014c031d9ca24017b0c78b1639d7e2fa8329898b842.js integrity="sha512-VL8JMrijbQ4VKxY1sJmm7xOU01Mn4kN1UKB1ycjtG9iu1YR8IbNvwC7SQBTAMdnKJAF7DHixY51+L6gymJi4Qg==" crossorigin=anonymous defer></script>
<script src=/js/highlight.min.5b48bc253dc75aeea5fb366ecf700f4925e2b6eb1a1466f2124b722d68148d67bc0a9365d2b8ad9c585161b46372d23b08509a16f1fd518542b894756d4752d0.js integrity="sha512-W0i8JT3HWu6l+zZuz3APSSXitusaFGbyEktyLWgUjWe8CpNl0ritnFhRYbRjctI7CFCaFvH9UYVCuJR1bUdS0A==" crossorigin=anonymous defer></script>
<script src=/main.min.40265e9a032aeba5eaf67baac3cbbc22667a7533215d326eeb3e9f4d5e4be40f9ff4dcd22949db73ae527ca26a19d7998091a8973c82af760b2c0daa335190ed.js integrity="sha512-QCZemgMq66Xq9nuqw8u8ImZ6dTMhXTJu6z6fTV5L5A+f9NzSKUnbc65SfKJqGdeZgJGolzyCr3YLLA2qM1GQ7Q==" crossorigin=anonymous defer></script>
<script src=https://rc1242rc.github.io/index.min.cb3cfc52c7c54bd8c25d1fbd0a5de239406787c3dcdce4c8c0c6a90e32667d32f427e033d04af1c0f2c4a86667aa8d3df23f54c6a7873d639d2ca7c2edf7146d.js integrity="sha512-yzz8UsfFS9jCXR+9Cl3iOUBnh8Pc3OTIwMapDjJmfTL0J+Az0ErxwPLEqGZnqo098j9UxqeHPWOdLKfC7fcUbQ==" crossorigin=anonymous defer></script></body></html>