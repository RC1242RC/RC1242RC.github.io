<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://rc1242rc.github.io/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://rc1242rc.github.io/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://rc1242rc.github.io/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var e=localStorage.getItem("theme");e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=https://rc1242rc.github.io/main.f12f7e04ea768acebec10c86baf049d74d6a79f24bc0dfb7ed77aa60462432916dd1ce8f41c78b69496adf650b3039a28a210183cce598f09b95d6fecb5ff999.css integrity="sha512-8S9+BOp2is6+wQyGuvBJ101qefJLwN+37XeqYEYkMpFt0c6PQceLaUlq32ULMDmiiiEBg8zlmPCbldb+y1/5mQ==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>License - GAMBIT</title><meta name=description content="BSD license."><link rel=canonical href=https://rc1242rc.github.io/license/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="License"><meta property="og:description" content="BSD license."><meta property="og:url" content="https://rc1242rc.github.io/license/"><meta property="og:site_name" content="GAMBIT"><meta property="article:published_time" content="2020-08-27T19:25:12+02:00"><meta property="article:modified_time" content="2020-08-27T19:25:12+02:00"><meta property="og:image" content="https://rc1242rc.github.io/gambit_logo.png"><meta property="og:image:alt" content="GAMBIT"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content><meta name=twitter:creator content><meta name=twitter:title content="License"><meta name=twitter:description content="BSD license."><meta name=twitter:image content="https://rc1242rc.github.io/gambit_logo.png"><meta name=twitter:image:alt content="License"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://rc1242rc.github.io/#/schema/organization/1","name":"Doks","url":"https://rc1242rc.github.io/","sameAs":["https://github.com/GambitBSM"],"logo":{"@type":"ImageObject","@id":"https://rc1242rc.github.io/#/schema/image/1","url":"https://rc1242rc.github.io/logo-doks.png","width":450,"height":416,"caption":"Doks"},"image":{"@id":"https://rc1242rc.github.io/#/schema/image/1"}},{"@type":"WebSite","@id":"https://rc1242rc.github.io/#/schema/website/1","url":"https://rc1242rc.github.io/","name":"GAMBIT","description":"Documentation for the Global And Modular BSM Inference Tool","publisher":{"@id":"https://rc1242rc.github.io/#/schema/organization/1"}},{"@type":"WebPage","@id":"https://rc1242rc.github.io/license/","url":"https://rc1242rc.github.io/license/","name":"License","description":"BSD license.","isPartOf":{"@id":"https://rc1242rc.github.io/#/schema/website/1"},"about":{"@id":"https://rc1242rc.github.io/#/schema/organization/1"},"datePublished":"2020-08-27T19:25:12CET","dateModified":"2020-08-27T19:25:12CET","breadcrumb":{"@id":"https://rc1242rc.github.io/license/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://rc1242rc.github.io/license/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://rc1242rc.github.io/license/"]}]},{"@type":"BreadcrumbList","@id":"https://rc1242rc.github.io/license/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://rc1242rc.github.io/","url":"https://rc1242rc.github.io/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"https://rc1242rc.github.io/license/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://rc1242rc.github.io/license/#/schema/image/2","url":"https://rc1242rc.github.io/gambit_logo.png","contentUrl":"https://rc1242rc.github.io/gambit_logo.png","caption":"License"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=https://rc1242rc.github.io/favicon.ico sizes=any><link rel=icon type=image/svg+xml href=https://rc1242rc.github.io/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=https://rc1242rc.github.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://rc1242rc.github.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://rc1242rc.github.io/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://rc1242rc.github.io/site.webmanifest></head><body class="documentation single light"><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-md navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-md-nowrap" aria-label="Main navigation"><a class="navbar-brand p-0 me-auto" href=https://rc1242rc.github.io/ aria-label=GAMBIT><img class=logo-light src=https://rc1242rc.github.io//images/gambit_logo.png width=50px>
<img class="logo-dark d-none" src=https://rc1242rc.github.io//images/gambit_logo.png width=50px>
GAMBIT</a>
<button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=/>GAMBIT</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Documentation
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=/documentation/installation/introduction/>Installation</a></li><li><a class=dropdown-item href=/documentation/examples/colliderbit>Examples</a></li><li><a class=dropdown-item href=/documentation/help/faqs/>Help</a></li><li><a class=dropdown-item href=/documentation/code/gambit_sphinx/index_classes>Code Reference</a></li></ul></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Community
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=/community/publications/>Publications</a></li><li><a class=dropdown-item href=/community/talks/>Talks</a></li><li><a class=dropdown-item href=/community/members/>Members</a></li><li><a class="dropdown-item active" href=/community/code_of_conduct/ aria-current=true>Code of Conduct</a></li><li><a class=dropdown-item href=/community/contact/>Contact</a></li></ul></li></ul><hr class="text-black-50 my-4 d-lg-none"><form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2"><input id=search class="form-control is-search" type=search placeholder="Search site..." aria-label="Search site..." autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=https://github.com/GambitBSM><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-lg-none">GitHub</small></a></li></ul><hr class="text-black-50 my-4 d-lg-none"><div class=dropdown><button class="btn btn-doks-light dropdown-toggle" id=doks-versions data-bs-toggle=dropdown aria-expanded=false data-bs-display=static aria-label="Toggle version menu">
<span class=d-none>Doks</span>
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></button><ul class="dropdown-menu dropdown-menu-lg-end me-lg-2 shadow rounded border-0" aria-labelledby=doks-versions></ul></div></div></div></nav></header></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-installation aria-expanded=false>
Installation</button><div class=collapse id=section-installation><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/installation/introduction/>Getting Started</a></li><li><a class="docs-link rounded" href=/documentation/installation/docker_usage/>Docker Usage</a></li><li><a class="docs-link rounded" href=/documentation/installation/installation_for_linux/>Installation for Linux</a></li><li><a class="docs-link rounded" href=/documentation/installation/installation_for_windows/>Installation for Windows</a></li><li><a class="docs-link rounded" href=/documentation/installation/installation_for_macos/>Installation for macOS</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-examples aria-expanded=false>
Examples</button><div class=collapse id=section-examples><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section- aria-expanded=false>
<font style="color: #5d2f86;" size=-5></font> &nbsp; ColliderBit</button><div class=collapse id=section-><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/code/colliderbit/index_classes/>Classes</a></li><li><a class="docs-link rounded" href=/documentation/code/colliderbit/index_files/>Files</a></li><li><a class="docs-link rounded" href=/documentation/code/colliderbit/index_pages/>Pages</a></li><li><a class="docs-link rounded" href=/documentation/code/colliderbit/index_namespaces/>Namespaces</a></li></ul></div></li><li><a class="docs-link rounded" href=/documentation/examples/anotherbit/>AnotherBit</a></li><li><a class="docs-link rounded" href=/documentation/examples/anotherbit2/>AnotherBit2</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-help aria-expanded=false>
Help</button><div class=collapse id=section-help><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/help/faqs/>FAQs</a></li><li><a class="docs-link rounded" href=/documentation/help/compiler_matrix/>Compiler Matrix</a></li><li><a class="docs-link rounded" href=/documentation/help/known_issues/>Known Issues</a></li><li><a class="docs-link rounded" href=/documentation/help/configuration_examples/>Configuration Examples</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-code aria-expanded=true>
Code Reference</button><div class="collapse show" id=section-code><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-gambit_sphinx aria-expanded=true>
<font style="color: #5d2f86;" size=-5>release</font> &nbsp; gambit_sphinx</button><div class="collapse show" id=section-gambit_sphinx><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/code/gambit_sphinx/index_classes/>Classes</a></li><li><a class="docs-link rounded" href=/documentation/code/gambit_sphinx/index_files/>Files</a></li><li><a class="docs-link rounded" href=/documentation/code/gambit_sphinx/index_pages/>Pages</a></li><li><a class="docs-link rounded" href=/documentation/code/gambit_sphinx/index_namespaces/>Namespaces</a></li></ul></div></li><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-DarkBit aria-expanded=true>
<font style="color: #5d2f86;" size=-5>development</font> &nbsp; DarkBit</button><div class="collapse show" id=section-DarkBit><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/code/darkbit/index_classes/>Classes</a></li><li><a class="docs-link rounded" href=/documentation/code/darkbit/index_files/>Files</a></li><li><a class="docs-link rounded" href=/documentation/code/darkbit/index_pages/>Pages</a></li><li><a class="docs-link rounded" href=/documentation/code/darkbit/index_namespaces/>Namespaces</a></li></ul></div></li><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-main aria-expanded=true>
<font style="color: #5d2f86;" size=-5>development</font> &nbsp; main</button><div class="collapse show" id=section-main><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/code/main/index_classes/>Classes</a></li><li><a class="docs-link rounded" href=/documentation/code/main/index_files/>Files</a></li><li><a class="docs-link rounded" href=/documentation/code/main/index_pages/>Pages</a></li><li><a class="docs-link rounded" href=/documentation/code/main/index_namespaces/>Namespaces</a></li></ul></div></li></ul></div></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span>On this page</span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><ul><li><a href=#namespaces>Namespaces</a></li><li><a href=#detailed-description>Detailed Description</a></li><li><a href=#source-code>Source code</a></li></ul></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3>On this page</h3><nav id=TableOfContents><ul><li><ul><li><a href=#namespaces>Namespaces</a></li><li><a href=#detailed-description>Detailed Description</a></li><li><a href=#source-code>Source code</a></li></ul></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9 mx-xl-auto"><h1>file src/SunNeutrinos.cpp</h1><p class=lead></p><p>[No description available] <a href=#detailed-description>More&mldr;</a></p><h2 id=namespaces>Namespaces <a href=#namespaces class=anchor aria-hidden=true>#</a></h2><table><thead><tr><th>Name</th></tr></thead><tbody><tr><td><strong><a href=/documentation/code/darkbit/namespaces/namespacegambit/>Gambit</a></strong><br>TODO: see if we can use this one:</td></tr><tr><td><strong><a href=/documentation/code/darkbit/namespaces/namespacegambit_1_1darkbit/>Gambit::DarkBit</a></strong></td></tr></tbody></table><h2 id=detailed-description>Detailed Description <a href=#detailed-description class=anchor aria-hidden=true>#</a></h2><p><strong>Author</strong>:</p><ul><li>Pat Scott (<a href=mailto:pscott@imperial.ac.uk>pscott@imperial.ac.uk</a>)</li><li>Sebastian Wild (<a href=mailto:sebastian.wild@ph.tum.de>sebastian.wild@ph.tum.de</a>)</li><li>Ankit Beniwal (<a href=mailto:ankit.beniwal@adelaide.edu.au>ankit.beniwal@adelaide.edu.au</a>)</li></ul><p><strong>Date</strong>:</p><ul><li>2015 Apr 2018 Sep</li><li>2016 Aug</li><li>2018 Jan, Aug</li></ul><p>Solar neutrino likelihoods.</p><hr><p>Authors (add name and date if you modify):</p><hr><h2 id=source-code>Source code <a href=#source-code class=anchor aria-hidden=true>#</a></h2><pre><code>//   GAMBIT: Global and Modular BSM Inference Tool
//   *********************************************
///  \file
///
///  Solar neutrino likelihoods.
///
///  *********************************************
///
///  Authors (add name and date if you modify):
///
///  \author Pat Scott
///          (pscott@imperial.ac.uk)
///  \date 2015 Apr
///        2018 Sep
///
///  \author Sebastian Wild
///          (sebastian.wild@ph.tum.de)
///  \date 2016 Aug
///
///  \author Ankit Beniwal
///          (ankit.beniwal@adelaide.edu.au)
///  \date 2018 Jan, Aug
///
///  *********************************************

#include &quot;gambit/Elements/gambit_module_headers.hpp&quot;
#include &quot;gambit/DarkBit/DarkBit_rollcall.hpp&quot;
#include &quot;gambit/DarkBit/DarkBit_utils.hpp&quot;

//#define DARKBIT_DEBUG

namespace Gambit
{

  namespace DarkBit
  {

    //////////////////////////////////////////////////////////////////////////
    //
    //            Neutrino telescope likelihoods and observables
    //
    //////////////////////////////////////////////////////////////////////////

    /*! \brief Capture rate of regular dark matter in the Sun (no v-dependent
     *         or q-dependent cross-sections) (s^-1). DarkSUSY 5 version.
     */
    void capture_rate_Sun_const_xsec_DS5(double &amp;result)
    {
      using namespace Pipes::capture_rate_Sun_const_xsec_DS5;

      if (BEreq::cap_Sun_v0q0_isoscalar.origin()==&quot;DarkSUSY&quot;)
        if(!(*Dep::DarkSUSY5_PointInit_LocalHalo))
          DarkBit_error().raise(LOCAL_INFO,&quot;DarkSUSY halo model not initialized!&quot;);

      // When calculating the solar capture rate, DarkSUSY assumes that the
      // proton and neutron scattering cross-sections are the same; we
      // assume that whichever backend has been hooked up here does so too.

      result = BEreq::cap_Sun_v0q0_isoscalar(*Dep::mwimp, *Dep::sigma_SI_p, *Dep::sigma_SD_p);

    }

    /*! \brief Capture rate of regular dark matter in the Sun (no v-dependent
     *         or q-dependent cross-sections) (s^-1). DarkSUSY 6 version.
     */
    void capture_rate_Sun_const_xsec(double &amp;result)
    {
      using namespace Pipes::capture_rate_Sun_const_xsec;

      if (BEreq::cap_Sun_v0q0_isoscalar.origin()==&quot;DarkSUSY&quot;)
        if(!(*Dep::DarkSUSY_PointInit_LocalHalo))
          DarkBit_error().raise(LOCAL_INFO,&quot;DarkSUSY halo model not initialized!&quot;);

      LocalMaxwellianHalo LocalHaloParameters = *Dep::LocalHalo;
      double rho0 = LocalHaloParameters.rho0;
      double rho0_eff = (*Dep::RD_fraction)*rho0;

      // When calculating the solar capture rate, DarkSUSY assumes that the
      // proton and neutron scattering cross-sections are the same; we
      // assume that whichever backend has been hooked up here does so too.

      result = BEreq::cap_Sun_v0q0_isoscalar(*Dep::mwimp, rho0_eff, *Dep::sigma_SI_p, *Dep::sigma_SD_p);

    }

    ///Alternative to the darkSusy fct, using captn_specific from capgen instead
    void capture_rate_Sun_const_xsec_capgen(double &amp;result)
    {
      using namespace Pipes::capture_rate_Sun_const_xsec_capgen;
      double resultSD;
      double resultSI;
      double maxcap;

      maxcap = BEreq::cap_sun_saturation(*Dep::mwimp);
      BEreq::cap_Sun_v0q0_isoscalar(*Dep::mwimp,*Dep::sigma_SD_p,*Dep::sigma_SI_p,resultSD,resultSI);
      result = resultSI + resultSD;

      if (maxcap &lt; result)
      {
        result = maxcap;
      }

    }

    ///Capture rate for v^n and q^n-dependent cross sections.
    ///Isoscalar (same proton/neutron coupling)
    ///SD only couples to Hydrogen.
    ///See DirectDetection.cpp to see how to define the cross sections sigma_SD_p, sigma_SI_pi
    void capture_rate_Sun_vnqn(double &amp;result)
    {
      using namespace Pipes::capture_rate_Sun_vnqn;

      double resultSD;
      double resultSI;
      double capped;
      int qpow;
      int vpow;
      const int nelems = 29;
      double maxcap;

      maxcap = BEreq::cap_sun_saturation(*Dep::mwimp);

      resultSI = 0e0;
      resultSD = 0e0;
      typedef map_intpair_dbl::const_iterator it_type;

      //Spin-dependent:
      for(it_type iterator = Dep::sigma_SD_p-&gt;begin();
        iterator != Dep::sigma_SD_p-&gt;end();
        iterator++)
      {
         //don't capture anything if cross section is zero or all the DM is already capped
        if((iterator-&gt;second &gt; 1e-90) &amp;&amp; (resultSD &lt; maxcap))
        {
          qpow = (iterator-&gt;first).first/2 ;
          vpow =  (iterator-&gt;first).second/2;

          //Capture
          BEreq::cap_Sun_vnqn_isoscalar(*Dep::mwimp,iterator-&gt;second,1,qpow,vpow,*Dep::spinwimpx2/2.,capped);
          resultSD = resultSD+capped;
        }
      }

      //Spin independent:
      for(it_type iterator = Dep::sigma_SI_p-&gt;begin();
        iterator != Dep::sigma_SI_p-&gt;end();
        iterator++)
      {
        if((iterator-&gt;second &gt; 1e-90) &amp;&amp; (resultSI+resultSD &lt; maxcap))
        {
          qpow = (iterator-&gt;first).first/2 ;
          vpow =  (iterator-&gt;first).second/2;

          //Capture
          BEreq::cap_Sun_vnqn_isoscalar(*Dep::mwimp,iterator-&gt;second,nelems,qpow,vpow,*Dep::spinwimpx2/2.,capped);
          resultSI = resultSI+capped;
        }
      }
      result = resultSI+resultSD;

      logger() &lt;&lt; &quot;Capgen captured: SI: &quot; &lt;&lt; resultSI &lt;&lt; &quot; SD: &quot; &lt;&lt; resultSD &lt;&lt; &quot; total: &quot; &lt;&lt; result &lt;&lt; &quot;max = &quot; &lt;&lt; maxcap &lt;&lt; &quot;\n&quot; &lt;&lt; EOM;

      // If capture is above saturation, return saturation value.
      if (maxcap &lt; result)
      {
        result = maxcap;
      }

    }

    //Capture rate for Non-Relataivistic Effective Operator (NREO)
    void capture_rate_Sun_NREO(double &amp;result)
    {
      #ifdef DARKBIT_DEBUG
        cout &lt;&lt; &quot;Starting capture_rate_Sun_NREO ...&quot; &lt;&lt; endl;
      #endif
      using namespace Pipes::capture_rate_Sun_NREO;

      double capped;
      double maxcap;
      const int niso = 16;

      maxcap = BEreq::cap_sun_saturation(Dep::WIMP_properties-&gt;mass);

      /*
      use pipe to access parameters of model (0c1...1c15) here (3.2.3 of gambit paper)

      for loop through C++ array of [0c1,0c2,...] (initialized by INI in captn_gen.cpp)
      call populate Array with the value found in the C++ array and the position in the C++ array
      */

      int coupleNum;
      int maxCouplingIndex = -1;
      if (Dep::DD_nonrel_WCs-&gt;CPTbasis == 0) // if we are using the NREffectiveTheory basis
      {
        maxCouplingIndex = 15;
      }
      else if (Dep::DD_nonrel_WCs-&gt;CPTbasis == 1) // if we are using the NREFT_CPT basis
      {
        maxCouplingIndex = 12;
      }
      else
      {
        DarkBit_error().raise(LOCAL_INFO, &quot;Got unexpected value for Dep::DD_nonrel_WCs-&gt;CPTbasis. Should be 0 or 1.&quot;);
      }
      for(int j=0; j&lt;maxCouplingIndex; j++)
      {
        coupleNum = j + 1; // this is the coupling number, ranges 1 to 15 (but not 2)
        if (coupleNum != 2) // 2 is not an allowed coupling constant
        {
          BEreq::captn_populate_array(Dep::DD_nonrel_WCs-&gt;c0.at(coupleNum), coupleNum, 0);
          BEreq::captn_populate_array(Dep::DD_nonrel_WCs-&gt;c1.at(coupleNum), coupleNum, 1);
        }
      }


      /*
      Code to sum over all elements in solar model simultaneously.
      The third parameter tells captn_NREO how many isotopes to sum over,
      of which captn is currently set up to sum the 16 from arxiv:1501.03729.
      */
      BEreq::captn_NREO(Dep::WIMP_properties-&gt;mass,Dep::WIMP_properties-&gt;spinx2/2.,niso,capped);

      result = capped;

      logger() &lt;&lt; &quot;Capgen captured: total: &quot; &lt;&lt; result &lt;&lt; &quot;max = &quot; &lt;&lt; maxcap &lt;&lt; &quot;\n&quot; &lt;&lt; EOM;

      // If capture is above saturation, return saturation value.
      if (maxcap &lt; result)
      {
        result = maxcap;
      }
    }

    /*! \brief Equilibration time for capture and annihilation of dark matter
     * in the Sun (s)
     */
    void equilibration_time_Sun(double &amp;result)
    {
      using namespace Pipes::equilibration_time_Sun;

      double sigmav = 0;
      double T_Sun_core = 1.35e-6; // Sun's core temperature (GeV)

      std::string DMid = *Dep::DarkMatter_ID;
      std::string DMbarid = *Dep::DarkMatterConj_ID;

      // Make sure that we're not trying to work with decaying DM.
      const TH_Process* p = Dep::TH_ProcessCatalog-&gt;find(DMid, DMbarid);
      if (p == NULL) DarkBit_error().raise(LOCAL_INFO, &quot;Sorry, decaying DM is not supported yet by the DarkBit neutrino routines.&quot;);
      TH_Process annProc = Dep::TH_ProcessCatalog-&gt;getProcess(DMid, DMbarid);

      // Add all the regular channels
      for (std::vector&lt;TH_Channel&gt;::iterator it = annProc.channelList.begin();
          it != annProc.channelList.end(); ++it)
      {
        if ( it-&gt;nFinalStates == 2 )
        {
          // (sv)(v = sqrt(2T/mDM)) for two-body final state
          sigmav += it-&gt;genRate-&gt;bind(&quot;v&quot;)-&gt;eval(sqrt(2.0*T_Sun_core/(*Dep::mwimp)));
        }
      }

      // Add invisible contributions
      sigmav += annProc.genRateMisc-&gt;bind(&quot;v&quot;)-&gt;eval(sqrt(2.0*T_Sun_core/(*Dep::mwimp)));

      double ca = sigmav/6.6e28 * pow(*Dep::mwimp/20.0, 1.5);
      // Scale the annihilation rate down by a factor of two if the DM is not self-conjugate
      if (not (*Dep::TH_ProcessCatalog).getProcess(*Dep::DarkMatter_ID, *Dep::DarkMatterConj_ID).isSelfConj) ca *= 0.5;
      result = pow(*Dep::capture_rate_Sun * ca, -0.5);

      // std::cout &lt;&lt; &quot;v = &quot; &lt;&lt; sqrt(2.0*T_Sun_core/(*Dep::mwimp)) &lt;&lt; &quot; and sigmav inside equilibration_time_Sun = &quot; &lt;&lt; sigmav &lt;&lt; std::endl;
      // std::cout &lt;&lt; &quot;capture_rate_Sun inside equilibration_time_Sun = &quot; &lt;&lt; *Dep::capture_rate_Sun &lt;&lt; std::endl;
    }

    /// Annihilation rate of dark matter in the Sun (s^-1)
    void annihilation_rate_Sun(double &amp;result)
    {
      using namespace Pipes::annihilation_rate_Sun;
      double tt_sun = 1.5e17 / *Dep::equilibration_time_Sun;
      result = *Dep::capture_rate_Sun * 0.5 * pow(tanh(tt_sun),2.0);
    }

    /// Neutrino yield function pointer and setup
    void nuyield_from_DS(nuyield_info &amp;result)
    {

      using namespace Pipes::nuyield_from_DS;
      double annihilation_bf[29];
      double Higgs_decay_BFs_neutral[29][3];
      double Higgs_decay_BFs_charged[15];
      double Higgs_masses_neutral[3];
      double Higgs_mass_charged;

      // Set annihilation branching fractions
      std::string DMid = *Dep::DarkMatter_ID;
      std::string DMbarid = *Dep::DarkMatterConj_ID;
      TH_Process annProc = Dep::TH_ProcessCatalog-&gt;getProcess(DMid, DMbarid);
      std::vector&lt; std::vector&lt;str&gt; &gt; neutral_channels = BEreq::get_DS_neutral_h_decay_channels();
      // the missing channel
      const std::vector&lt;str&gt; adhoc_chan = initVector&lt;str&gt;(&quot;W-&quot;, &quot;H+&quot;);

      for (int i=0; i&lt;29; i++)
      {
        const TH_Channel* channel = annProc.find(neutral_channels[i]);

        if (channel == NULL or i == 26) // Channel 26 has not been implemented in DarkSUSY.
        {
          annihilation_bf[i] = 0.;
        }
        else
        {
          annihilation_bf[i] = channel-&gt;genRate-&gt;bind(&quot;v&quot;)-&gt;eval(0.);
          if (i == 10) // Add W- H+ for this channel
          {
            channel = annProc.find(adhoc_chan);
            if (channel == NULL) DarkBit_error().raise(LOCAL_INFO,
                &quot;W+H- exists in process catalog but not W-H+.&quot;
                &quot; That's some suspiciously severe CP violation yo.&quot;);
            annihilation_bf[i] += channel-&gt;genRate-&gt;bind(&quot;v&quot;)-&gt;eval(0.);
          }
          annihilation_bf[i] /= *Dep::sigmav;

          // Check that having this channel turned on makes sense at all.
          #ifdef DARKBIT_DEBUG
            double mtot = 0;
            cout &lt;&lt; &quot;Particles and masses in DM annihilation final state: &quot; &lt;&lt; endl;
            for (auto p = neutral_channels[i].begin(); p != neutral_channels[i].end(); ++p)
            {
              double m = Dep::TH_ProcessCatalog-&gt;getParticleProperty(*p).mass;
              cout &lt;&lt; &quot;  &quot; &lt;&lt; *p &lt;&lt; &quot; &quot; &lt;&lt; m &lt;&lt; endl;
              mtot += m;
            }
            cout &lt;&lt; &quot;Sqrt(s) vs total mass of final states: &quot; &lt;&lt; 2 * *Dep::mwimp &lt;&lt; &quot; vs. &quot; &lt;&lt; mtot &lt;&lt; endl;
            cout &lt;&lt; &quot;Branching fraction in v=0 limit: &quot; &lt;&lt; annihilation_bf[i] &lt;&lt; endl &lt;&lt; endl;
            if (mtot &gt; 2 * *Dep::mwimp and annihilation_bf[i] &gt; 0.0)
             DarkBit_error().raise(LOCAL_INFO, &quot;Channel is open in process catalog but should not be kinematically allowed.&quot;);
          #endif
        }

      }

      // Set Higgs masses
      if (Dep::TH_ProcessCatalog-&gt;hasParticleProperty(&quot;h0_1&quot;))
        Higgs_masses_neutral[1] = Dep::TH_ProcessCatalog-&gt;getParticleProperty(&quot;h0_1&quot;).mass;
      else
        DarkBit_error().raise(LOCAL_INFO, &quot;No SM-like Higgs in ProcessCatalog!&quot;);
      Higgs_masses_neutral[0] =
        Dep::TH_ProcessCatalog-&gt;hasParticleProperty(&quot;h0_2&quot;) ?
        Dep::TH_ProcessCatalog-&gt;getParticleProperty(&quot;h0_2&quot;).mass : 0.;
      Higgs_masses_neutral[2] =
        Dep::TH_ProcessCatalog-&gt;hasParticleProperty(&quot;A0&quot;) ?
        Dep::TH_ProcessCatalog-&gt;getParticleProperty(&quot;A0&quot;).mass : 0.;
      Higgs_mass_charged =
        Dep::TH_ProcessCatalog-&gt;hasParticleProperty(&quot;H+&quot;) ?
        Dep::TH_ProcessCatalog-&gt;getParticleProperty(&quot;H+&quot;).mass : 0.;

      // Find out which Higgs exist and have decay data in the process
      // catalog.
      const TH_Process* h0_decays[3];
      h0_decays[0] = Dep::TH_ProcessCatalog-&gt;find(&quot;h0_2&quot;);
      h0_decays[1] = Dep::TH_ProcessCatalog-&gt;find(&quot;h0_1&quot;);
      h0_decays[2] = Dep::TH_ProcessCatalog-&gt;find(&quot;A0&quot;);
      const TH_Process* Hplus_decays = Dep::TH_ProcessCatalog-&gt;find(&quot;H+&quot;);
      const TH_Process* Hminus_decays = Dep::TH_ProcessCatalog-&gt;find(&quot;H-&quot;);
      if (Hplus_decays != NULL and Hminus_decays == NULL) DarkBit_error().raise(
          LOCAL_INFO, &quot;H+ decays exist in process catalog but not H-.&quot;);
      if (Hplus_decays == NULL and Hminus_decays != NULL) DarkBit_error().raise(
          LOCAL_INFO, &quot;H- decays exist in process catalog but not H+.&quot;);

      // Set the neutral Higgs decay branching fractions
      for (int i=0; i&lt;3; i++)       // Loop over the three neutral Higgs
      {

        // If this Higgs exists, set its decay properties.
        if (h0_decays[i] != NULL)
        {

          // Get the total decay width, for normalising partial widths to BFs.
          // TODO: Replace when BFs become directly available.
          double totalwidth = 0.0;
          for (std::vector&lt;TH_Channel&gt;::const_iterator
              it = h0_decays[i]-&gt;channelList.begin();
              it != h0_decays[i]-&gt;channelList.end(); ++it)
          {
            // decay width in GeV for two-body final state
            if ( it-&gt;nFinalStates == 2 ) totalwidth +=
              it-&gt;genRate-&gt;bind()-&gt;eval();
          }

          std::vector&lt;str&gt; neutral_channel;
          // Loop over the decay channels for neutral scalars
          for (int j=0; j&lt;29; j++)
          {
            neutral_channel.clear();
            neutral_channel.push_back(DarkBit_utils::str_flav_to_mass((neutral_channels[j])[0]));
            neutral_channel.push_back(DarkBit_utils::str_flav_to_mass((neutral_channels[j])[1]));
            const TH_Channel* channel = h0_decays[i]-&gt;find(neutral_channel);
            // If this Higgs can decay into this channel, set the BF.
            if (channel != NULL)
            {
              Higgs_decay_BFs_neutral[j][i] = channel-&gt;genRate-&gt;bind()-&gt;eval();
              if (j == 10)          // Add W- H+ for this channel
              {
                channel = h0_decays[i]-&gt;find(adhoc_chan);
                if (channel == NULL) DarkBit_error().raise(LOCAL_INFO,
                    &quot;W+H- exists in process catalog but not W-H+.&quot;
                    &quot; That's some suspiciously severe CP violation yo.&quot;);
                Higgs_decay_BFs_neutral[j][i]
                  += channel-&gt;genRate-&gt;bind()-&gt;eval();
              }
              // This channel has not been implemented in DarkSUSY.
              if (j == 26) Higgs_decay_BFs_neutral[j][i] = 0.;
              Higgs_decay_BFs_neutral[j][i] /= totalwidth;
            }
            else
            {
              Higgs_decay_BFs_neutral[j][i] = 0.;
            }
          }

        }

        else
        {
          // Loop over the decay channels for neutral scalars, setting all BFs
          // for this Higgs to zero.
          for (int j=0; j&lt;29; j++) Higgs_decay_BFs_neutral[j][i] = 0.;
        }

      }

      // If they exist, set the charged Higgs decay branching fractions
      // (DarkSUSY assumes that H+/H- decays are CP-invariant)
      if (Hplus_decays != NULL)
      {

        // Define the charged Higgs decay channels
        std::vector&lt; std::vector&lt;str&gt; &gt; charged_channels = BEreq::get_DS_charged_h_decay_channels();

        // Get the total decay width, for normalising partial widths to BFs.
        // TODO: Replace when BFs become directly available.
        double totalwidth = 0.0;
        for (std::vector&lt;TH_Channel&gt;::const_iterator
            it = Hplus_decays-&gt;channelList.begin();
            it != Hplus_decays-&gt;channelList.end(); ++it)
        {
          // decay width in GeV for two-body final state
          if (it-&gt;nFinalStates == 2) totalwidth += it-&gt;genRate-&gt;bind()-&gt;eval();
        }

        std::vector&lt;str&gt; charged_channel;
        // Loop over the decay channels for charged scalars
        for (int j=0; j&lt;15; j++)
        {
          charged_channel.clear();
          charged_channel.push_back(DarkBit_utils::str_flav_to_mass((charged_channels[j])[0]));
          charged_channel.push_back(DarkBit_utils::str_flav_to_mass((charged_channels[j])[1]));
          const TH_Channel* channel = Hplus_decays-&gt;find(charged_channel);
          // If this Higgs can decay into this channel, set the BF.
          if (channel != NULL)
          {
            Higgs_decay_BFs_charged[j] = channel-&gt;genRate-&gt;bind()-&gt;eval();
            Higgs_decay_BFs_charged[j] /= totalwidth;
          }
          else
          {
            Higgs_decay_BFs_charged[j] = 0.;
          }
        }

      }

      else
      {
        // Loop over the decay channels for charged scalars, setting all BFs
        // for this Higgs to zero.
        for (int j=0; j&lt;15; j++) Higgs_decay_BFs_charged[j] = 0.;
      }

      // Debug output
      #ifdef DARKBIT_DEBUG
        for (int j=0; j&lt;29; j++)
        {
          cout&lt;&lt; &quot;annihilation bfs: &quot; &lt;&lt; j &lt;&lt; &quot; &quot; &lt;&lt; annihilation_bf[j] &lt;&lt; endl;
        }
        cout&lt;&lt; endl;
        for (int i=0; i&lt;3; i++)
        {
          for (int j=0; j&lt;29; j++)
          {
            cout&lt;&lt; &quot;higgs neutral bfs: &quot; &lt;&lt; i &lt;&lt; &quot; &quot; &lt;&lt; j &lt;&lt; &quot; &quot;
              &lt;&lt; Higgs_decay_BFs_neutral[j][i] &lt;&lt; endl;
          }
        }
        cout&lt;&lt; endl;
        for (int j=0; j&lt;15; j++)
        {
          cout&lt;&lt; &quot;higgs charged bfs: &quot; &lt;&lt; j &lt;&lt; &quot; &quot;
            &lt;&lt; Higgs_decay_BFs_charged[j] &lt;&lt; endl;
        }
        cout&lt;&lt; endl;
        for (int j=0; j&lt;3; j++)
        {
          cout&lt;&lt; &quot;higgs masses neutral: &quot; &lt;&lt; j &lt;&lt; &quot; &quot;
            &lt;&lt; Higgs_masses_neutral[j] &lt;&lt; endl;
        }
        cout&lt;&lt; endl;
        cout&lt;&lt; &quot;higgs charged mass: &quot; &lt;&lt; Higgs_mass_charged &lt;&lt; endl;
        cout&lt;&lt; endl;
        cout&lt;&lt; &quot;*Dep::mwimp: &quot; &lt;&lt; *Dep::mwimp &lt;&lt; endl;
        cout&lt;&lt; endl;
        cout&lt;&lt; &quot;*Dep::sigmav: &quot; &lt;&lt; *Dep::sigmav &lt;&lt; endl;
        cout&lt;&lt; endl;
      #endif

      // Set up DarkSUSY to do neutrino yields for this particular WIMP
      BEreq::DS_nuyield_setup(annihilation_bf, Higgs_decay_BFs_neutral,
          Higgs_decay_BFs_charged, Higgs_masses_neutral,
          Higgs_mass_charged, *Dep::mwimp);

      // Hand back the pointer to the DarkSUSY neutrino yield function
      result.pointer = BEreq::nuyield.pointer();

      //TODO: change below to &gt;= when version numbers are available as ints
      // Treat the yield function as threadsafe only if the loaded version of DarkSUSY supports it.
      result.threadsafe = (BEreq::nuyield.version() == &quot;5.1.3&quot;);

      // Avoid OpenMP with gfortran 6.x and later, as the implementation seems to be buggy (causes stack overflows).
      #ifdef __GNUC__
        #define GCC_VERSION (__GNUC__ * 10000 \
                     + __GNUC_MINOR__ * 100 \
                     + __GNUC_PATCHLEVEL__)
        #if GCC_VERSION &gt; 60000
          result.threadsafe = false;
        #endif
        #undef GCC_VERSION
      #endif

    }

    /// \brief Likelihood calculators for different IceCube event samples
    /// These functions all include the likelihood of the background-only model for the respective sample.
    /// We define the final log-likelihood as delta = sum over analyses of (lnL_model - lnL_BG), conservatively
    /// forbidding delta &gt; 0 in order to always just use the neutrino likelihood as a limit.  This ignores small
    /// low-E excesses caused by impending breakdown of approximations used in IceCube response data and the nulike
    /// likelihood at very low E. This implies conditioning on all but one parameter (e.g. the cross-section),
    /// such that including any particular IC analysis adds just *one* additional degree of freedom to the fit.
    /// @{

    /// \brief 22-string IceCube sample: predicted signal and background
    /// counts, observed counts and likelihoods.
    void IC22_full(nudata &amp;result)
    {
      using namespace Pipes::IC22_full;
      static bool first = true;
      const double bgloglike = -808.4581;
      double sigpred, bgpred, lnLike, pval;
      int totobs;
      char experiment[300] = &quot;IC-22&quot;;
      void* context = NULL;
      double theoryError = (*Dep::mwimp &gt; 100.0 ? 0.05*sqrt(*Dep::mwimp*0.01) : 0.05);
      /// Option nulike_speed&lt;int&gt;: Speed setting for nulike backend (default 3)
      int speed = runOptions-&gt;getValueOrDef&lt;int&gt;(3,&quot;nulike_speed&quot;);
      BEreq::nubounds(experiment[0], *Dep::mwimp, *Dep::annihilation_rate_Sun,
          byVal(Dep::nuyield_ptr-&gt;pointer), sigpred, bgpred, totobs, lnLike, pval, 4,
          theoryError, speed, false, 0.0, 0.0, context, Dep::nuyield_ptr-&gt;threadsafe);
      piped_invalid_point.check();
      piped_errors.check(DarkBit_error());
      piped_warnings.check(DarkBit_warning());
      result.signal = sigpred;
      result.bg = bgpred;
      result.nobs = totobs;
      result.loglike = lnLike;
      result.pvalue = pval;
      if (first)
      {
        result.bgloglike = bgloglike;
        first = false;
      }
    }

    /// \brief 79-string IceCube WH sample: predicted signal and background
    /// counts, observed counts and likelihoods.
    void IC79WH_full(nudata &amp;result)
    {
      static bool first = true;
      using namespace Pipes::IC79WH_full;
      const double bgloglike = -11874.8689;
      double sigpred, bgpred, lnLike, pval;
      int totobs;
      char experiment[300] = &quot;IC-79 WH&quot;;
      void* context = NULL;
      double theoryError = (*Dep::mwimp &gt; 100.0 ? 0.05*sqrt(*Dep::mwimp*0.01) : 0.05);
      /// Option nulike_speed&lt;int&gt;: Speed setting for nulike backend (default 3)
      int speed = runOptions-&gt;getValueOrDef&lt;int&gt;(3,&quot;nulike_speed&quot;);
      BEreq::nubounds(experiment[0], *Dep::mwimp, *Dep::annihilation_rate_Sun,
          byVal(Dep::nuyield_ptr-&gt;pointer), sigpred, bgpred, totobs, lnLike, pval, 4,
          theoryError, speed, false, 0.0, 0.0, context, Dep::nuyield_ptr-&gt;threadsafe);
      piped_invalid_point.check();
      piped_errors.check(DarkBit_error());
      piped_warnings.check(DarkBit_warning());
      result.signal = sigpred;
      result.bg = bgpred;
      result.nobs = totobs;
      result.loglike = lnLike;
      result.pvalue = pval;
      if (first)
      {
        result.bgloglike = bgloglike;
        first = false;
      }
    }

    /// \brief 79-string IceCube WL sample: predicted signal and background
    /// counts, observed counts and likelihoods.
    void IC79WL_full(nudata &amp;result)
    {
      static bool first = true;
      using namespace Pipes::IC79WL_full;
      const double bgloglike = -1813.4503;
      double sigpred, bgpred, lnLike, pval;
      int totobs;
      char experiment[300] = &quot;IC-79 WL&quot;;
      void* context = NULL;
      double theoryError = (*Dep::mwimp &gt; 100.0 ? 0.05*sqrt(*Dep::mwimp*0.01) : 0.05);
      /// Option nulike_speed&lt;int&gt;: Speed setting for nulike backend (default 3)
      int speed = runOptions-&gt;getValueOrDef&lt;int&gt;(3,&quot;nulike_speed&quot;);
      BEreq::nubounds(experiment[0], *Dep::mwimp, *Dep::annihilation_rate_Sun,
          byVal(Dep::nuyield_ptr-&gt;pointer), sigpred, bgpred, totobs, lnLike, pval, 4,
          theoryError, speed, false, 0.0, 0.0, context, Dep::nuyield_ptr-&gt;threadsafe);
      piped_invalid_point.check();
      piped_errors.check(DarkBit_error());
      piped_warnings.check(DarkBit_warning());
      result.signal = sigpred;
      result.bg = bgpred;
      result.nobs = totobs;
      result.loglike = lnLike;
      result.pvalue = pval;
      if (first)
      {
        result.bgloglike = bgloglike;
        first = false;
      }
    }

    /// \brief 79-string IceCube SL sample: predicted signal and background
    /// counts, observed counts and likelihoods.
    void IC79SL_full(nudata &amp;result)
    {
      static bool first = true;
      using namespace Pipes::IC79SL_full;
      const double bgloglike = -5015.6474;
      double sigpred, bgpred, lnLike, pval;
      int totobs;
      char experiment[300] = &quot;IC-79 SL&quot;;
      void* context = NULL;
      double theoryError = (*Dep::mwimp &gt; 100.0 ? 0.05*sqrt(*Dep::mwimp*0.01) : 0.05);
      /// Option nulike_speed&lt;int&gt;: Speed setting for nulike backend (default 3)
      int speed = runOptions-&gt;getValueOrDef&lt;int&gt;(3,&quot;nulike_speed&quot;);
      BEreq::nubounds(experiment[0], *Dep::mwimp, *Dep::annihilation_rate_Sun,
          byVal(Dep::nuyield_ptr-&gt;pointer), sigpred, bgpred, totobs, lnLike, pval, 4,
          theoryError, speed, false, 0.0, 0.0, context, Dep::nuyield_ptr-&gt;threadsafe);
      piped_invalid_point.check();
      piped_errors.check(DarkBit_error());
      piped_warnings.check(DarkBit_warning());
      result.signal = sigpred;
      result.bg = bgpred;
      result.nobs = totobs;
      result.loglike = lnLike;
      result.pvalue = pval;
      if (first)
      {
        result.bgloglike = bgloglike;
        first = false;
      }
    }
    /// @}

    /// 22-string extractor module functions
    /// @{
    void IC22_signal (double &amp;result)   {
      result = Pipes::IC22_signal ::Dep::IC22_data-&gt;signal;      }
    void IC22_bg     (double &amp;result)   {
      result = Pipes::IC22_bg     ::Dep::IC22_data-&gt;bg;          }
    void IC22_nobs   (int    &amp;result)   {
      result = Pipes::IC22_nobs   ::Dep::IC22_data-&gt;nobs;        }
    void IC22_loglike(double &amp;result)   {
      result = Pipes::IC22_loglike::Dep::IC22_data-&gt;loglike;     }
    void IC22_bgloglike(double &amp;result) {
      result = Pipes::IC22_bgloglike::Dep::IC22_data-&gt;bgloglike; }
    void IC22_pvalue (double &amp;result)   {
      result = Pipes::IC22_pvalue ::Dep::IC22_data-&gt;pvalue;      }
    /// @}

    /// 79-string WH extractor module functions
    /// @{
    void IC79WH_signal (double &amp;result)   {
      result = Pipes::IC79WH_signal ::Dep::IC79WH_data-&gt;signal;      }
    void IC79WH_bg     (double &amp;result)   {
      result = Pipes::IC79WH_bg     ::Dep::IC79WH_data-&gt;bg;          }
    void IC79WH_nobs   (int    &amp;result)   {
      result = Pipes::IC79WH_nobs   ::Dep::IC79WH_data-&gt;nobs;        }
    void IC79WH_loglike(double &amp;result)   {
      result = Pipes::IC79WH_loglike::Dep::IC79WH_data-&gt;loglike;     }
    void IC79WH_bgloglike(double &amp;result) {
      result = Pipes::IC79WH_bgloglike::Dep::IC79WH_data-&gt;bgloglike; }
    void IC79WH_pvalue (double &amp;result)   {
      result = Pipes::IC79WH_pvalue ::Dep::IC79WH_data-&gt;pvalue;      }
    /// @}

    /// 79-string WL extractor module functions
    /// @{
    void IC79WL_signal (double &amp;result)   {
      result = Pipes::IC79WL_signal ::Dep::IC79WL_data-&gt;signal;      }
    void IC79WL_bg     (double &amp;result)   {
      result = Pipes::IC79WL_bg     ::Dep::IC79WL_data-&gt;bg;          }
    void IC79WL_nobs   (int    &amp;result)   {
      result = Pipes::IC79WL_nobs   ::Dep::IC79WL_data-&gt;nobs;        }
    void IC79WL_loglike(double &amp;result)   {
      result = Pipes::IC79WL_loglike::Dep::IC79WL_data-&gt;loglike;     }
    void IC79WL_bgloglike(double &amp;result) {
      result = Pipes::IC79WL_bgloglike::Dep::IC79WL_data-&gt;bgloglike; }
    void IC79WL_pvalue (double &amp;result)   {
      result = Pipes::IC79WL_pvalue ::Dep::IC79WL_data-&gt;pvalue;      }
    /// @}

    /// 79-string SL extractor module functions
    /// @{
    void IC79SL_signal (double &amp;result)   {
      result = Pipes::IC79SL_signal ::Dep::IC79SL_data-&gt;signal;      }
    void IC79SL_bg     (double &amp;result)   {
      result = Pipes::IC79SL_bg     ::Dep::IC79SL_data-&gt;bg;          }
    void IC79SL_nobs   (int    &amp;result)   {
      result = Pipes::IC79SL_nobs   ::Dep::IC79SL_data-&gt;nobs;        }
    void IC79SL_loglike(double &amp;result)   {
      result = Pipes::IC79SL_loglike::Dep::IC79SL_data-&gt;loglike;     }
    void IC79SL_bgloglike(double &amp;result) {
      result = Pipes::IC79SL_bgloglike::Dep::IC79SL_data-&gt;bgloglike; }
    void IC79SL_pvalue (double &amp;result)   {
      result = Pipes::IC79SL_pvalue ::Dep::IC79SL_data-&gt;pvalue;      }
    /// @}

    /// Composite IceCube 79-string likelihood function.
    void IC79_loglike(double &amp;result)
    {
      using namespace Pipes::IC79_loglike;
      result = *Dep::IC79SL_loglike - *Dep::IC79SL_bgloglike +
               *Dep::IC79WL_loglike - *Dep::IC79WL_bgloglike +
               *Dep::IC79WH_loglike - *Dep::IC79WH_bgloglike;
      if (result &gt; 0.0) result = 0.0;
    }

    /// Complete composite IceCube likelihood function.
    void IC_loglike(double &amp;result)
    {
      using namespace Pipes::IC_loglike;
      result = *Dep::IC22_loglike   - *Dep::IC22_bgloglike   +
               *Dep::IC79SL_loglike - *Dep::IC79SL_bgloglike +
               *Dep::IC79WL_loglike - *Dep::IC79WL_bgloglike +
               *Dep::IC79WH_loglike - *Dep::IC79WH_bgloglike;
      if (result &gt; 0.0) result = 0.0;
#ifdef DARKBIT_DEBUG
      cout &lt;&lt; &quot;IC likelihood: &quot; &lt;&lt; result &lt;&lt; endl;
      cout &lt;&lt; &quot;IC79SL contribution: &quot; &lt;&lt; *Dep::IC79SL_loglike - *Dep::IC79SL_bgloglike &lt;&lt; endl;
      cout &lt;&lt; &quot;IC79WL contribution: &quot; &lt;&lt; *Dep::IC79WL_loglike - *Dep::IC79WL_bgloglike &lt;&lt; endl;
      cout &lt;&lt; &quot;IC79WH contribution: &quot; &lt;&lt; *Dep::IC79WH_loglike - *Dep::IC79WH_bgloglike &lt;&lt; endl;
      cout &lt;&lt; &quot;IC22   contribution: &quot; &lt;&lt; *Dep::IC22_loglike   - *Dep::IC22_bgloglike   &lt;&lt; endl;
#endif
    }

    /// Function to set Local Halo Parameters in DarkSUSY (DS5 only)
    void DarkSUSY5_PointInit_LocalHalo_func(bool &amp;result)
    {
      using namespace Pipes::DarkSUSY5_PointInit_LocalHalo_func;

      LocalMaxwellianHalo LocalHaloParameters = *Dep::LocalHalo;

      double rho0 = LocalHaloParameters.rho0;
      double rho0_eff = (*Dep::RD_fraction)*rho0;
      double vrot = LocalHaloParameters.vrot;
      double vd_3d = sqrt(3./2.)*LocalHaloParameters.v0;
      double vesc = LocalHaloParameters.vesc;
      /// Option v_earth&lt;double&gt;: Keplerian velocity of the Earth around the Sun in km/s (default 29.78)
      double v_earth = runOptions-&gt;getValueOrDef&lt;double&gt;(29.78, &quot;v_earth&quot;);

      BEreq::dshmcom-&gt;rho0 = rho0;
      BEreq::dshmcom-&gt;v_sun = vrot;
      BEreq::dshmcom-&gt;v_earth = v_earth;
      BEreq::dshmcom-&gt;rhox = rho0_eff;

      BEreq::dshmframevelcom-&gt;v_obs = vrot;

      BEreq::dshmisodf-&gt;vd_3d = vd_3d;
      BEreq::dshmisodf-&gt;vgalesc = vesc;

      BEreq::dshmnoclue-&gt;vobs = vrot;

      logger() &lt;&lt; LogTags::debug
               &lt;&lt; &quot;Updating DarkSUSY halo parameters:&quot; &lt;&lt; std::endl
               &lt;&lt; &quot;    rho0 [GeV/cm^3] = &quot; &lt;&lt; rho0 &lt;&lt; std::endl
               &lt;&lt; &quot;    rho0_eff [GeV/cm^3] = &quot; &lt;&lt; rho0_eff &lt;&lt; std::endl
               &lt;&lt; &quot;    v_sun [km/s]  = &quot; &lt;&lt; vrot&lt;&lt; std::endl
               &lt;&lt; &quot;    v_earth [km/s]  = &quot; &lt;&lt; v_earth &lt;&lt; std::endl
               &lt;&lt; &quot;    v_obs [km/s]  = &quot; &lt;&lt; vrot &lt;&lt; std::endl
               &lt;&lt; &quot;    vd_3d [km/s]  = &quot; &lt;&lt; vd_3d &lt;&lt; std::endl
               &lt;&lt; &quot;    v_esc [km/s]  = &quot; &lt;&lt; vesc &lt;&lt; EOM;

      result = true;

      return;
    }

    /// Function to set Local Halo Parameters in DarkSUSY (DS 6)
    void DarkSUSY_PointInit_LocalHalo_func(bool &amp;result)
    {
      using namespace Pipes::DarkSUSY_PointInit_LocalHalo_func;

      LocalMaxwellianHalo LocalHaloParameters = *Dep::LocalHalo;

      double rho0 = LocalHaloParameters.rho0;
      double vrot = LocalHaloParameters.vrot;
      double vd_3d = sqrt(3./2.)*LocalHaloParameters.v0;
      double vesc = LocalHaloParameters.vesc;
      /// Option v_earth&lt;double&gt;: Keplerian velocity of the Earth around the Sun in km/s (default 29.78)
      double v_earth = runOptions-&gt;getValueOrDef&lt;double&gt;(29.78, &quot;v_earth&quot;);

      BEreq::dshmcom-&gt;rho0 = rho0;
      BEreq::dshmcom-&gt;v_sun = vrot;
      BEreq::dshmcom-&gt;v_earth = v_earth;

      BEreq::dshmframevelcom-&gt;v_obs = vrot;

      BEreq::dshmisodf-&gt;vd_3d = vd_3d;
      BEreq::dshmisodf-&gt;vgalesc = vesc;

      BEreq::dshmnoclue-&gt;vobs = vrot;

      logger() &lt;&lt; LogTags::debug
               &lt;&lt; &quot;Updating DarkSUSY halo parameters:&quot; &lt;&lt; std::endl
               &lt;&lt; &quot;    rho0 [GeV/cm^3] = &quot; &lt;&lt; rho0 &lt;&lt; std::endl
               &lt;&lt; &quot;    v_sun [km/s]  = &quot; &lt;&lt; vrot&lt;&lt; std::endl
               &lt;&lt; &quot;    v_earth [km/s]  = &quot; &lt;&lt; v_earth &lt;&lt; std::endl
               &lt;&lt; &quot;    v_obs [km/s]  = &quot; &lt;&lt; vrot &lt;&lt; std::endl
               &lt;&lt; &quot;    vd_3d [km/s]  = &quot; &lt;&lt; vd_3d &lt;&lt; std::endl
               &lt;&lt; &quot;    v_esc [km/s]  = &quot; &lt;&lt; vesc &lt;&lt; EOM;

      result = true;

      return;
    }

  }
}
</code></pre><hr><p>Updated on 2022-08-03 at 05:45:15 +0000</p><div class=edit-page><a href=https://github.com/RC1242RC/gambit_gh_pages/blob/master/content/en/documentation/code/DarkBit/Files/SunNeutrinos_8cpp.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on GitHub</a></div></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a class=text-muted href=https://www.netlify.com/>Netlify</a>, <a class=text-muted href=https://gohugo.io/>Hugo</a>, and <a class=text-muted href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline><li class=list-inline-item><a href=/license/>License</a></li></ul></div></div></div></footer><script src=/js/bootstrap.min.54bf0932b8a36d0e152b1635b099a6ef1394d35327e2437550a075c9c8ed1bd8aed5847c21b36fc02ed24014c031d9ca24017b0c78b1639d7e2fa8329898b842.js integrity="sha512-VL8JMrijbQ4VKxY1sJmm7xOU01Mn4kN1UKB1ycjtG9iu1YR8IbNvwC7SQBTAMdnKJAF7DHixY51+L6gymJi4Qg==" crossorigin=anonymous defer></script>
<script src=/js/highlight.min.5b48bc253dc75aeea5fb366ecf700f4925e2b6eb1a1466f2124b722d68148d67bc0a9365d2b8ad9c585161b46372d23b08509a16f1fd518542b894756d4752d0.js integrity="sha512-W0i8JT3HWu6l+zZuz3APSSXitusaFGbyEktyLWgUjWe8CpNl0ritnFhRYbRjctI7CFCaFvH9UYVCuJR1bUdS0A==" crossorigin=anonymous defer></script>
<script src=/main.min.40265e9a032aeba5eaf67baac3cbbc22667a7533215d326eeb3e9f4d5e4be40f9ff4dcd22949db73ae527ca26a19d7998091a8973c82af760b2c0daa335190ed.js integrity="sha512-QCZemgMq66Xq9nuqw8u8ImZ6dTMhXTJu6z6fTV5L5A+f9NzSKUnbc65SfKJqGdeZgJGolzyCr3YLLA2qM1GQ7Q==" crossorigin=anonymous defer></script>
<script src=https://rc1242rc.github.io/index.min.d6c23b6a8553e5886cec8b03acff4cda8d5f910e77d69b6f437dbf1e1d6929d5f13e530607d74172c0511b7abf03de0ffaec4b4acf33f4ae5a5544019a6c7694.js integrity="sha512-1sI7aoVT5Yhs7IsDrP9M2o1fkQ531ptvQ32/Hh1pKdXxPlMGB9dBcsBRG3q/A94P+uxLSs8z9K5aVUQBmmx2lA==" crossorigin=anonymous defer></script></body></html>