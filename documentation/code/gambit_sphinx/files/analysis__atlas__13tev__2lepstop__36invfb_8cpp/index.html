<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://rc1242rc.github.io/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://rc1242rc.github.io/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://rc1242rc.github.io/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var e=localStorage.getItem("theme");e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=https://rc1242rc.github.io/main.f12f7e04ea768acebec10c86baf049d74d6a79f24bc0dfb7ed77aa60462432916dd1ce8f41c78b69496adf650b3039a28a210183cce598f09b95d6fecb5ff999.css integrity="sha512-8S9+BOp2is6+wQyGuvBJ101qefJLwN+37XeqYEYkMpFt0c6PQceLaUlq32ULMDmiiiEBg8zlmPCbldb+y1/5mQ==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>file analyses/Analysis_ATLAS_13TeV_2LEPStop_36invfb.cpp - GAMBIT</title><meta name=description content="[No description available]"><link rel=canonical href=https://rc1242rc.github.io/documentation/code/gambit_sphinx/files/analysis__atlas__13tev__2lepstop__36invfb_8cpp/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="file analyses/Analysis_ATLAS_13TeV_2LEPStop_36invfb.cpp"><meta property="og:description" content="[No description available]"><meta property="og:url" content="https://rc1242rc.github.io/documentation/code/gambit_sphinx/files/analysis__atlas__13tev__2lepstop__36invfb_8cpp/"><meta property="og:site_name" content="GAMBIT"><meta property="og:image" content="https://rc1242rc.github.io/gambit_logo.png"><meta property="og:image:alt" content="GAMBIT"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content><meta name=twitter:creator content><meta name=twitter:title content="file analyses/Analysis_ATLAS_13TeV_2LEPStop_36invfb.cpp"><meta name=twitter:description content="[No description available]"><meta name=twitter:image content="https://rc1242rc.github.io/gambit_logo.png"><meta name=twitter:image:alt content="file analyses/Analysis_ATLAS_13TeV_2LEPStop_36invfb.cpp"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://rc1242rc.github.io/#/schema/organization/1","name":"Doks","url":"https://rc1242rc.github.io/","sameAs":["https://github.com/GambitBSM"],"logo":{"@type":"ImageObject","@id":"https://rc1242rc.github.io/#/schema/image/1","url":"https://rc1242rc.github.io/logo-doks.png","width":450,"height":416,"caption":"Doks"},"image":{"@id":"https://rc1242rc.github.io/#/schema/image/1"}},{"@type":"WebSite","@id":"https://rc1242rc.github.io/#/schema/website/1","url":"https://rc1242rc.github.io/","name":"GAMBIT","description":"Documentation for the Global And Modular BSM Inference Tool","publisher":{"@id":"https://rc1242rc.github.io/#/schema/organization/1"}},{"@type":"WebPage","@id":"https://rc1242rc.github.io/documentation/code/gambit_sphinx/files/analysis__atlas__13tev__2lepstop__36invfb_8cpp/","url":"https://rc1242rc.github.io/documentation/code/gambit_sphinx/files/analysis__atlas__13tev__2lepstop__36invfb_8cpp/","name":"file analyses\/Analysis_ATLAS_13TeV_2LEPStop_36invfb.cpp","description":"[No description available]","isPartOf":{"@id":"https://rc1242rc.github.io/#/schema/website/1"},"about":{"@id":"https://rc1242rc.github.io/#/schema/organization/1"},"datePublished":"0001-01-01T00:00:00CET","dateModified":"0001-01-01T00:00:00CET","breadcrumb":{"@id":"https://rc1242rc.github.io/documentation/code/gambit_sphinx/files/analysis__atlas__13tev__2lepstop__36invfb_8cpp/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://rc1242rc.github.io/documentation/code/gambit_sphinx/files/analysis__atlas__13tev__2lepstop__36invfb_8cpp/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://rc1242rc.github.io/documentation/code/gambit_sphinx/files/analysis__atlas__13tev__2lepstop__36invfb_8cpp/"]}]},{"@type":"BreadcrumbList","@id":"https://rc1242rc.github.io/documentation/code/gambit_sphinx/files/analysis__atlas__13tev__2lepstop__36invfb_8cpp/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://rc1242rc.github.io/","url":"https://rc1242rc.github.io/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://rc1242rc.github.io/documentation/","url":"https://rc1242rc.github.io/documentation/","name":"Documentation"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://rc1242rc.github.io/documentation/code/","url":"https://rc1242rc.github.io/documentation/code/","name":"Code"}},{"@type":"ListItem","position":4,"item":{"@type":"WebPage","@id":"https://rc1242rc.github.io/documentation/code/gambit_sphinx/","url":"https://rc1242rc.github.io/documentation/code/gambit_sphinx/","name":"Gambit Sphinx"}},{"@type":"ListItem","position":5,"item":{"@type":"WebPage","@id":"https://rc1242rc.github.io/documentation/code/gambit_sphinx/files/","url":"https://rc1242rc.github.io/documentation/code/gambit_sphinx/files/","name":"Files"}},{"@type":"ListItem","position":6,"item":{"@id":"https://rc1242rc.github.io/documentation/code/gambit_sphinx/files/analysis__atlas__13tev__2lepstop__36invfb_8cpp/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://rc1242rc.github.io/documentation/code/gambit_sphinx/files/analysis__atlas__13tev__2lepstop__36invfb_8cpp/#/schema/image/2","url":"https://rc1242rc.github.io/gambit_logo.png","contentUrl":"https://rc1242rc.github.io/gambit_logo.png","caption":"file analyses\/Analysis_ATLAS_13TeV_2LEPStop_36invfb.cpp"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=https://rc1242rc.github.io/favicon.ico sizes=any><link rel=icon type=image/svg+xml href=https://rc1242rc.github.io/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=https://rc1242rc.github.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://rc1242rc.github.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://rc1242rc.github.io/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://rc1242rc.github.io/site.webmanifest></head><body class="documentation single light"><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-md navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-md-nowrap" aria-label="Main navigation"><a class="navbar-brand p-0 me-auto" href=https://rc1242rc.github.io/ aria-label=GAMBIT><img class=logo-light src=https://rc1242rc.github.io//images/gambit_logo.png width=50px>
<img class="logo-dark d-none" src=https://rc1242rc.github.io//images/gambit_logo.png width=50px>
GAMBIT</a>
<button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=/>GAMBIT</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Documentation
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=/documentation/installation/introduction/>Installation</a></li><li><a class=dropdown-item href=/documentation/examples/colliderbit>Examples</a></li><li><a class=dropdown-item href=/documentation/help/faqs/>Help</a></li><li><a class=dropdown-item href=/documentation/code/index_classes>Code Reference</a></li></ul></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Community
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=/community/publications/>Publications</a></li><li><a class=dropdown-item href=/community/talks/>Talks</a></li><li><a class=dropdown-item href=/community/members/>Members</a></li><li><a class=dropdown-item href=/community/code_of_conduct/>Code of Conduct</a></li><li><a class=dropdown-item href=/community/contact/>Contact</a></li></ul></li></ul><hr class="text-black-50 my-4 d-lg-none"><form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2"><input id=search class="form-control is-search" type=search placeholder="Search site..." aria-label="Search site..." autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=https://github.com/GambitBSM><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-lg-none">GitHub</small></a></li></ul><hr class="text-black-50 my-4 d-lg-none"><div class=dropdown><button class="btn btn-doks-light dropdown-toggle" id=doks-versions data-bs-toggle=dropdown aria-expanded=false data-bs-display=static aria-label="Toggle version menu">
<span class=d-none>Doks</span>
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></button><ul class="dropdown-menu dropdown-menu-lg-end me-lg-2 shadow rounded border-0" aria-labelledby=doks-versions></ul></div></div></div></nav></header></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-installation aria-expanded=false>
Installation</button><div class=collapse id=section-installation><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/installation/introduction/>Getting Started</a></li><li><a class="docs-link rounded" href=/documentation/installation/docker_usage/>Docker Usage</a></li><li><a class="docs-link rounded" href=/documentation/installation/installation_for_linux/>Installation for Linux</a></li><li><a class="docs-link rounded" href=/documentation/installation/installation_for_windows/>Installation for Windows</a></li><li><a class="docs-link rounded" href=/documentation/installation/installation_for_macos/>Installation for macOS</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-examples aria-expanded=false>
Examples</button><div class=collapse id=section-examples><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/examples/colliderbit/>ColliderBit</a></li><li><a class="docs-link rounded" href=/documentation/examples/anotherbit/>AnotherBit</a></li><li><a class="docs-link rounded" href=/documentation/examples/anotherbit2/>AnotherBit2</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-help aria-expanded=false>
Help</button><div class=collapse id=section-help><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/help/faqs/>FAQs</a></li><li><a class="docs-link rounded" href=/documentation/help/compiler_matrix/>Compiler Matrix</a></li><li><a class="docs-link rounded" href=/documentation/help/known_issues/>Known Issues</a></li><li><a class="docs-link rounded" href=/documentation/help/configuration_examples/>Configuration Examples</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-code aria-expanded=false>
Code Reference</button></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section- aria-expanded=false>
GAMBIT_VERSION_HERE</button><div class=collapse id=section-><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/code/colliderbit_development/index_classes/>Classes</a></li><li><a class="docs-link rounded" href=/documentation/code/colliderbit_development/index_files/>Files</a></li><li><a class="docs-link rounded" href=/documentation/code/colliderbit_development/index_pages/>Pages</a></li><li><a class="docs-link rounded" href=/documentation/code/colliderbit_development/index_namespaces/>Namespaces</a></li></ul></div></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span>On this page</span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><ul><li><a href=#namespaces>Namespaces</a></li><li><a href=#classes>Classes</a></li><li><a href=#source-code>Source code</a></li></ul></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3>On this page</h3><nav id=TableOfContents><ul><li><ul><li><a href=#namespaces>Namespaces</a></li><li><a href=#classes>Classes</a></li><li><a href=#source-code>Source code</a></li></ul></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9 mx-xl-auto"><h1>file analyses/Analysis_ATLAS_13TeV_2LEPStop_36invfb.cpp</h1><p class=lead></p><p>[No description available]</p><h2 id=namespaces>Namespaces <a href=#namespaces class=anchor aria-hidden=true>#</a></h2><table><thead><tr><th>Name</th></tr></thead><tbody><tr><td><strong><a href=/documentation/code/gambit_sphinx/namespaces/namespacegambit/>Gambit</a></strong><br>TODO: see if we can use this one:</td></tr><tr><td><strong><a href=/documentation/code/gambit_sphinx/namespaces/namespacegambit_1_1colliderbit/>Gambit::ColliderBit</a></strong></td></tr></tbody></table><h2 id=classes>Classes <a href=#classes class=anchor aria-hidden=true>#</a></h2><table><thead><tr><th></th><th>Name</th></tr></thead><tbody><tr><td>class</td><td><strong><a href=/documentation/code/gambit_sphinx/classes/classgambit_1_1colliderbit_1_1analysis__atlas__13tev__2lepstop__36invfb/>Gambit::ColliderBit::Analysis_ATLAS_13TeV_2LEPStop_36invfb</a></strong></td></tr></tbody></table><h2 id=source-code>Source code <a href=#source-code class=anchor aria-hidden=true>#</a></h2><pre><code>#include &lt;vector&gt;
#include &lt;cmath&gt;
#include &lt;memory&gt;
#include &lt;iomanip&gt;

#include &quot;gambit/ColliderBit/analyses/Analysis.hpp&quot;
#include &quot;gambit/ColliderBit/ATLASEfficiencies.hpp&quot;
#include &quot;gambit/ColliderBit/mt2_bisect.h&quot;

using namespace std;

/* The ATLAS 2 lepton direct stop analysis (36.1fb^-1) - `heavy stop'.

   Based on: arXiv:1708.03247
   Author: Yang Zhang

   Known errors:
        1. Jet overlap removal with muon is not done becasue miss trac imformation
        2. Applied specific efficiencies on muon for validation

*/

namespace Gambit {
  namespace ColliderBit {


    bool sortByPT_j(const HEPUtils::Jet* jet1, const HEPUtils::Jet* jet2) { return (jet1-&gt;pT() &gt; jet2-&gt;pT()); }
    bool sortByPT_l(const HEPUtils::Particle* lep1, const HEPUtils::Particle* lep2) { return (lep1-&gt;pT() &gt; lep2-&gt;pT()); }

    class Analysis_ATLAS_13TeV_2LEPStop_36invfb : public Analysis {
    private:

        // Numbers passing cuts
        std::map&lt;string, EventCounter&gt; _counters = {
            {&quot;SRASF120&quot;, EventCounter(&quot;SRASF120&quot;)},
            {&quot;SRADF120&quot;, EventCounter(&quot;SRADF120&quot;)},
            {&quot;SRASF140&quot;, EventCounter(&quot;SRASF140&quot;)},
            {&quot;SRADF140&quot;, EventCounter(&quot;SRADF140&quot;)},
            {&quot;SRASF160&quot;, EventCounter(&quot;SRASF160&quot;)},
            {&quot;SRADF160&quot;, EventCounter(&quot;SRADF160&quot;)},
            {&quot;SRASF180&quot;, EventCounter(&quot;SRASF180&quot;)},
            {&quot;SRADF180&quot;, EventCounter(&quot;SRADF180&quot;)},
            {&quot;SRBSF120&quot;, EventCounter(&quot;SRBSF120&quot;)},
            {&quot;SRBDF120&quot;, EventCounter(&quot;SRBDF120&quot;)},
            {&quot;SRBSF140&quot;, EventCounter(&quot;SRBSF140&quot;)},
            {&quot;SRBDF140&quot;, EventCounter(&quot;SRBDF140&quot;)},
            {&quot;SRCSF110&quot;, EventCounter(&quot;SRCSF110&quot;)},
            {&quot;SRCDF110&quot;, EventCounter(&quot;SRCDF110&quot;)},
            {&quot;SR4b&quot;, EventCounter(&quot;SR4b&quot;)},
        };

        // Cut Flow
        vector&lt;int&gt; cutFlowVector;
        vector&lt;string&gt; cutFlowVector_str;
        int NCUTS;

        // // debug
        // ofstream Savelep1;
        // ofstream Savelep2;

        // Jet overlap removal
        void JetLeptonOverlapRemoval(vector&lt;const HEPUtils::Jet*&gt; &amp;jetvec, vector&lt;const HEPUtils::Particle*&gt; &amp;lepvec, double DeltaRMax) {
            //Routine to do jet-lepton check
            //Discards jets if they are within DeltaRMax of a lepton

            vector&lt;const HEPUtils::Jet*&gt; Survivors;

            for(unsigned int itjet = 0; itjet &lt; jetvec.size(); itjet++) {
                bool overlap = false;
                HEPUtils::P4 jetmom=jetvec.at(itjet)-&gt;mom();
                for(unsigned int itlep = 0; itlep &lt; lepvec.size(); itlep++) {
                    HEPUtils::P4 lepmom=lepvec.at(itlep)-&gt;mom();
                    double dR;

                    dR=jetmom.deltaR_eta(lepmom);

                    if(fabs(dR) &lt;= DeltaRMax) overlap=true;
                }
                if(overlap) continue;
                Survivors.push_back(jetvec.at(itjet));
            }
            jetvec=Survivors;

            return;
        }

        // Lepton overlap removal
        void LeptonJetOverlapRemoval(vector&lt;const HEPUtils::Particle*&gt; &amp;lepvec, vector&lt;const HEPUtils::Jet*&gt; &amp;jetvec, double DeltaRMax) {
            //Routine to do lepton-jet check
            //Discards leptons if they are within DeltaRMax of a jet

            vector&lt;const HEPUtils::Particle*&gt; Survivors;

            for(unsigned int itlep = 0; itlep &lt; lepvec.size(); itlep++) {
                bool overlap = false;
                HEPUtils::P4 lepmom=lepvec.at(itlep)-&gt;mom();
                for(unsigned int itjet= 0; itjet &lt; jetvec.size(); itjet++) {
                    HEPUtils::P4 jetmom=jetvec.at(itjet)-&gt;mom();
                    double dR;

                    dR=jetmom.deltaR_eta(lepmom);

                    if(fabs(dR) &lt;= DeltaRMax) overlap=true;
                }
                if(overlap) continue;
                Survivors.push_back(lepvec.at(itlep));
            }
            lepvec=Survivors;

            return;
        }


    public:

        // Required detector sim
        static constexpr const char* detector = &quot;ATLAS&quot;;

        Analysis_ATLAS_13TeV_2LEPStop_36invfb() {

            set_analysis_name(&quot;ATLAS_13TeV_2LEPStop_36invfb&quot;);
            set_luminosity(36.1);

            NCUTS= 66;

            // //debug
            // Savelep1.open(&quot;lep1.txt&quot;);
            // Savelep2.open(&quot;lep2.txt&quot;);

            for(int i=0;i&lt;NCUTS;i++){
                cutFlowVector.push_back(0);
                cutFlowVector_str.push_back(&quot;&quot;);
            }

        }

        void run(const HEPUtils::Event* event) {

            // Missing energy
            double met = event-&gt;met();
            HEPUtils::P4 ptot = event-&gt;missingmom();

            // Baseline lepton objects
            vector&lt;const HEPUtils::Particle*&gt; blElectrons, blMuons;              // Used for SR-2body and SR-3body
            vector&lt;const HEPUtils::Particle*&gt; baselineElectrons, baselineMuons;  // Used for SR-4body
            for (const HEPUtils::Particle* electron : event-&gt;electrons()) {
            // Same with the code snippet, not the experimental report
                if (electron-&gt;pT() &gt; 10. &amp;&amp; electron-&gt;abseta() &lt; 2.47) blElectrons.push_back(electron);
                if (electron-&gt;pT() &gt; 7. &amp;&amp; electron-&gt;abseta() &lt; 2.47) baselineElectrons.push_back(electron);
            }

            // Apply electron efficiency
            ATLAS::applyElectronEff(blElectrons);
            ATLAS::applyElectronEff(baselineElectrons);

            // Apply loose electron selection
            ATLAS::applyLooseIDElectronSelectionR2(blElectrons);
            ATLAS::applyLooseIDElectronSelectionR2(baselineElectrons);

            const std::vector&lt;double&gt;  a = {0,10.};
            const std::vector&lt;double&gt;  b = {0,10000.};
            const vector&lt;double&gt; cMu={0.89};
            HEPUtils::BinnedFn2D&lt;double&gt; _eff2dMu(a,b,cMu);
            for (const HEPUtils::Particle* muon : event-&gt;muons()) {
                bool hasTrig=has_tag(_eff2dMu, muon-&gt;abseta(), muon-&gt;pT());
            // Same with the code snippet, not the experimental report
                if (muon-&gt;pT() &gt; 10. &amp;&amp; muon-&gt;abseta() &lt; 2.5 &amp;&amp; hasTrig) blMuons.push_back(muon);
                if (muon-&gt;pT() &gt; 7. &amp;&amp; muon-&gt;abseta() &lt; 2.5 &amp;&amp; hasTrig) baselineMuons.push_back(muon);
            }

            // Apply muon efficiency
            ATLAS::applyMuonEff(blMuons);
            ATLAS::applyMuonEff(baselineMuons);

            // Jets
            vector&lt;const HEPUtils::Jet*&gt; blJets;          // Used for SR-2body and SR-3body
            vector&lt;const HEPUtils::Jet*&gt; baselineJets;    // Used for SR-4body
            for (const HEPUtils::Jet* jet : event-&gt;jets()) {
                if (jet-&gt;pT() &gt; 20. &amp;&amp; fabs(jet-&gt;eta()) &lt; 2.8) blJets.push_back(jet);
                if (jet-&gt;pT() &gt; 20. &amp;&amp; fabs(jet-&gt;eta()) &lt; 2.8) baselineJets.push_back(jet);
            }

            // Overlap removal
            JetLeptonOverlapRemoval(blJets,blElectrons,0.2);
            LeptonJetOverlapRemoval(blElectrons,blJets,0.4);
            LeptonJetOverlapRemoval(blMuons,blJets,0.4);
            JetLeptonOverlapRemoval(baselineJets,baselineElectrons,0.2);
            LeptonJetOverlapRemoval(baselineElectrons,baselineJets,0.4);
            LeptonJetOverlapRemoval(baselineMuons,baselineJets,0.4);

            //Signal Jet
            vector&lt;const HEPUtils::Jet*&gt; sgJets;                  // Used for SR-2body and SR-3body
            vector&lt;const HEPUtils::Jet*&gt; signalJets;              // Used for SR-4body
            for (const HEPUtils::Jet* jet : blJets) {
                if (jet-&gt;pT() &gt; 20. &amp;&amp; fabs(jet-&gt;eta()) &lt; 2.5) {
                    sgJets.push_back(jet);
                }
            }
            for (const HEPUtils::Jet* jet : baselineJets) {
                if (jet-&gt;pT() &gt; 25. &amp;&amp; fabs(jet-&gt;eta()) &lt; 2.5) {
                    signalJets.push_back(jet);
                }
            }


            //Signal Leptons
            vector&lt;const HEPUtils::Particle*&gt; sgElectrons, sgLeptons;          // Used for SR-2body and SR-3body
            vector&lt;const HEPUtils::Particle*&gt; signalLeptons;  // Used for SR-4body
            for (const HEPUtils::Particle* electron : blElectrons) {
                if (electron-&gt;pT() &gt; 10. &amp;&amp; fabs(electron-&gt;eta()) &lt; 2.47){
                    sgElectrons.push_back(electron);
                }
            }
            ATLAS::applyMediumIDElectronSelectionR2(sgElectrons);
            for (const HEPUtils::Particle* electron : sgElectrons) {
                sgLeptons.push_back(electron);
            }
            for (const HEPUtils::Particle* muon : blMuons) {
                if (muon-&gt;pT() &gt; 10. &amp;&amp; fabs(muon-&gt;eta()) &lt; 2.4){
                    sgLeptons.push_back(muon);
                }
            }
            ATLAS::applyMediumIDElectronSelectionR2(baselineElectrons);
            for (const HEPUtils::Particle* electron : baselineElectrons) {
                signalLeptons.push_back(electron);
            }
            for (const HEPUtils::Particle* muon : baselineMuons) {
                signalLeptons.push_back(muon);
            }


            //Put signal jetsÔºèleptons in pT order
            std::sort(signalJets.begin(), signalJets.end(), sortByPT_j);
            std::sort(signalLeptons.begin(), signalLeptons.end(), sortByPT_l);
            std::sort(sgJets.begin(), sgJets.end(), sortByPT_j);
            std::sort(sgLeptons.begin(), sgLeptons.end(), sortByPT_l);

            // Function used to get b jets
            vector&lt;const HEPUtils::Jet*&gt; sgbJets;                  // Used for SR-2body and SR-3body
            vector&lt;const HEPUtils::Jet*&gt; sgJetsGt25;               // Used for SR-2body
            //const std::vector&lt;double&gt;  a = {0,10.};
            //const std::vector&lt;double&gt;  b = {0,10000.};
            const std::vector&lt;double&gt; c = {0.77};
            HEPUtils::BinnedFn2D&lt;double&gt; _eff2d(a,b,c);
            for (const HEPUtils::Jet* jet :sgJets) {
                if (jet-&gt;pT() &gt; 25.) {
                    sgJetsGt25.push_back(jet);
                    bool hasTag=has_tag(_eff2d, jet-&gt;abseta(), jet-&gt;pT());
                    if(jet-&gt;btag() &amp;&amp; hasTag &amp;&amp; jet-&gt;pT() &gt; 25.) sgbJets.push_back(jet);
                }
            }
            int nbjet = sgbJets.size();     // Used for SR-2body and SR-3body
            int njet25= sgJetsGt25.size();  // Used for SR-2body
            int njet = sgJets.size();  // Used for SR-2body

            // We now have the signal electrons, muons, jets and b jets- move on to the analysis
            /*********************************************************/
            /*                                                       */
            /* SIGNAL REGIONS SR-2body                               */
            /*                                                       */
            /*********************************************************/
            // Flags for SR-2body
            bool cABC_TriggerOS =false;
            bool cABC_SF        =false;
            // For SRA
            bool cA_mllGt111    =false;
            bool cA_nobjet      =false;
            bool CA_R2l2j       =false;
            bool cA_deltaX      =false;
            bool cA_MT2120      =false;
            bool cA_MT2140      =false;
            bool cA_MT2160      =false;
            bool cA_MT2180      =false;
            // For SRB
            bool cBC_mllExMz    =false;
            bool cBC_nbnj       =false;
            bool cB_DelBoost    =false;
            bool cB_MT2120      =false;
            bool cB_MT2140      =false;
            // For SRC
            bool cC_njGt2       =false;
            bool cC_R2lGt1o2    =false;
            bool cC_METGt200    =false;
            bool cC_MT2110      =false;

            //Lepton Num
            if(sgLeptons.size() == 2){

                // Opposite sign leptons, pT(l1,l2)&gt;25,20GeV, mll&gt;20GeV
                HEPUtils::P4 lepton0=sgLeptons.at(0)-&gt;mom();
                HEPUtils::P4 lepton1=sgLeptons.at(1)-&gt;mom();
                double Mll= (lepton0+lepton1).m();

                // Savelep1 &lt;&lt; sgLeptons[0]-&gt;pT() &lt;&lt; endl;
                // Savelep2 &lt;&lt; sgLeptons[1]-&gt;pT() &lt;&lt; endl;

                if (sgLeptons[0]-&gt;pid()*sgLeptons[1]-&gt;pid()&lt;0. &amp;&amp; sgLeptons[0]-&gt;pT() &gt; 25. &amp;&amp; sgLeptons[1]-&gt;pT() &gt; 20. &amp;&amp; Mll&gt;20.){
                    cABC_TriggerOS              = true;
                    if (sgLeptons[0]-&gt;pid()+sgLeptons[1]-&gt;pid()==0) cABC_SF = true;
                    /********* SRA-2body *********/
                    if (Mll&gt;111.2) cA_mllGt111  = true;
                    if (nbjet==0)  cA_nobjet    = true;

                    double ptJet1=0.; if ( njet &gt;= 1) ptJet1 = sgJets.at(0)-&gt;pT();
                    double ptJet2=0.; if ( njet &gt;= 2) ptJet2 = sgJets.at(1)-&gt;pT();
                    double R2l2j=met / (met + lepton0.pT() + lepton1.pT() + ptJet1 + ptJet2);
                    if (R2l2j&gt;0.3) CA_R2l2j     = true;

                    double DX = fabs((2 * (lepton0.pz() + lepton1.pz())) / 13000.);
                    if (DX&lt;0.07)   cA_deltaX    = true;

                    //Calculate MT2
                    double mt2ll=0;
                    double pa_a[3] = { 0, sgLeptons[0]-&gt;mom().px(), sgLeptons[0]-&gt;mom().py() };
                    double pb_a[3] = { 0, sgLeptons[1]-&gt;mom().px(), sgLeptons[1]-&gt;mom().py() };
                    double pmiss_a[3] = { 0, ptot.px(), ptot.py() };
                    double mn_a = 0.;

                    mt2_bisect::mt2 mt2_event_a;
                    mt2_event_a.set_momenta(pa_a,pb_a,pmiss_a);
                    mt2_event_a.set_mn(mn_a);
                    mt2ll = mt2_event_a.get_mt2();

                    if(mt2ll&gt;120 &amp;&amp; mt2ll&lt;140)  cA_MT2120   = true;
                    if(mt2ll&gt;140 &amp;&amp; mt2ll&lt;160)  cA_MT2140   = true;
                    if(mt2ll&gt;160 &amp;&amp; mt2ll&lt;180)  cA_MT2160   = true;
                    if(mt2ll&gt;180)               cA_MT2180   = true;

                    /********* SRB-2body *********/
                    if (Mll&gt;111.2 || Mll&lt;71.2)  cBC_mllExMz = true;
                    if (nbjet&gt;0 &amp;&amp; njet25&gt;1)    cBC_nbnj    = true;
                    //Calculate Delta phi_boost
                    HEPUtils::P4 pbll_TLV = lepton0 + lepton1 + ptot;
                    double dPhiEtmisspbll = fabs(pbll_TLV.deltaPhi(ptot));
                    if (dPhiEtmisspbll&lt;1.5)     cB_DelBoost = true;
                    if(mt2ll&gt;120 &amp;&amp; mt2ll&lt;140)  cB_MT2120   = true;
                    if(mt2ll&gt;140 )              cB_MT2140   = true;

                    /********* SRC-2body *********/
                    if (njet25&gt;2)               cC_njGt2    = true;
                    double R2L=met / (lepton0.pT() + lepton1.pT());
                    if (R2L&gt;1.2)                cC_R2lGt1o2 = true;
                    if (met&gt;200)                cC_METGt200 = true;
                    if (mt2ll&gt;110)              cC_MT2110   = true;
                }
            }

            /*********************************************************/
            /*                                                       */
            /* SIGNAL REGIONS SR-4body                               */
            /*                                                       */
            /*********************************************************/
            // Flags
            bool c4_METOSlepton =false;
            bool c4_mllGt10     =false;
            bool c4_SoftLepton  =false;
            bool c4_njetGt2     =false;
            bool c4_Jet1PtGt150 =false;
            bool c4_Jet3PtMET   =false;
            bool c4_R2l4j       =false;
            bool c4_R2l         =false;
            bool c4_2bjetveto   =false;

            //MET trigger and Lepton Num
            if(signalLeptons.size() == 2 &amp;&amp; met&gt;200 ){

                // Opposite sign leptons
                if (signalLeptons[0]-&gt;pid()*signalLeptons[1]-&gt;pid()&lt;0) c4_METOSlepton=true;

                // mll
                HEPUtils::P4 lep0=signalLeptons.at(0)-&gt;mom();
                HEPUtils::P4 lep1=signalLeptons.at(1)-&gt;mom();
                double mll= (lep0+lep1).m();
                if(mll&gt;10) c4_mllGt10=true;
                //Soft lepton
                if(lep0.pT()&lt;80 &amp;&amp; lep1.pT()&lt;35) c4_SoftLepton=true;

                //Number of jet
                int nJets = signalJets.size();
                if(nJets&gt;=2){

                    c4_njetGt2=true;
                    double ptJet1=signalJets.at(0)-&gt;pT();
                    double ptJet2=signalJets.at(1)-&gt;pT();
                    double ptJet3=0.;
                    if ( nJets &gt;= 3) ptJet3 = signalJets.at(2)-&gt;pT();
                    double ptJet4=0.;
                    if ( nJets &gt;= 4) ptJet4 = signalJets.at(3)-&gt;pT();

                    //PT(j1)&gt;150GeV
                    if (ptJet1&gt;150) c4_Jet1PtGt150 =true;
                    //PT(j3)/MET&lt;0.14
                    if (nJets&gt;=3 &amp;&amp; ptJet3/met &lt; 0.14) c4_Jet3PtMET=true;
                    if (nJets&lt;3) c4_Jet3PtMET=true;

                    //R_{2l4j}&gt;0.35
                    double R2l4j=met / (met + lep0.pT() + lep1.pT() + ptJet1 + ptJet2 + ptJet3 + ptJet4);
                    if (R2l4j&gt;0.35) c4_R2l4j=true;
                    //R_{2l}&gt;12
                    double R2l=met / (lep0.pT() + lep1.pT());
                    if (R2l&gt;12.) c4_R2l=true;

                    //veto b-jet on j1 and j2
                    // Function used to get b jets
                    /*const std::vector&lt;double&gt;  a = {0,10.};
                    const std::vector&lt;double&gt;  b = {0,10000.};
                    const std::vector&lt;double&gt; c = {0.7};
                    HEPUtils::BinnedFn2D&lt;double&gt; _eff2d(a,b,c);*/
                    bool j1Tag=has_tag(_eff2d, signalJets.at(0)-&gt;abseta(), signalJets.at(0)-&gt;pT());
                    bool j2Tag=has_tag(_eff2d, signalJets.at(1)-&gt;abseta(), signalJets.at(1)-&gt;pT());
                    if (!(signalJets.at(0)-&gt;btag()&amp;&amp;j1Tag&amp;&amp;signalJets.at(1)-&gt;btag()&amp;&amp;j2Tag)) c4_2bjetveto=true;
                }
            }

            /*********************************************************/
            /*                                                       */
            /* Cut Flow                                              */
            /*                                                       */
            /*********************************************************/
            cutFlowVector_str[0] = &quot;Total &quot;;
            /*---------------------------------------*/
            cutFlowVector_str[1] = &quot;SR2A--trigger &amp;&amp; 2 OS lepton&quot;;
            cutFlowVector_str[2] = &quot;SR2ASF--Same flavour&quot;;
            cutFlowVector_str[3] = &quot;SR2ASF--mll&gt;111GeV&quot;;
            cutFlowVector_str[4] = &quot;SR2ASF--n_{b-jets}=0&quot;;
            cutFlowVector_str[5] = &quot;SR2ASF--R_{2l2j}&gt;0.3&quot;;
            cutFlowVector_str[6] = &quot;SR2ASF--Delta x&lt;0.07&quot;;
            cutFlowVector_str[7] = &quot;SR2ASF--120&lt;MT2&lt;140&quot;;
            cutFlowVector_str[8] = &quot;SR2ASF--140&lt;MT2&lt;160&quot;;
            cutFlowVector_str[9] = &quot;SR2ASF--160&lt;MT2&lt;180&quot;;
            cutFlowVector_str[10] = &quot;SR2ASF--180&lt;MT2&quot;;

            cutFlowVector_str[11] = &quot;SR2ADF--Different falvour&quot;;
            cutFlowVector_str[12] = &quot;SR2ADF--mll&gt;111GeV(only SF)&quot;;
            cutFlowVector_str[13] = &quot;SR2ADF--n_{b-jets}=0&quot;;
            cutFlowVector_str[14] = &quot;SR2ADF--R_{2l2j}&gt;0.3(only SF)&quot;;
            cutFlowVector_str[15] = &quot;SR2ADF--Delta x&lt;0.07&quot;;
            cutFlowVector_str[16] = &quot;SR2ADF--120&lt;MT2&lt;140&quot;;
            cutFlowVector_str[17] = &quot;SR2ADF--140&lt;MT2&lt;160&quot;;
            cutFlowVector_str[18] = &quot;SR2ADF--160&lt;MT2&lt;180&quot;;
            cutFlowVector_str[19] = &quot;SR2ADF--180&lt;MT2&quot;;
            /*---------------------------------------*/
            cutFlowVector_str[20] = &quot;SR2BC--trigger &amp;&amp; 2 OS lepton&quot;;
            cutFlowVector_str[21] = &quot;SR2BSF--Same flavour&quot;;
            cutFlowVector_str[22] = &quot;SR2BSF--mll&gt;111GeV or mll&lt;71GeV&quot;;
            cutFlowVector_str[23] = &quot;SR2BSF--n_{b-jets}&gt;0 &amp;&amp; n_{jets}&gt;1&quot;;
            cutFlowVector_str[24] = &quot;SR2BSF--Delta phi_{boost}&lt;1.5&quot;;
            cutFlowVector_str[25] = &quot;SR2BSF--120&lt;MT2&lt;140&quot;;
            cutFlowVector_str[26] = &quot;SR2BSF--140&lt;MT2&quot;;

            cutFlowVector_str[27] = &quot;SR2BDF--Different flavour&quot;;
            cutFlowVector_str[28] = &quot;SR2BDF--mll&gt;111GeV or mll&lt;71GeV(only SF)&quot;;
            cutFlowVector_str[29] = &quot;SR2BDF--n_{b-jets}&gt;0 &amp;&amp; n_{jets}&gt;1&quot;;
            cutFlowVector_str[30] = &quot;SR2BDF--Delta phi_{boost}&lt;1.5&quot;;
            cutFlowVector_str[31] = &quot;SR2BDF--120&lt;MT2&lt;140&quot;;
            cutFlowVector_str[32] = &quot;SR2BDF--140&lt;MT2&quot;;

            cutFlowVector_str[33] = &quot;SR2CSF--n_{b-jets}&gt;0 &amp;&amp; n_{jets}&gt;1&quot;;
            cutFlowVector_str[34] = &quot;SR2CSF--n_{jets}&gt;2&quot;;
            cutFlowVector_str[35] = &quot;SR2CSF--R_{2l}&gt;1.2&quot;;
            cutFlowVector_str[36] = &quot;SR2CSF--E_T^{miss}&gt;200GeV&quot;;
            cutFlowVector_str[37] = &quot;SR2CSF--110&lt;MT2&quot;;

            cutFlowVector_str[38] = &quot;SR2CDF--n_{b-jets}&gt;0 &amp;&amp; n_{jets}&gt;1&quot;;
            cutFlowVector_str[39] = &quot;SR2CDF--n_{jets}&gt;2&quot;;
            cutFlowVector_str[40] = &quot;SR2CDF--R_{2l}&gt;1.2&quot;;
            cutFlowVector_str[41] = &quot;SR2CDF--E_T^{miss}&gt;200GeV&quot;;
            cutFlowVector_str[42] = &quot;SR2CDF--110&lt;MT2&quot;;

            /*---------------------------------------*/
            cutFlowVector_str[57] = &quot;SR4b--MET trigger &amp;&amp; 2 OS Leptons &quot;;
            cutFlowVector_str[58] = &quot;SR4b--m_{ll}&gt;10GeV &quot;;
            cutFlowVector_str[59] = &quot;SR4b--PT(l1)&lt;80GeV &amp;&amp; PT(l1)&lt;35GeV &quot;;
            cutFlowVector_str[60] = &quot;SR4b--n_{jets}&gt;2 &quot;;
            cutFlowVector_str[61] = &quot;SR4b--PT(j1)&gt;150GeV &quot;;
            cutFlowVector_str[62] = &quot;SR4b--PT(j3)/MET&lt;0.14 &quot;;
            cutFlowVector_str[63] = &quot;SR4b--R_{2l4j}&gt;0.35 &quot;;
            cutFlowVector_str[64] = &quot;SR4b--R_{2l}&gt;12 &quot;;
            cutFlowVector_str[65] = &quot;SR4b--veto on j1 and j2 &quot;;

            for(int j=0;j&lt;NCUTS;j++){
                if(
                   (j==0) ||
                   /********* SRA-2body *********/
                   (j==1  &amp;&amp; cABC_TriggerOS) ||
                   //Same Flavour
                   (j==2  &amp;&amp; cABC_SF) ||
                   (j==3  &amp;&amp; cABC_SF &amp;&amp; cA_mllGt111) ||
                   (j==4  &amp;&amp; cABC_SF &amp;&amp; cA_mllGt111 &amp;&amp; cA_nobjet) ||
                   (j==5  &amp;&amp; cABC_SF &amp;&amp; cA_mllGt111 &amp;&amp; cA_nobjet &amp;&amp; CA_R2l2j) ||
                   (j==6  &amp;&amp; cABC_SF &amp;&amp; cA_mllGt111 &amp;&amp; cA_nobjet &amp;&amp; CA_R2l2j &amp;&amp; cA_deltaX) ||
                   (j==7  &amp;&amp; cABC_SF &amp;&amp; cA_mllGt111 &amp;&amp; cA_nobjet &amp;&amp; CA_R2l2j &amp;&amp; cA_deltaX &amp;&amp; cA_MT2120) ||
                   (j==8  &amp;&amp; cABC_SF &amp;&amp; cA_mllGt111 &amp;&amp; cA_nobjet &amp;&amp; CA_R2l2j &amp;&amp; cA_deltaX &amp;&amp; cA_MT2140) ||
                   (j==9  &amp;&amp; cABC_SF &amp;&amp; cA_mllGt111 &amp;&amp; cA_nobjet &amp;&amp; CA_R2l2j &amp;&amp; cA_deltaX &amp;&amp; cA_MT2160) ||
                   (j==10  &amp;&amp; cABC_SF &amp;&amp; cA_mllGt111 &amp;&amp; cA_nobjet &amp;&amp; CA_R2l2j &amp;&amp; cA_deltaX &amp;&amp; cA_MT2180) ||
                   //different Flavour
                   (j==11 &amp;&amp; cABC_TriggerOS &amp;&amp; (!cABC_SF)) ||
                   (j==12 &amp;&amp; cABC_TriggerOS &amp;&amp; (!cABC_SF)) ||
                   (j==13 &amp;&amp; (!cABC_SF) &amp;&amp; cA_nobjet) ||
                   (j==14 &amp;&amp; (!cABC_SF) &amp;&amp; cA_nobjet) ||
                   (j==15 &amp;&amp; (!cABC_SF) &amp;&amp; cA_nobjet &amp;&amp; cA_deltaX) ||
                   (j==16 &amp;&amp; (!cABC_SF) &amp;&amp; cA_nobjet &amp;&amp; cA_deltaX &amp;&amp; cA_MT2120) ||
                   (j==17 &amp;&amp; (!cABC_SF) &amp;&amp; cA_nobjet &amp;&amp; cA_deltaX &amp;&amp; cA_MT2140) ||
                   (j==18 &amp;&amp; (!cABC_SF) &amp;&amp; cA_nobjet &amp;&amp; cA_deltaX &amp;&amp; cA_MT2160) ||
                   (j==19 &amp;&amp; (!cABC_SF) &amp;&amp; cA_nobjet &amp;&amp; cA_deltaX &amp;&amp; cA_MT2180) ||
                   /********* SRB-2body *********/
                   (j==20  &amp;&amp; cABC_TriggerOS) ||
                   //Same Flavour
                   (j==21  &amp;&amp; cABC_SF) ||
                   (j==22  &amp;&amp; cABC_SF &amp;&amp; cBC_mllExMz) ||
                   (j==23  &amp;&amp; cABC_SF &amp;&amp; cBC_mllExMz &amp;&amp; cBC_nbnj) ||
                   (j==24  &amp;&amp; cABC_SF &amp;&amp; cBC_mllExMz &amp;&amp; cBC_nbnj &amp;&amp; cB_DelBoost) ||
                   (j==25  &amp;&amp; cABC_SF &amp;&amp; cBC_mllExMz &amp;&amp; cBC_nbnj &amp;&amp; cB_DelBoost &amp;&amp; cB_MT2120) ||
                   (j==26  &amp;&amp; cABC_SF &amp;&amp; cBC_mllExMz &amp;&amp; cBC_nbnj &amp;&amp; cB_DelBoost &amp;&amp; cB_MT2140) ||
                   //different Flavour
                   (j==27  &amp;&amp; cABC_TriggerOS &amp;&amp; (!cABC_SF)) ||
                   (j==28  &amp;&amp; cABC_TriggerOS &amp;&amp; (!cABC_SF)) ||
                   (j==29  &amp;&amp; (!cABC_SF) &amp;&amp; cBC_nbnj) ||
                   (j==30  &amp;&amp; (!cABC_SF) &amp;&amp; cBC_nbnj &amp;&amp; cB_DelBoost) ||
                   (j==31  &amp;&amp; (!cABC_SF) &amp;&amp; cBC_nbnj &amp;&amp; cB_DelBoost &amp;&amp; cB_MT2120) ||
                   (j==32  &amp;&amp; (!cABC_SF) &amp;&amp; cBC_nbnj &amp;&amp; cB_DelBoost &amp;&amp; cB_MT2140) ||
                   /********* SRC-2body *********/
                   //Same Flavour
                   (j==33  &amp;&amp; cABC_SF &amp;&amp; cBC_mllExMz &amp;&amp; cBC_nbnj) ||
                   (j==34  &amp;&amp; cABC_SF &amp;&amp; cBC_mllExMz &amp;&amp; cBC_nbnj &amp;&amp; cC_njGt2) ||
                   (j==35  &amp;&amp; cABC_SF &amp;&amp; cBC_mllExMz &amp;&amp; cBC_nbnj &amp;&amp; cC_njGt2 &amp;&amp; cC_R2lGt1o2) ||
                   (j==36  &amp;&amp; cABC_SF &amp;&amp; cBC_mllExMz &amp;&amp; cBC_nbnj &amp;&amp; cC_njGt2 &amp;&amp; cC_R2lGt1o2 &amp;&amp; cC_METGt200) ||
                   (j==37  &amp;&amp; cABC_SF &amp;&amp; cBC_mllExMz &amp;&amp; cBC_nbnj &amp;&amp; cC_njGt2 &amp;&amp; cC_R2lGt1o2 &amp;&amp; cC_METGt200 &amp;&amp; cC_MT2110) ||
                   //different Flavour
                   (j==38  &amp;&amp; (!cABC_SF) &amp;&amp; cBC_nbnj) ||
                   (j==39  &amp;&amp; (!cABC_SF) &amp;&amp; cBC_nbnj &amp;&amp; cC_njGt2) ||
                   (j==40  &amp;&amp; (!cABC_SF) &amp;&amp; cBC_nbnj &amp;&amp; cC_njGt2 &amp;&amp; cC_R2lGt1o2) ||
                   (j==41  &amp;&amp; (!cABC_SF) &amp;&amp; cBC_nbnj &amp;&amp; cC_njGt2 &amp;&amp; cC_R2lGt1o2 &amp;&amp; cC_METGt200) ||
                   (j==42  &amp;&amp; (!cABC_SF) &amp;&amp; cBC_nbnj &amp;&amp; cC_njGt2 &amp;&amp; cC_R2lGt1o2 &amp;&amp; cC_METGt200 &amp;&amp; cC_MT2110) ||
                   /********* SR-4body *********/
                   (j==57 &amp;&amp; c4_METOSlepton ) ||
                   (j==58 &amp;&amp; c4_METOSlepton &amp;&amp; c4_mllGt10) ||
                   (j==59 &amp;&amp; c4_METOSlepton &amp;&amp; c4_mllGt10 &amp;&amp; c4_SoftLepton) ||
                   (j==60 &amp;&amp; c4_METOSlepton &amp;&amp; c4_mllGt10 &amp;&amp; c4_SoftLepton &amp;&amp; c4_njetGt2) ||
                   (j==61 &amp;&amp; c4_METOSlepton &amp;&amp; c4_mllGt10 &amp;&amp; c4_SoftLepton &amp;&amp; c4_Jet1PtGt150) ||
                   (j==62 &amp;&amp; c4_METOSlepton &amp;&amp; c4_mllGt10 &amp;&amp; c4_SoftLepton &amp;&amp; c4_Jet1PtGt150 &amp;&amp; c4_Jet3PtMET) ||
                   (j==63 &amp;&amp; c4_METOSlepton &amp;&amp; c4_mllGt10 &amp;&amp; c4_SoftLepton &amp;&amp; c4_Jet1PtGt150 &amp;&amp; c4_Jet3PtMET &amp;&amp; c4_R2l4j) ||
                   (j==64 &amp;&amp; c4_METOSlepton &amp;&amp; c4_mllGt10 &amp;&amp; c4_SoftLepton &amp;&amp; c4_Jet1PtGt150 &amp;&amp; c4_Jet3PtMET &amp;&amp; c4_R2l4j &amp;&amp; c4_R2l) ||
                   (j==65 &amp;&amp; c4_METOSlepton &amp;&amp; c4_mllGt10 &amp;&amp; c4_SoftLepton &amp;&amp; c4_Jet1PtGt150 &amp;&amp; c4_Jet3PtMET &amp;&amp; c4_R2l4j &amp;&amp; c4_R2l &amp;&amp; c4_2bjetveto)
                   )cutFlowVector[j]++;

            }
            // signal region

            if (   cABC_SF  &amp;&amp; cA_mllGt111 &amp;&amp; cA_nobjet &amp;&amp; CA_R2l2j &amp;&amp; cA_deltaX &amp;&amp; cA_MT2120 ) _counters.at(&quot;SRASF120&quot;).add_event(event);
            if ( (!cABC_SF)                &amp;&amp; cA_nobjet             &amp;&amp; cA_deltaX &amp;&amp; cA_MT2120 ) _counters.at(&quot;SRADF120&quot;).add_event(event);
            if (   cABC_SF  &amp;&amp; cA_mllGt111 &amp;&amp; cA_nobjet &amp;&amp; CA_R2l2j &amp;&amp; cA_deltaX &amp;&amp; cA_MT2140 ) _counters.at(&quot;SRASF140&quot;).add_event(event);
            if ( (!cABC_SF)                &amp;&amp; cA_nobjet             &amp;&amp; cA_deltaX &amp;&amp; cA_MT2140 ) _counters.at(&quot;SRADF140&quot;).add_event(event);
            if (   cABC_SF  &amp;&amp; cA_mllGt111 &amp;&amp; cA_nobjet &amp;&amp; CA_R2l2j &amp;&amp; cA_deltaX &amp;&amp; cA_MT2160 ) _counters.at(&quot;SRASF160&quot;).add_event(event);
            if ( (!cABC_SF)                &amp;&amp; cA_nobjet             &amp;&amp; cA_deltaX &amp;&amp; cA_MT2160 ) _counters.at(&quot;SRADF160&quot;).add_event(event);
            if (   cABC_SF  &amp;&amp; cA_mllGt111 &amp;&amp; cA_nobjet &amp;&amp; CA_R2l2j &amp;&amp; cA_deltaX &amp;&amp; cA_MT2180 ) _counters.at(&quot;SRASF180&quot;).add_event(event);
            if ( (!cABC_SF)                &amp;&amp; cA_nobjet             &amp;&amp; cA_deltaX &amp;&amp; cA_MT2180 ) _counters.at(&quot;SRADF180&quot;).add_event(event);

            if (   cABC_SF  &amp;&amp; cBC_mllExMz &amp;&amp; cBC_nbnj &amp;&amp; cB_DelBoost &amp;&amp; cB_MT2120 ) _counters.at(&quot;SRBSF120&quot;).add_event(event);
            if ( (!cABC_SF)                &amp;&amp; cBC_nbnj &amp;&amp; cB_DelBoost &amp;&amp; cB_MT2120 ) _counters.at(&quot;SRBDF120&quot;).add_event(event);
            if (   cABC_SF  &amp;&amp; cBC_mllExMz &amp;&amp; cBC_nbnj &amp;&amp; cB_DelBoost &amp;&amp; cB_MT2140 ) _counters.at(&quot;SRBSF140&quot;).add_event(event);
            if ( (!cABC_SF)                &amp;&amp; cBC_nbnj &amp;&amp; cB_DelBoost &amp;&amp; cB_MT2140 ) _counters.at(&quot;SRBDF140&quot;).add_event(event);

            if (   cABC_SF  &amp;&amp; cBC_mllExMz &amp;&amp; cBC_nbnj &amp;&amp; cC_njGt2 &amp;&amp; cC_R2lGt1o2 &amp;&amp; cC_METGt200 &amp;&amp; cC_MT2110 ) _counters.at(&quot;SRCSF110&quot;).add_event(event);
            if ( (!cABC_SF) &amp;&amp;                cBC_nbnj &amp;&amp; cC_njGt2 &amp;&amp; cC_R2lGt1o2 &amp;&amp; cC_METGt200 &amp;&amp; cC_MT2110 ) _counters.at(&quot;SRCDF110&quot;).add_event(event);


            if (c4_METOSlepton &amp;&amp; c4_mllGt10 &amp;&amp; c4_SoftLepton &amp;&amp; c4_Jet1PtGt150 &amp;&amp; c4_Jet3PtMET &amp;&amp; c4_R2l4j &amp;&amp; c4_R2l &amp;&amp; c4_2bjetveto) _counters.at(&quot;SR4b&quot;).add_event(event);
        return;

        }

        void combine(const Analysis* other)
        {
            const Analysis_ATLAS_13TeV_2LEPStop_36invfb* specificOther
                = dynamic_cast&lt;const Analysis_ATLAS_13TeV_2LEPStop_36invfb*&gt;(other);

            for (auto&amp; pair : _counters) { pair.second += specificOther-&gt;_counters.at(pair.first); }

            if (NCUTS != specificOther-&gt;NCUTS) NCUTS = specificOther-&gt;NCUTS;
            for (int j=0; j&lt;NCUTS; j++)
            {
                cutFlowVector[j] += specificOther-&gt;cutFlowVector[j];
                cutFlowVector_str[j] = specificOther-&gt;cutFlowVector_str[j];
            }
        }


        void collect_results() {

            // double scale_by=1.;
            // cout &lt;&lt; &quot;------------------------------------------------------------------------------------------------------------------------------ &quot;&lt;&lt;endl;
            // cout &lt;&lt; &quot;CUT FLOW: ATLAS 13 TeV 2 lep stop paper &quot;&lt;&lt;endl;
            // cout &lt;&lt; &quot;------------------------------------------------------------------------------------------------------------------------------&quot;&lt;&lt;endl;
            // cout&lt;&lt; right &lt;&lt; setw(40) &lt;&lt; &quot;CUT&quot; &lt;&lt;  &quot;,&quot; &lt;&lt; setw(20) &lt;&lt; &quot;RAW&quot; &lt;&lt;  &quot;,&quot; &lt;&lt; setw(20) &lt;&lt; &quot;SCALED&quot;
            // &lt;&lt;  &quot;,&quot; &lt;&lt; setw(20) &lt;&lt; &quot;%&quot; &lt;&lt;  &quot;,&quot; &lt;&lt; setw(20) &lt;&lt; &quot;clean adj RAW&quot;&lt;&lt;  &quot;,&quot; &lt;&lt; setw(20) &lt;&lt; &quot;clean adj %&quot; &lt;&lt; endl;
            // for (int j=0; j&lt;NCUTS; j++) {
            //     cout &lt;&lt; right &lt;&lt;  setw(40) &lt;&lt; cutFlowVector_str[j].c_str() &lt;&lt;  &quot;,&quot; &lt;&lt; setw(20)
            //     &lt;&lt; cutFlowVector[j] &lt;&lt;  &quot;,&quot; &lt;&lt; setw(20) &lt;&lt; cutFlowVector[j]*scale_by &lt;&lt;  &quot;,&quot; &lt;&lt; setw(20)
            //     &lt;&lt; 100.*cutFlowVector[j]/cutFlowVector[0] &lt;&lt; &quot;%&quot; &lt;&lt;  &quot;,&quot; &lt;&lt; setw(20)
            //     &lt;&lt; cutFlowVector[j]*scale_by &lt;&lt;  &quot;,&quot; &lt;&lt; setw(20) &lt;&lt; 100.*cutFlowVector[j]/cutFlowVector[0]&lt;&lt; &quot;%&quot; &lt;&lt; endl;
            // }
            // cout &lt;&lt; &quot;------------------------------------------------------------------------------------------------------------------------------ &quot;&lt;&lt;endl;


            // add_result(SignalRegionData(&quot;SR label&quot;, n_obs, {n_sig_MC, n_sig_MC_sys}, {n_bkg, n_bkg_err}));

            // signal regin 2-body A
            add_result(SignalRegionData(_counters.at(&quot;SRASF120&quot;), 22., { 20.0, 4.6}));
            add_result(SignalRegionData(_counters.at(&quot;SRADF120&quot;), 27., { 23.8, 4.2}));
            add_result(SignalRegionData(_counters.at(&quot;SRASF140&quot;), 6., { 11.0, 2.5}));
            add_result(SignalRegionData(_counters.at(&quot;SRADF140&quot;), 6., { 10.8, 2.1}));
            add_result(SignalRegionData(_counters.at(&quot;SRASF160&quot;), 10., { 5.6, 1.8}));
            add_result(SignalRegionData(_counters.at(&quot;SRADF160&quot;), 7., { 6.4, 1.3}));
            add_result(SignalRegionData(_counters.at(&quot;SRASF180&quot;), 16., { 12.3, 2.6}));
            add_result(SignalRegionData(_counters.at(&quot;SRADF180&quot;), 8., { 5.4, 1.7}));
            // signal regin 2-body B
            add_result(SignalRegionData(_counters.at(&quot;SRBSF120&quot;), 17., { 16.3, 6.2}));
            add_result(SignalRegionData(_counters.at(&quot;SRBDF120&quot;), 13., { 16.1, 5.3}));
            add_result(SignalRegionData(_counters.at(&quot;SRBSF140&quot;), 9., { 7.4, 1.1}));
            add_result(SignalRegionData(_counters.at(&quot;SRBDF140&quot;), 7., { 4.8, 1.0}));
            // signal regin 2-body C
            add_result(SignalRegionData(_counters.at(&quot;SRCSF110&quot;), 11., { 5.3, 1.8}));
            add_result(SignalRegionData(_counters.at(&quot;SRCDF110&quot;), 7., { 3.8, 1.5}));
            // signal regin 4-body
            add_result(SignalRegionData(_counters.at(&quot;SR4b&quot;), 30., { 28., 6.}));

            return;
        }

    protected:
      void analysis_specific_reset() {
        for (auto&amp; pair : _counters) { pair.second.reset(); }
        std::fill(cutFlowVector.begin(), cutFlowVector.end(), 0);
      }

    };



    DEFINE_ANALYSIS_FACTORY(ATLAS_13TeV_2LEPStop_36invfb)


  }
}
</code></pre><hr><p>Updated on 2022-08-02 at 18:18:40 +0000</p><div class=edit-page><a href=https://github.com/RC1242RC/gambit_gh_pages/blob/master/content/en/documentation/code/gambit_sphinx/Files/Analysis__ATLAS__13TeV__2LEPStop__36invfb_8cpp.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on GitHub</a></div></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a class=text-muted href=https://www.netlify.com/>Netlify</a>, <a class=text-muted href=https://gohugo.io/>Hugo</a>, and <a class=text-muted href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline><li class=list-inline-item><a href=/license/>License</a></li></ul></div></div></div></footer><script src=/js/bootstrap.min.54bf0932b8a36d0e152b1635b099a6ef1394d35327e2437550a075c9c8ed1bd8aed5847c21b36fc02ed24014c031d9ca24017b0c78b1639d7e2fa8329898b842.js integrity="sha512-VL8JMrijbQ4VKxY1sJmm7xOU01Mn4kN1UKB1ycjtG9iu1YR8IbNvwC7SQBTAMdnKJAF7DHixY51+L6gymJi4Qg==" crossorigin=anonymous defer></script>
<script src=/js/highlight.min.5b48bc253dc75aeea5fb366ecf700f4925e2b6eb1a1466f2124b722d68148d67bc0a9365d2b8ad9c585161b46372d23b08509a16f1fd518542b894756d4752d0.js integrity="sha512-W0i8JT3HWu6l+zZuz3APSSXitusaFGbyEktyLWgUjWe8CpNl0ritnFhRYbRjctI7CFCaFvH9UYVCuJR1bUdS0A==" crossorigin=anonymous defer></script>
<script src=/main.min.40265e9a032aeba5eaf67baac3cbbc22667a7533215d326eeb3e9f4d5e4be40f9ff4dcd22949db73ae527ca26a19d7998091a8973c82af760b2c0daa335190ed.js integrity="sha512-QCZemgMq66Xq9nuqw8u8ImZ6dTMhXTJu6z6fTV5L5A+f9NzSKUnbc65SfKJqGdeZgJGolzyCr3YLLA2qM1GQ7Q==" crossorigin=anonymous defer></script>
<script src=https://rc1242rc.github.io/index.min.97d6402d7a34cdd5bd42756d4cab0cf30d540a9cfd60b87b21ea49bb4e8ab243c43c3171889d41e133bd95a5c6d18e02d0f4cd3d09c2e02e58f2cc367481d403.js integrity="sha512-l9ZALXo0zdW9QnVtTKsM8w1UCpz9YLh7IepJu06KskPEPDFxiJ1B4TO9laXG0Y4C0PTNPQnC4C5Y8sw2dIHUAw==" crossorigin=anonymous defer></script></body></html>