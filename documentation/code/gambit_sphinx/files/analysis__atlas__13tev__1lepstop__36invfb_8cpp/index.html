<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://rc1242rc.github.io/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://rc1242rc.github.io/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://rc1242rc.github.io/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var e=localStorage.getItem("theme");e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=https://rc1242rc.github.io/main.f12f7e04ea768acebec10c86baf049d74d6a79f24bc0dfb7ed77aa60462432916dd1ce8f41c78b69496adf650b3039a28a210183cce598f09b95d6fecb5ff999.css integrity="sha512-8S9+BOp2is6+wQyGuvBJ101qefJLwN+37XeqYEYkMpFt0c6PQceLaUlq32ULMDmiiiEBg8zlmPCbldb+y1/5mQ==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>file analyses/Analysis_ATLAS_13TeV_1LEPStop_36invfb.cpp - GAMBIT</title><meta name=description content="[No description available]"><link rel=canonical href=https://rc1242rc.github.io/documentation/code/gambit_sphinx/files/analysis__atlas__13tev__1lepstop__36invfb_8cpp/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="file analyses/Analysis_ATLAS_13TeV_1LEPStop_36invfb.cpp"><meta property="og:description" content="[No description available]"><meta property="og:url" content="https://rc1242rc.github.io/documentation/code/gambit_sphinx/files/analysis__atlas__13tev__1lepstop__36invfb_8cpp/"><meta property="og:site_name" content="GAMBIT"><meta property="og:image" content="https://rc1242rc.github.io/gambit_logo.png"><meta property="og:image:alt" content="GAMBIT"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content><meta name=twitter:creator content><meta name=twitter:title content="file analyses/Analysis_ATLAS_13TeV_1LEPStop_36invfb.cpp"><meta name=twitter:description content="[No description available]"><meta name=twitter:image content="https://rc1242rc.github.io/gambit_logo.png"><meta name=twitter:image:alt content="file analyses/Analysis_ATLAS_13TeV_1LEPStop_36invfb.cpp"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://rc1242rc.github.io/#/schema/organization/1","name":"Doks","url":"https://rc1242rc.github.io/","sameAs":["https://github.com/GambitBSM"],"logo":{"@type":"ImageObject","@id":"https://rc1242rc.github.io/#/schema/image/1","url":"https://rc1242rc.github.io/logo-doks.png","width":450,"height":416,"caption":"Doks"},"image":{"@id":"https://rc1242rc.github.io/#/schema/image/1"}},{"@type":"WebSite","@id":"https://rc1242rc.github.io/#/schema/website/1","url":"https://rc1242rc.github.io/","name":"GAMBIT","description":"Documentation for the Global And Modular BSM Inference Tool","publisher":{"@id":"https://rc1242rc.github.io/#/schema/organization/1"}},{"@type":"WebPage","@id":"https://rc1242rc.github.io/documentation/code/gambit_sphinx/files/analysis__atlas__13tev__1lepstop__36invfb_8cpp/","url":"https://rc1242rc.github.io/documentation/code/gambit_sphinx/files/analysis__atlas__13tev__1lepstop__36invfb_8cpp/","name":"file analyses\/Analysis_ATLAS_13TeV_1LEPStop_36invfb.cpp","description":"[No description available]","isPartOf":{"@id":"https://rc1242rc.github.io/#/schema/website/1"},"about":{"@id":"https://rc1242rc.github.io/#/schema/organization/1"},"datePublished":"0001-01-01T00:00:00CET","dateModified":"0001-01-01T00:00:00CET","breadcrumb":{"@id":"https://rc1242rc.github.io/documentation/code/gambit_sphinx/files/analysis__atlas__13tev__1lepstop__36invfb_8cpp/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://rc1242rc.github.io/documentation/code/gambit_sphinx/files/analysis__atlas__13tev__1lepstop__36invfb_8cpp/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://rc1242rc.github.io/documentation/code/gambit_sphinx/files/analysis__atlas__13tev__1lepstop__36invfb_8cpp/"]}]},{"@type":"BreadcrumbList","@id":"https://rc1242rc.github.io/documentation/code/gambit_sphinx/files/analysis__atlas__13tev__1lepstop__36invfb_8cpp/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://rc1242rc.github.io/","url":"https://rc1242rc.github.io/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://rc1242rc.github.io/documentation/","url":"https://rc1242rc.github.io/documentation/","name":"Documentation"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://rc1242rc.github.io/documentation/code/","url":"https://rc1242rc.github.io/documentation/code/","name":"Code"}},{"@type":"ListItem","position":4,"item":{"@type":"WebPage","@id":"https://rc1242rc.github.io/documentation/code/gambit_sphinx/","url":"https://rc1242rc.github.io/documentation/code/gambit_sphinx/","name":"Gambit Sphinx"}},{"@type":"ListItem","position":5,"item":{"@type":"WebPage","@id":"https://rc1242rc.github.io/documentation/code/gambit_sphinx/files/","url":"https://rc1242rc.github.io/documentation/code/gambit_sphinx/files/","name":"Files"}},{"@type":"ListItem","position":6,"item":{"@id":"https://rc1242rc.github.io/documentation/code/gambit_sphinx/files/analysis__atlas__13tev__1lepstop__36invfb_8cpp/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://rc1242rc.github.io/documentation/code/gambit_sphinx/files/analysis__atlas__13tev__1lepstop__36invfb_8cpp/#/schema/image/2","url":"https://rc1242rc.github.io/gambit_logo.png","contentUrl":"https://rc1242rc.github.io/gambit_logo.png","caption":"file analyses\/Analysis_ATLAS_13TeV_1LEPStop_36invfb.cpp"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=https://rc1242rc.github.io/favicon.ico sizes=any><link rel=icon type=image/svg+xml href=https://rc1242rc.github.io/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=https://rc1242rc.github.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://rc1242rc.github.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://rc1242rc.github.io/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://rc1242rc.github.io/site.webmanifest></head><body class="documentation single light"><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-md navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-md-nowrap" aria-label="Main navigation"><a class="navbar-brand p-0 me-auto" href=https://rc1242rc.github.io/ aria-label=GAMBIT><img class=logo-light src=https://rc1242rc.github.io//images/gambit_logo.png width=50px>
<img class="logo-dark d-none" src=https://rc1242rc.github.io//images/gambit_logo.png width=50px>
GAMBIT</a>
<button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=/>GAMBIT</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Documentation
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=/documentation/installation/introduction/>Installation</a></li><li><a class=dropdown-item href=/documentation/examples/colliderbit>Examples</a></li><li><a class=dropdown-item href=/documentation/help/faqs/>Help</a></li><li><a class=dropdown-item href=/documentation/code/index_classes>Code Reference</a></li></ul></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Community
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=/community/publications/>Publications</a></li><li><a class=dropdown-item href=/community/talks/>Talks</a></li><li><a class=dropdown-item href=/community/members/>Members</a></li><li><a class=dropdown-item href=/community/code_of_conduct/>Code of Conduct</a></li><li><a class=dropdown-item href=/community/contact/>Contact</a></li></ul></li></ul><hr class="text-black-50 my-4 d-lg-none"><form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2"><input id=search class="form-control is-search" type=search placeholder="Search site..." aria-label="Search site..." autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=https://github.com/GambitBSM><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-lg-none">GitHub</small></a></li></ul><hr class="text-black-50 my-4 d-lg-none"><div class=dropdown><button class="btn btn-doks-light dropdown-toggle" id=doks-versions data-bs-toggle=dropdown aria-expanded=false data-bs-display=static aria-label="Toggle version menu">
<span class=d-none>Doks</span>
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></button><ul class="dropdown-menu dropdown-menu-lg-end me-lg-2 shadow rounded border-0" aria-labelledby=doks-versions></ul></div></div></div></nav></header></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-installation aria-expanded=false>
Installation</button><div class=collapse id=section-installation><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/installation/introduction/>Getting Started</a></li><li><a class="docs-link rounded" href=/documentation/installation/docker_usage/>Docker Usage</a></li><li><a class="docs-link rounded" href=/documentation/installation/installation_for_linux/>Installation for Linux</a></li><li><a class="docs-link rounded" href=/documentation/installation/installation_for_windows/>Installation for Windows</a></li><li><a class="docs-link rounded" href=/documentation/installation/installation_for_macos/>Installation for macOS</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-examples aria-expanded=false>
Examples</button><div class=collapse id=section-examples><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/examples/colliderbit/>ColliderBit</a></li><li><a class="docs-link rounded" href=/documentation/examples/anotherbit/>AnotherBit</a></li><li><a class="docs-link rounded" href=/documentation/examples/anotherbit2/>AnotherBit2</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-help aria-expanded=false>
Help</button><div class=collapse id=section-help><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/help/faqs/>FAQs</a></li><li><a class="docs-link rounded" href=/documentation/help/compiler_matrix/>Compiler Matrix</a></li><li><a class="docs-link rounded" href=/documentation/help/known_issues/>Known Issues</a></li><li><a class="docs-link rounded" href=/documentation/help/configuration_examples/>Configuration Examples</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-code aria-expanded=false>
Code Reference</button></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section- aria-expanded=false>
GAMBIT_VERSION_HERE</button><div class=collapse id=section-><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/documentation/code/colliderbit_development/index_classes/>Classes</a></li><li><a class="docs-link rounded" href=/documentation/code/colliderbit_development/index_files/>Files</a></li><li><a class="docs-link rounded" href=/documentation/code/colliderbit_development/index_pages/>Pages</a></li><li><a class="docs-link rounded" href=/documentation/code/colliderbit_development/index_namespaces/>Namespaces</a></li></ul></div></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span>On this page</span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><ul><li><a href=#namespaces>Namespaces</a></li><li><a href=#classes>Classes</a></li><li><a href=#source-code>Source code</a></li></ul></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3>On this page</h3><nav id=TableOfContents><ul><li><ul><li><a href=#namespaces>Namespaces</a></li><li><a href=#classes>Classes</a></li><li><a href=#source-code>Source code</a></li></ul></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9 mx-xl-auto"><h1>file analyses/Analysis_ATLAS_13TeV_1LEPStop_36invfb.cpp</h1><p class=lead></p><p>[No description available]</p><h2 id=namespaces>Namespaces <a href=#namespaces class=anchor aria-hidden=true>#</a></h2><table><thead><tr><th>Name</th></tr></thead><tbody><tr><td><strong><a href=/documentation/code/gambit_sphinx/namespaces/namespacegambit/>Gambit</a></strong><br>TODO: see if we can use this one:</td></tr><tr><td><strong><a href=/documentation/code/gambit_sphinx/namespaces/namespacegambit_1_1colliderbit/>Gambit::ColliderBit</a></strong></td></tr></tbody></table><h2 id=classes>Classes <a href=#classes class=anchor aria-hidden=true>#</a></h2><table><thead><tr><th></th><th>Name</th></tr></thead><tbody><tr><td>class</td><td><strong><a href=/documentation/code/gambit_sphinx/classes/classgambit_1_1colliderbit_1_1analysis__atlas__13tev__1lepstop__36invfb/>Gambit::ColliderBit::Analysis_ATLAS_13TeV_1LEPStop_36invfb</a></strong></td></tr><tr><td>struct</td><td><strong><a href=/documentation/code/gambit_sphinx/classes/structgambit_1_1colliderbit_1_1analysis__atlas__13tev__1lepstop__36invfb_1_1clusteringhistory/>Gambit::ColliderBit::Analysis_ATLAS_13TeV_1LEPStop_36invfb::ClusteringHistory</a></strong></td></tr><tr><td>struct</td><td><strong><a href=/documentation/code/gambit_sphinx/classes/structgambit_1_1colliderbit_1_1analysis__atlas__13tev__1lepstop__36invfb_1_1clusteringhistory_1_1step/>Gambit::ColliderBit::Analysis_ATLAS_13TeV_1LEPStop_36invfb::ClusteringHistory::Step</a></strong></td></tr></tbody></table><h2 id=source-code>Source code <a href=#source-code class=anchor aria-hidden=true>#</a></h2><pre><code>#include &quot;gambit/cmake/cmake_variables.hpp&quot;
#ifndef EXCLUDE_ROOT

#include &lt;vector&gt;
#include &lt;cmath&gt;
#include &lt;memory&gt;
#include &lt;iomanip&gt;

#include &quot;gambit/Utils/threadsafe_rng.hpp&quot;
#include &quot;gambit/ColliderBit/analyses/Analysis.hpp&quot;
#include &quot;gambit/ColliderBit/ATLASEfficiencies.hpp&quot;
#include &quot;gambit/ColliderBit/mt2_bisect.h&quot;
#include &quot;TLorentzVector.h&quot;
#include &quot;TVector3.h&quot;
#include &quot;HEPUtils/FastJet.h&quot;
#include &quot;TRandom3.h&quot;

using namespace std;

/* The ATLAS 1 lepton direct stop analysis

   Based on: https://arxiv.org/abs/1711.11520

   Code by Martin White (based on ATLAS public code snippet on HepData)

   KNOWN ISSUES

   1) Have not added the BDT signal regions (despite having BDT code from ATLAS). They cover a specific kinematic region where the m_stop - m_chi1 mass difference is m_top, which we already know Pythia does badly with.

   2) We have no equivalent of the ATLAS fakeJER method. Am assuming a 3% JER on every jet for now.

   3) Have used TLorentzVectors for boosting. Could probably be done without ROOT?

*/

namespace Gambit {
  namespace ColliderBit {

    // Need two different functions here for use with std::sort
    bool sortByPT_1l(const HEPUtils::Jet* jet1, const HEPUtils::Jet* jet2) { return (jet1-&gt;pT() &gt; jet2-&gt;pT()); }
    bool sortByPT_1l_sharedptr(std::shared_ptr&lt;HEPUtils::Jet&gt; jet1, std::shared_ptr&lt;HEPUtils::Jet&gt; jet2) { return sortByPT_1l(jet1.get(), jet2.get()); }

    // Need two different functions here for use with std::sort
    bool sortByMass_1l(const HEPUtils::Jet* jet1, const HEPUtils::Jet* jet2) { return (jet1-&gt;mass() &gt; jet2-&gt;mass()); }
    bool sortByMass_1l_sharedptr(std::shared_ptr&lt;HEPUtils::Jet&gt; jet1, std::shared_ptr&lt;HEPUtils::Jet&gt; jet2) { return sortByMass_1l(jet1.get(), jet2.get()); }

    double calcMT_1l(HEPUtils::P4 jetMom,HEPUtils::P4 metMom)
    {
      //std::cout &lt;&lt; &quot;metMom.px() &quot; &lt;&lt; metMom.px() &lt;&lt; &quot; jetMom PT &quot; &lt;&lt; jetMom.pT() &lt;&lt; std::endl;
      double met=sqrt(metMom.px()*metMom.px()+metMom.py()*metMom.py());
      double dphi = metMom.deltaPhi(jetMom);
      double mt=sqrt(2*jetMom.pT()*met*(1-std::cos(dphi)));
      return mt;
    }


    class Analysis_ATLAS_13TeV_1LEPStop_36invfb : public Analysis
    {
    private:

      // Numbers passing cuts
      std::map&lt;string, EventCounter&gt; _counters = {
        {&quot;tN_med&quot;, EventCounter(&quot;tN_med&quot;)},
        {&quot;tN_high&quot;, EventCounter(&quot;tN_high&quot;)},
        {&quot;bWN&quot;, EventCounter(&quot;bWN&quot;)},
        {&quot;bC2x_diag&quot;, EventCounter(&quot;bC2x_diag&quot;)},
        {&quot;bC2x_med&quot;, EventCounter(&quot;bC2x_med&quot;)},
        {&quot;bCbv&quot;, EventCounter(&quot;bCbv&quot;)},
        {&quot;DM_low_loose&quot;, EventCounter(&quot;DM_low_loose&quot;)},
        {&quot;DM_low&quot;, EventCounter(&quot;DM_low&quot;)},
        {&quot;DM_high&quot;, EventCounter(&quot;DM_high&quot;)},
        {&quot;bffN&quot;, EventCounter(&quot;bffN&quot;)},
        {&quot;bCsoft_diag&quot;, EventCounter(&quot;bCsoft_diag&quot;)},
        {&quot;bCsoft_med&quot;, EventCounter(&quot;bCsoft_med&quot;)},
        {&quot;bCsoft_high&quot;, EventCounter(&quot;bCsoft_high&quot;)},
      };

      vector&lt;int&gt; cutFlowVector;
      vector&lt;string&gt; cutFlowVector_str;
      int NCUTS; //=16;


      void LeptonLeptonOverlapRemoval(vector&lt;const HEPUtils::Particle*&gt; &amp;lep1vec, vector&lt;const HEPUtils::Particle*&gt; &amp;lep2vec, double DeltaRMax)
      {

        //Routine to do jet-lepton check
        //Discards jets if they are within DeltaRMax of a lepton

        vector&lt;const HEPUtils::Particle*&gt; Survivors;

        for(unsigned int itlep1 = 0; itlep1 &lt; lep1vec.size(); itlep1++)
        {
          bool overlap = false;
          HEPUtils::P4 lep1mom=lep1vec.at(itlep1)-&gt;mom();
          for(unsigned int itlep2 = 0; itlep2 &lt; lep2vec.size(); itlep2++)
          {
            HEPUtils::P4 lep2mom=lep2vec.at(itlep2)-&gt;mom();
            double dR;

            dR=lep1mom.deltaR_eta(lep2mom);

            if(fabs(dR) &lt;= DeltaRMax) overlap=true;
          }
          if(overlap) continue;
          Survivors.push_back(lep1vec.at(itlep1));
        }
        lep1vec=Survivors;

        return;
      }


      void JetLeptonOverlapRemoval(vector&lt;const HEPUtils::Jet*&gt; &amp;jetvec, vector&lt;const HEPUtils::Particle*&gt; &amp;lepvec, double DeltaRMax)
      {
        //Routine to do jet-lepton check
        //Discards jets if they are within DeltaRMax of a lepton

        vector&lt;const HEPUtils::Jet*&gt; Survivors;

        for(unsigned int itjet = 0; itjet &lt; jetvec.size(); itjet++)
        {
          bool overlap = false;
          HEPUtils::P4 jetmom=jetvec.at(itjet)-&gt;mom();
          for(unsigned int itlep = 0; itlep &lt; lepvec.size(); itlep++)
          {
            HEPUtils::P4 lepmom=lepvec.at(itlep)-&gt;mom();
            double dR;

            dR=jetmom.deltaR_eta(lepmom);

            if(fabs(dR) &lt;= DeltaRMax) overlap=true;
          }
          if(overlap) continue;
          Survivors.push_back(jetvec.at(itjet));
        }
        jetvec=Survivors;

        return;
      }


      void LeptonJetOverlapRemoval(vector&lt;const HEPUtils::Particle*&gt; &amp;lepvec, vector&lt;const HEPUtils::Jet*&gt; &amp;jetvec)
      {
        //Routine to do lepton-jet check
        //Discards leptons if they are within dR of a jet as defined in analysis paper

        vector&lt;const HEPUtils::Particle*&gt; Survivors;

        for(unsigned int itlep = 0; itlep &lt; lepvec.size(); itlep++)
        {
          bool overlap = false;
          HEPUtils::P4 lepmom=lepvec.at(itlep)-&gt;mom();
          for(unsigned int itjet= 0; itjet &lt; jetvec.size(); itjet++)
          {
            HEPUtils::P4 jetmom=jetvec.at(itjet)-&gt;mom();
            double dR;
            double DeltaRMax = std::max(0.1,std::min(0.4, 0.04 + 10 / lepmom.pT()));
            dR=jetmom.deltaR_eta(lepmom);

            if(fabs(dR) &lt;= DeltaRMax) overlap=true;
          }
          if(overlap) continue;
          Survivors.push_back(lepvec.at(itlep));
        }
        lepvec=Survivors;

        return;
      }


    public:

      // Required detector sim
      static constexpr const char* detector = &quot;ATLAS&quot;;

      Analysis_ATLAS_13TeV_1LEPStop_36invfb()
      {

        set_analysis_name(&quot;ATLAS_13TeV_1LEPStop_36invfb&quot;);
        set_luminosity(36.);

        NCUTS=150;

        for(int i=0;i&lt;NCUTS;i++)
        {
          cutFlowVector.push_back(0);
          cutFlowVector_str.push_back(&quot;&quot;);
        }

      }

      struct ClusteringHistory : public FJNS::PseudoJet::UserInfoBase
      {
        enum Status
        {
          GOOD,
          JET_TOO_SMALL,
          JET_TOO_LARGE,
          TOO_MANY_ITERATIONS,
          NONE,
        };

        struct Step
        {
          double pt;
          double r;
          size_t constit;
          Status status;
        };

        size_t id;  // a per-event unique jet id that is needed for the event dump
        std::vector&lt;Step&gt; steps;

        static ClusteringHistory* AddStep(ClusteringHistory&amp; history, const Step&amp; step)
        {
          auto newHistory = new ClusteringHistory(history);
          newHistory-&gt;steps.push_back(step);
          return newHistory;
        }
      };

      // Return the history of a PseudoJet object, handling all the ugly casting.
      ClusteringHistory&amp; GetHistory(const FJNS::PseudoJet&amp; jet)
      {
        auto shared_ptr = jet.user_info_shared_ptr();
        return *dynamic_cast&lt;ClusteringHistory*&gt;(shared_ptr.get());
      }

      static std::vector&lt;FJNS::PseudoJet&gt; SortedByNConstit(std::vector&lt;FJNS::PseudoJet&gt; jets)
      {
        std::sort(jets.begin(), jets.end(), [](const FJNS::PseudoJet&amp; a, const FJNS::PseudoJet&amp; b) {
                        if (a.constituents().size() != b.constituents().size())
                        return a.constituents().size() &gt; b.constituents().size();
                        return a.pt() &gt; b.pt();
                        });

        return jets;
      }

      inline double optimalRadius(const double pT, const double m) { return 2 * m / pT; }
      inline double minRadius(const double pT, const double m) { return optimalRadius(pT, m) - 0.3; }
      inline double maxRadius(const double pT, const double m) { return optimalRadius(pT, m) + 0.5; }


      std::pair&lt;bool, FJNS::PseudoJet&gt; RecursiveRecluster(const FJNS::PseudoJet&amp; candidate, double candRadius,
                   const double mass, size_t step)
      {
        if (minRadius(candidate.pt(), mass) &gt; candRadius)
        {
          GetHistory(candidate).steps.back().status = ClusteringHistory::JET_TOO_SMALL;
          return std::make_pair(false, candidate);
        }
        else if (maxRadius(candidate.pt(), mass) &lt; candRadius)
        {
          const double newR = std::max(maxRadius(candidate.pt(), mass), candRadius / 2.);
          GetHistory(candidate).steps.back().status = ClusteringHistory::JET_TOO_LARGE;

          if (step &gt; 10)
          {
            GetHistory(candidate).steps.back().status = ClusteringHistory::TOO_MANY_ITERATIONS;
            return std::make_pair(false, candidate);
          }

          FJNS::JetDefinition jetDef(FJNS::antikt_algorithm, newR);
          auto cs = new FJNS::ClusterSequence(candidate.constituents(), jetDef);

          std::vector&lt;FJNS::PseudoJet&gt; reclusteredJets;
          reclusteredJets = SortedByNConstit(cs-&gt;inclusive_jets());

          if (reclusteredJets.size() == 0)
          {
            delete cs;
            return std::make_pair(false, FJNS::PseudoJet());
          }

          cs-&gt;delete_self_when_unused();
          auto newCandidate = reclusteredJets[0];

          auto newHistory = ClusteringHistory::AddStep(
                   GetHistory(candidate),
                   {newCandidate.pt(), newR, newCandidate.constituents().size(), ClusteringHistory::NONE});
          newCandidate.set_user_info(newHistory);

          return RecursiveRecluster(newCandidate, newR, mass, step + 1);
        }
        else
        {
          GetHistory(candidate).steps.back().status = ClusteringHistory::GOOD;
          return std::make_pair(true, candidate);
        }
      }


      HEPUtils::P4 reclusteredParticle(vector&lt;const HEPUtils::Jet*&gt; jets, vector&lt;const HEPUtils::Jet*&gt; bjets,
                                       const double mass, const bool useBJets)
      {

        //AnalysisObject p = AnalysisObject(0., 0., 0., 0., 0, 0, AnalysisObjectType::JET, 0, 0);
        HEPUtils::P4 p;
        double r0 = 3.0;

        vector&lt;const HEPUtils::Jet*&gt; usejets;
        for(const HEPUtils::Jet* jet : jets)
        {
          usejets.push_back(jet);
        }

        if (useBJets &amp;&amp; bjets.size())
        {
          for(const HEPUtils::Jet* bjet : bjets)
          {
            usejets.push_back(bjet);
          }
        }

        std::vector&lt;FJNS::PseudoJet&gt; initialJets;

        for (const HEPUtils::Jet* jet : usejets)
        {
          FJNS::PseudoJet Pjet(jet-&gt;mom().px(), jet-&gt;mom().py(), jet-&gt;mom().pz(), jet-&gt;mom().E());
          initialJets.push_back(Pjet);
        }

        FJNS::JetDefinition jetDef(FJNS::antikt_algorithm, r0);
        FJNS::ClusterSequence cs(initialJets, jetDef);

        auto candidates = FJNS::sorted_by_pt(cs.inclusive_jets());

        std::vector&lt;FJNS::PseudoJet&gt; selectedJets;
        selectedJets.reserve(candidates.size());
        std::vector&lt;FJNS::PseudoJet&gt; badJets;
        badJets.reserve(candidates.size());

        size_t i = 0;
        for (auto&amp; cand : candidates)
        {
          auto history = new ClusteringHistory();
          history-&gt;id = i;
          history-&gt;steps.push_back({cand.pt(), r0, cand.constituents().size(), ClusteringHistory::NONE});
          cand.set_user_info(history);
          ++i;
        }

        for (const auto&amp; cand : candidates)
        {
          bool selected = false;
          FJNS::PseudoJet jet;

          std::tie(selected, jet) = RecursiveRecluster(cand, r0, mass, 0);

          if (selected)
            selectedJets.push_back(jet);
          else
            badJets.push_back(jet);
        }

        if (selectedJets.size() &lt; 1)
        {
          return p;
        }

        vector&lt;std::shared_ptr&lt;HEPUtils::Jet&gt;&gt; aoSelectedJets;
        for (const FJNS::PseudoJet&amp; j : selectedJets) aoSelectedJets.push_back(std::make_shared&lt;HEPUtils::Jet&gt;(HEPUtils::mk_p4(j)));

        //for (const auto jet : selectedJets)
        //  aoSelectedJets.push_back(
        //     AnalysisObject(jet.px(), jet.py(), jet.pz(), jet.E(), 0, 0, AnalysisObjectType::COMBINED, 0, 0));

        std::sort(aoSelectedJets.begin(), aoSelectedJets.end(), sortByPT_1l_sharedptr);
        p = aoSelectedJets[0]-&gt;mom();

        return p;
      }


      void run(const HEPUtils::Event* event)
      {

        // Missing energy
        HEPUtils::P4 metVec = event-&gt;missingmom();
        double Met = event-&gt;met();

        // Construct baseline electron objects
        vector&lt;const HEPUtils::Particle*&gt; baselineElectrons;
        for (const HEPUtils::Particle* electron : event-&gt;electrons())
        {
          if (electron-&gt;pT() &gt; 5. &amp;&amp; electron-&gt;abseta() &lt; 2.47)
          {
            baselineElectrons.push_back(electron);
          }
        }

        // Apply electron efficiency
        ATLAS::applyElectronEff(baselineElectrons);

        // Construct baseline muon objects
        vector&lt;const HEPUtils::Particle*&gt; baselineMuons;
        for (const HEPUtils::Particle* muon : event-&gt;muons())
        {
          if (muon-&gt;pT() &gt; 4. &amp;&amp; muon-&gt;abseta() &lt; 2.7)
          {
            baselineMuons.push_back(muon);
          }
        }

        // Apply muon efficiency
        ATLAS::applyMuonEff(baselineMuons);

        // Construct set of all light baseline leptons
        vector&lt;const HEPUtils::Particle*&gt; baselineLeptons = baselineElectrons;
        baselineLeptons.insert(baselineLeptons.end(), baselineMuons.begin(), baselineMuons.end() );

        // Construct baseline tau objects
        vector&lt;const HEPUtils::Particle*&gt; baselineTaus;
        for (const HEPUtils::Particle* tau : event-&gt;taus())
        {
          if (tau-&gt;pT() &gt; 20. &amp;&amp; fabs(tau-&gt;eta()) &lt; 2.5) baselineTaus.push_back(tau);
        }
        // Apply tau efficiency
        ATLAS::applyTauEfficiencyR1(baselineTaus);

        // Photons
        vector&lt;const HEPUtils::Particle*&gt; signalPhotons;
        for (const HEPUtils::Particle* photon : event-&gt;photons())
        {
          signalPhotons.push_back(photon);
        }

        // Jets
        vector&lt;const HEPUtils::Jet*&gt; bJets;
        vector&lt;const HEPUtils::Jet*&gt; nonBJets;
        vector&lt;const HEPUtils::Jet*&gt; trueBJets; //for debugging

        // Get b jets
        const std::vector&lt;double&gt;  a = {0,10.};
        const std::vector&lt;double&gt;  b = {0,10000.};
        const std::vector&lt;double&gt; c = {0.77}; // set b-tag efficiency to 77%
        HEPUtils::BinnedFn2D&lt;double&gt; _eff2d(a,b,c);
        for (const HEPUtils::Jet* jet : event-&gt;jets())
        {
          bool hasTag=has_tag(_eff2d, fabs(jet-&gt;eta()), jet-&gt;pT());
          if (jet-&gt;pT() &gt; 20. &amp;&amp; fabs(jet-&gt;eta()) &lt; 4.9)
          {
            if(jet-&gt;btag() &amp;&amp; hasTag &amp;&amp; fabs(jet-&gt;eta()) &lt; 2.5 &amp;&amp; jet-&gt;pT() &gt; 20.)
            {
              bJets.push_back(jet);
            }
            else
            {
              nonBJets.push_back(jet);
            }
          }
        }

        // Note: use paper description instead of code snippet
        // This is not identical to the overlap removal in the paper
        // Probably good enough though
        LeptonLeptonOverlapRemoval(baselineMuons,baselineElectrons,0.01); // mimics shared track requirement
        JetLeptonOverlapRemoval(nonBJets,baselineElectrons,0.2);
        LeptonJetOverlapRemoval(baselineElectrons,nonBJets);
        LeptonJetOverlapRemoval(baselineElectrons,bJets);
        LeptonJetOverlapRemoval(baselineMuons,nonBJets);
        LeptonJetOverlapRemoval(baselineMuons,bJets);
        LeptonLeptonOverlapRemoval(baselineTaus,baselineElectrons,0.1);

        // Fill a jet-pointer-to-bool map to make it easy to check
        // if a given jet is treated as a b-jet in this analysis
        map&lt;const HEPUtils::Jet*,bool&gt; analysisBtags;
        for (const HEPUtils::Jet* jet : bJets) {
          analysisBtags[jet] = true;
        }
        for (const HEPUtils::Jet* jet : nonBJets) {
          analysisBtags[jet] = false;
        }

        // Signal object containers
        vector&lt;const HEPUtils::Particle*&gt; signalElectrons;
        vector&lt;const HEPUtils::Particle*&gt; signalSoftElectrons;
        vector&lt;const HEPUtils::Particle*&gt; signalMuons;
        vector&lt;const HEPUtils::Particle*&gt; signalSoftMuons;
        vector&lt;const HEPUtils::Particle*&gt; signalLeptons;
        vector&lt;const HEPUtils::Particle*&gt; signalSoftLeptons;
        vector&lt;const HEPUtils::Particle*&gt; electronsForVeto;
        vector&lt;const HEPUtils::Particle*&gt; muonsForVeto;

        vector&lt;const HEPUtils::Jet*&gt; signalJets;
        vector&lt;const HEPUtils::Jet*&gt; signalBJets;
        vector&lt;const HEPUtils::Jet*&gt; signalNonBJets;

        // Now apply signal jet cuts
        for (const HEPUtils::Jet* jet : bJets)
        {
          if(jet-&gt;pT() &gt; 25. &amp;&amp; fabs(jet-&gt;eta())&lt;2.5)
          {
            signalJets.push_back(jet);
            signalBJets.push_back(jet);
          }
        }

        for (const HEPUtils::Jet* jet : nonBJets)
        {
          if(jet-&gt;pT() &gt; 25. &amp;&amp; fabs(jet-&gt;eta())&lt;2.5)
          {
            signalJets.push_back(jet);
            signalNonBJets.push_back(jet);
          }
        }

        // Note that the isolation requirements and tight selection are currently missing

        for (const HEPUtils::Particle* electron : baselineElectrons)
        {
          signalSoftElectrons.push_back(electron);
          signalSoftLeptons.push_back(electron);
          if(electron-&gt;pT() &gt; 25.)
          {
            signalElectrons.push_back(electron);
            signalLeptons.push_back(electron);
          }
        }

        for (const HEPUtils::Particle* muon : baselineMuons)
        {
          signalSoftMuons.push_back(muon);
          signalSoftLeptons.push_back(muon);
          if(muon-&gt;pT() &gt; 25.)
          {
            signalMuons.push_back(muon);
            signalLeptons.push_back(muon);
          }
        }

        // We now have the signal electrons, muons, jets and b jets- move on to the analysis

        int nJets=signalJets.size();
        int nBJets = signalBJets.size();

        // Minimal event selection
        bool cut_minSelection=false;
        if((Met &gt; 100. &amp;&amp; (baselineElectrons.size()+baselineMuons.size()) == 1 &amp;&amp;
            ((signalSoftLeptons.size() == 1 || signalLeptons.size() == 1)) &amp;&amp; nJets &gt; 1)) cut_minSelection=true;

        vector&lt;const HEPUtils::Jet*&gt; mostBjetLike;
        vector&lt;const HEPUtils::Jet*&gt; signalNotBjetLike;
        vector&lt;const HEPUtils::Jet*&gt; signalNotBjet;

        // create containers with exactly 2 jets being considered to be b-jets and the inverse
        int bJet1 = -1, bJet2 = -1;

        for (unsigned int i = 0; i &lt; signalJets.size(); ++i)
        {
          if (!analysisBtags.at(signalJets[i])) continue;
          if (bJet1 == -1)
            bJet1 = i;
          else if (bJet2 == -1)
          {
            bJet2 = i;
            break;
          }
        }
        if (bJet2 == -1)
        {
          for (unsigned int i = 0; i &lt; signalJets.size(); ++i)
          {
            if (analysisBtags.at(signalJets[i])) continue;
            if (bJet1 == -1)
              bJet1 = i;
            else if (bJet2 == -1)
            {
              bJet2 = i;
              break;
            }
          }
        }

        if(signalJets.size()&gt;1)
        {
          mostBjetLike.push_back(signalJets.at(bJet1));
          mostBjetLike.push_back(signalJets.at(bJet2));
        }

        for (int i = 0; i &lt; (int)signalJets.size(); ++i)
        {
          if (!analysisBtags.at(signalJets[i])) signalNotBjet.push_back(signalJets.at(i));
          if (i == bJet1 || i == bJet2) continue;
          signalNotBjetLike.push_back(signalJets.at(i));
        }

        /* ensure object collections to be pT sorted */
        std::sort(signalJets.begin(), signalJets.end(), sortByPT_1l);
        //if (baseTaus.size() &gt; 0) sortObjectsByPt(baseTaus);

        // Now make a collection to hold the JER for each jet
        // Have obtained the values from Matthias' BuckFast code
        // https://atlas.web.cern.ch/Atlas/GROUPS/PHYSICS/CONFNOTES/ATLAS-CONF-2015-017/
        // Parameterisation can be still improved, but eta dependence is minimal
        const std::vector&lt;double&gt;  binedges_eta = {0,10.};
        const std::vector&lt;double&gt;  binedges_pt = {0,50.,70.,100.,150.,200.,1000.,10000.};
        const std::vector&lt;double&gt; JetsJER = {0.145,0.115,0.095,0.075,0.07,0.05,0.04};
        static HEPUtils::BinnedFn2D&lt;double&gt; _resJets2D(binedges_eta,binedges_pt,JetsJER);
        vector&lt;double&gt; signalJER;

        for(unsigned int i = 0; i &lt; signalJets.size(); ++i)signalJER.push_back(_resJets2D.get_at(signalJets[i]-&gt;abseta(), signalJets[i]-&gt;pT()));

        float sigmaAbsHtMiss = 0;
        float Ht = 0;
        /* calculate vecHtMiss */
        HEPUtils::P4 vecHtMiss;
        HEPUtils::P4 leptonHtMiss;

        bool preselLowMet=false;
        bool preselHighMet=false;
        double MetPerp = 0.;
        double HtSigMiss=0.;
        double absDPhiJMet0 = 0.;
        double absDPhiJMet1 = 0.;
        double absDPhiJiMet = 0.;
        double mT=0.;
        double topReclM=0.;
        double WReclM=0.;
        double amT2=0.;
        double dRbl=9999.;
        double mT2Tau=0.;
        double dPhiMetLep;
        double pTLepOverMet=999.;

        if(cut_minSelection)
        {

          for (unsigned int i = 0; i &lt; baselineLeptons.size(); ++i)
          {
            vecHtMiss    -= baselineLeptons[i]-&gt;mom();
            leptonHtMiss -= baselineLeptons[i]-&gt;mom();
          }

          for (unsigned int i = 0; i &lt; signalJets.size(); ++i)
            vecHtMiss -= signalJets[i]-&gt;mom();

          /* calculate Ht and HtSig */
          for (const HEPUtils::Jet* jet : signalJets) Ht += jet-&gt;pT();

          TRandom3 myRandom;
          myRandom.SetSeed(signalJets[0]-&gt;pT());

          int PEs = 100;
          // double smear_factor;
          double ETmissmean = 0, ETmissRMS = 0;
          for (int j = 0; j &lt; PEs; ++j)
          {
            double jetHtx = leptonHtMiss.px();
            double jetHty = leptonHtMiss.py();

            for (unsigned int i = 0; i &lt; signalJets.size(); ++i)
            {
              //std::normal_distribution&lt;&gt; dx(signalJets[i]-&gt;mom().px(), signalJets[i]-&gt;mom().px() * signalJER[i]);
              //std::normal_distribution&lt;&gt; dy(signalJets[i]-&gt;mom().py(), signalJets[i]-&gt;mom().px() * signalJER[i]);
              //jetHtx -= dx(Random::rng());
              //jetHty -= dy(Random::rng());
              jetHtx -= myRandom.Gaus(signalJets[i]-&gt;mom().px(), signalJets[i]-&gt;mom().px() * signalJER[i]);
              jetHty -= myRandom.Gaus(signalJets[i]-&gt;mom().py(), signalJets[i]-&gt;mom().px() * signalJER[i]);
            }
            double ETtemp = sqrt(jetHtx * jetHtx + jetHty * jetHty);
            ETmissmean += ETtemp;
            ETmissRMS  += ETtemp * ETtemp;
          }

          ETmissmean = ETmissmean / PEs;
          sigmaAbsHtMiss = sqrt((ETmissRMS / PEs) - ETmissmean * ETmissmean);

          HtSigMiss = (ETmissmean - 100.) / sigmaAbsHtMiss;

          double absDPhiJMet[4] = {fabs(signalJets[0]-&gt;mom().deltaPhi(metVec)), fabs(signalJets[1]-&gt;mom().deltaPhi(metVec)),
                 signalJets.size() &gt; 2 ? fabs(signalJets[2]-&gt;mom().deltaPhi(metVec)) : NAN,
                 signalJets.size() &gt; 3 ? fabs(signalJets[3]-&gt;mom().deltaPhi(metVec)) : NAN};

          if(nJets&gt;0)absDPhiJMet0 = absDPhiJMet[0];
          if(nJets&gt;1)absDPhiJMet1 = absDPhiJMet[1];

          for (int i = 1; i &lt; 4; i++)
            if (absDPhiJMet[i] &lt; absDPhiJiMet) absDPhiJiMet = absDPhiJMet[i];

          mT = calcMT_1l(baselineLeptons[0]-&gt;mom(), metVec);
          dPhiMetLep = fabs(metVec.deltaPhi(baselineLeptons[0]-&gt;mom()));

          // Calculate MT2 tau using the leading tau in the event
          mT2Tau = 120.;
          if(baselineTaus.size() &gt; 0)
          {
            double pa_tau[3] = { 0, baselineTaus[0]-&gt;mom().px(), baselineTaus[0]-&gt;mom().py() };
            double pb_tau[3] = { 0, baselineLeptons[0]-&gt;mom().px(), baselineLeptons[0]-&gt;mom().py() };
            double pmiss_tau[3] = { 0, metVec.px(), metVec.py() };
            double mn_tau = 0.;
            mt2_bisect::mt2 mt2_event_tau;
            mt2_event_tau.set_momenta(pa_tau,pb_tau,pmiss_tau);
            mt2_event_tau.set_mn(mn_tau);

            mT2Tau = mt2_event_tau.get_mt2();
          }

          pTLepOverMet = baselineLeptons[0]-&gt;pT() / Met;
          preselHighMet = Met &gt; 230 &amp;&amp; mT &gt; 30;
          preselLowMet  =  baselineLeptons[0]-&gt;pT() &gt; 27 &amp;&amp; signalBJets.size() &gt; 0 &amp;&amp; signalJets[0]-&gt;pT() &gt; 50. &amp;&amp; Met &gt; 100 &amp;&amp; mT &gt; 90;

          // Apply tight selection if lepton is an electron
          // Am using same selection as 8 TeV (probably needs updating)
          // Note that we have already applied a 1 lepton cut
          if (baselineElectrons.size()==1 &amp;&amp; baselineMuons.size()==0)
          {
            vector&lt;const HEPUtils::Particle*&gt; tightElectrons;
            tightElectrons.push_back(baselineElectrons[0]);
            ATLAS::applyTightIDElectronSelection(tightElectrons);
            preselLowMet = preselLowMet &amp;&amp; (tightElectrons.size()==1);
          }

          // Now calculate amT2 using two different assignments of the b jets and the leptons

          HEPUtils::P4 lepton_plus_bjet0;
          HEPUtils::P4 lepton_plus_bjet1;

          lepton_plus_bjet0 = baselineLeptons[0]-&gt;mom()+mostBjetLike[0]-&gt;mom();
          lepton_plus_bjet1 = baselineLeptons[0]-&gt;mom()+mostBjetLike[1]-&gt;mom();

          double pa_a[3] = { 0, lepton_plus_bjet0.px(), lepton_plus_bjet0.py() };
          double pb_a[3] = { 80, mostBjetLike[1]-&gt;mom().px(), mostBjetLike[1]-&gt;mom().py() };
          double pmiss_a[3] = { 0, metVec.px(), metVec.py() };
          double mn_a = 0.;

          mt2_bisect::mt2 mt2_event_a;

          mt2_event_a.set_momenta(pa_a,pb_a,pmiss_a);
          mt2_event_a.set_mn(mn_a);

          double mt2a = mt2_event_a.get_mt2();

          double pa_b[3] = { 0, lepton_plus_bjet1.px(), lepton_plus_bjet1.py() };
          double pb_b[3] = { 80, mostBjetLike[0]-&gt;mom().px(), mostBjetLike[0]-&gt;mom().py() };
          double pmiss_b[3] = { 0, metVec.px(), metVec.py() };
          double mn_b = 0.;

          mt2_bisect::mt2 mt2_event_b;

          mt2_event_b.set_momenta(pa_b,pb_b,pmiss_b);
          mt2_event_b.set_mn(mn_b);
          double mt2b = mt2_event_b.get_mt2();

          amT2 = std::min(mt2a,mt2b);
          dRbl = baselineLeptons[0]-&gt;mom().deltaR_eta(mostBjetLike[0]-&gt;mom());

          /* Reconstruct top by a chi2 based method */
          float mW = 80.;
          float mTop = 170.;
          float chi2min = 9e99;
          //AnalysisObject* topChi2 = new AnalysisObject(0., 0., 0., 0., 0, 0, AnalysisObjectType::JET, 0, 0);
          HEPUtils::P4 topChi2;
          int jetComb[3] = {0, 0, 0};
          vector&lt;double&gt; signalBJER;

          for(unsigned int i = 0; i &lt; mostBjetLike.size(); ++i)signalBJER.push_back(_resJets2D.get_at(mostBjetLike[i]-&gt;abseta(), mostBjetLike[i]-&gt;pT()));
          float f;

          for (int i = 0; i &lt; (int)signalJets.size(); ++i)
          {
            if (i == bJet1 || i == bJet2) continue;
            for (int j = i + 1; j &lt; (int)signalJets.size(); ++j)
            {
              if (j == bJet1 || j == bJet2) continue;
              for (unsigned int k = 0; k &lt; mostBjetLike.size() &amp;&amp; k &lt; 2; ++k)
              {
                f = pow((signalJets[i]-&gt;mom() + signalJets[j]-&gt;mom() + mostBjetLike[k]-&gt;mom()).m() - mTop, 2) /
                        (pow((signalJets[i]-&gt;mom() + signalJets[j]-&gt;mom() + mostBjetLike[k]-&gt;mom()).m(), 2) *
                        (pow(signalJER[i], 2) + pow(signalJER[j], 2) + pow(signalBJER[k], 2))) +
                         pow((signalJets[i]-&gt;mom() + signalJets[j]-&gt;mom()).m() - mW, 2) /
                        (pow((signalJets[i]-&gt;mom() + signalJets[j]-&gt;mom()).m(), 2) * (pow(signalJER[i], 2) + pow(signalJER[j], 2)));
                if (f &lt; chi2min)
                {
                  chi2min = f;
                  jetComb[0] = i;
                  jetComb[1] = j;
                  jetComb[2] = k;
                }
              }
            }
          }
          topChi2 = signalJets[jetComb[0]]-&gt;mom() + signalJets[jetComb[1]]-&gt;mom() + mostBjetLike[jetComb[2]]-&gt;mom();


          HEPUtils::P4 top1;
          top1 = baselineLeptons[0]-&gt;mom() + (jetComb[2] == 0 ? mostBjetLike[1]-&gt;mom() : mostBjetLike[0]-&gt;mom());

          /* calculate MetPerp */

          TLorentzVector ttbar;
          ttbar.SetPxPyPzE((topChi2 + top1).px(),(topChi2 + top1).py(),(topChi2 + top1).pz(),(topChi2 + top1).E());
          TLorentzVector top1Rest;
          top1Rest.SetPxPyPzE(top1.px(),top1.py(),top1.pz(),top1.E());
          TLorentzVector metRest;
          metRest.SetPxPyPzE(metVec.px(),metVec.py(),metVec.pz(),metVec.E());


          ttbar.Boost(-ttbar.Px() / ttbar.E(), -ttbar.Py() / ttbar.E(), -ttbar.Pz() / ttbar.E());


          top1Rest.Boost(-ttbar.Px() / ttbar.E(), -ttbar.Py() / ttbar.E(), -ttbar.Pz() / ttbar.E());
          metRest.Boost(-ttbar.Px() / ttbar.E(), -ttbar.Py() / ttbar.E(), -ttbar.Pz() / ttbar.E());
          MetPerp = metRest.Vect().XYvector().Norm(top1Rest.Vect().XYvector()).Mod();

          // Now we have to do the fancy jet reclustering to get reconstructed W and top particles

          HEPUtils::P4 WRecl = reclusteredParticle(signalNotBjet, mostBjetLike, mW, false); //signalNotBjet+mostBjetLike is inconsistent but bjets are not used anyway
          HEPUtils::P4 topRecl = reclusteredParticle(signalNotBjetLike, mostBjetLike, 175., true);

          topReclM=0;

          if (nBJets &gt; 0 &amp;&amp; nJets &gt; 3 &amp;&amp; preselHighMet)topReclM=topRecl.m();
          WReclM = WRecl.m();

        }

        // Should now be ready to do signal selections

        bool is_tN_med=false;
        bool is_tN_high=false;
        bool is_bWN=false;
        bool is_bC2x_diag=false;
        bool is_bC2x_med=false;
        bool is_bCbv=false;
        // bool is_DM_low_loose=false;  // &lt;-- We currently don't use this
        bool is_DM_low=false;
        bool is_DM_high=false;

        bool is_bffN=false;
        bool is_bCsoft_diag=false;
        bool is_bCsoft_med=false;
        bool is_bCsoft_high=false;

        // non-soft lepton selections
        if (signalLeptons.size() == 1)
        {
          //tN_med
          if (nJets &gt; 3 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselLowMet &amp;&amp; signalJets[0]-&gt;pT() &gt; 60 &amp;&amp; signalJets[1]-&gt;pT() &gt; 50 &amp;&amp;
              signalJets[3]-&gt;pT() &gt; 40 &amp;&amp; Met &gt; 250 &amp;&amp; MetPerp &gt; 230 &amp;&amp; HtSigMiss &gt; 14 &amp;&amp; mT &gt; 160 &amp;&amp; amT2 &gt; 175 &amp;&amp;
              topReclM &gt; 150 &amp;&amp; dRbl &lt; 2.0 &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80)
            is_tN_med=true;

          //tN_high
          if (nJets &gt; 3 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselHighMet &amp;&amp; signalJets[0]-&gt;pT() &gt; 100 &amp;&amp; signalJets[1]-&gt;pT() &gt; 80 &amp;&amp;
              signalJets[2]-&gt;pT() &gt; 50 &amp;&amp; signalJets[3]-&gt;pT() &gt; 30 &amp;&amp; Met &gt; 550 &amp;&amp; HtSigMiss &gt; 27 &amp;&amp; mT &gt; 160 &amp;&amp;
              amT2 &gt; 175 &amp;&amp; topReclM &gt; 130 &amp;&amp; dRbl &lt; 2.0 &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp;
              mT2Tau &gt; 80)
            is_tN_high=true;

          //bWN
          if (nJets &gt; 3 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselHighMet &amp;&amp; signalJets[0]-&gt;pT() &gt; 50 &amp;&amp; Met &gt; 300 &amp;&amp; mT &gt; 130 &amp;&amp;
              amT2 &lt; 110 &amp;&amp; dPhiMetLep &lt; 2.5 &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80)
            is_bWN=true;

          //bC2x_diag
          if (nJets &gt; 3 &amp;&amp; nBJets &gt; 1 &amp;&amp; preselHighMet &amp;&amp; signalJets[2]-&gt;pT() &gt; 75 &amp;&amp; signalJets[3]-&gt;pT() &gt; 30 &amp;&amp;
              signalBJets[1]-&gt;pT() &gt; 30 &amp;&amp; Met &gt; 230 &amp;&amp; HtSigMiss &gt; 13 &amp;&amp; mT &gt; 180 &amp;&amp; amT2 &gt; 175 &amp;&amp;
              absDPhiJMet0 &gt; 0.7 &amp;&amp; absDPhiJMet1 &gt; 0.7 &amp;&amp; WReclM &gt; 50 &amp;&amp; mT2Tau &gt; 80)
            is_bC2x_diag=true;

          //bC2x_med
          if (nJets &gt; 3 &amp;&amp; nBJets &gt; 1 &amp;&amp; preselHighMet &amp;&amp; signalJets[0]-&gt;pT() &gt; 200 &amp;&amp; signalJets[1]-&gt;pT() &gt; 140 &amp;&amp;
              signalBJets[1]-&gt;pT() &gt; 140 &amp;&amp; Met &gt; 230 &amp;&amp; HtSigMiss &gt; 10 &amp;&amp; mT &gt; 120 &amp;&amp; amT2 &gt; 300 &amp;&amp;
              absDPhiJMet0 &gt; 0.9 &amp;&amp; absDPhiJMet1 &gt; 0.9 &amp;&amp; WReclM &gt; 50 &amp;&amp; mT2Tau &gt; 80)
            is_bC2x_med=true;

          //bCbv
          if (nJets &gt; 1 &amp;&amp; nBJets == 0 &amp;&amp; preselHighMet &amp;&amp; signalJets[0]-&gt;pT() &gt; 120 &amp;&amp; signalJets[1]-&gt;pT() &gt; 80 &amp;&amp;
              Met &gt; 360 &amp;&amp; HtSigMiss &gt; 16 &amp;&amp; mT &gt; 200 &amp;&amp; absDPhiJMet0 &gt; 2.0 &amp;&amp; absDPhiJMet1 &gt; 0.8 &amp;&amp;
              WReclM &gt;= 70 &amp;&amp; WReclM &lt;= 100 &amp;&amp; dPhiMetLep &gt; 1.2 &amp;&amp; baselineLeptons[0]-&gt;pT() &gt; 60)
            is_bCbv=true;

          // We currently don't use this.
          // //DM_low_loose
          // if (nJets &gt; 3 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselHighMet &amp;&amp; signalJets[1]-&gt;pT() &gt; 60 &amp;&amp; signalJets[2]-&gt;pT() &gt; 40 &amp;&amp;
          //     Met &gt; 300 &amp;&amp; mT &gt; 120 &amp;&amp; HtSigMiss &gt; 14 &amp;&amp; amT2 &gt; 140 &amp;&amp; dPhiMetLep &gt; 0.8 &amp;&amp; absDPhiJiMet &gt; 1.4)
          //   is_DM_low_loose=true;

          //DM_low
          if (nJets &gt; 3 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselHighMet &amp;&amp; signalJets[0]-&gt;pT() &gt; 120 &amp;&amp; signalJets[1]-&gt;pT() &gt; 85 &amp;&amp;
              signalJets[2]-&gt;pT() &gt; 65 &amp;&amp; signalBJets[0]-&gt;pT() &gt; 60 &amp;&amp; Met &gt; 320 &amp;&amp; mT &gt; 170 &amp;&amp; HtSigMiss &gt; 14 &amp;&amp;
              amT2 &gt; 160 &amp;&amp; topReclM &gt; 130 &amp;&amp; dPhiMetLep &gt; 1.2 &amp;&amp; absDPhiJiMet &gt; 1.0 &amp;&amp; mT2Tau &gt; 80)
            is_DM_low=true;

          //DM_high
          if (nJets &gt; 3 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselHighMet &amp;&amp; signalJets[0]-&gt;pT() &gt; 125 &amp;&amp; signalJets[1]-&gt;pT() &gt; 75 &amp;&amp;
              signalJets[2]-&gt;pT() &gt; 65 &amp;&amp; Met &gt; 380 &amp;&amp; mT &gt; 225 &amp;&amp; amT2 &gt; 190 &amp;&amp; topReclM &gt; 130 &amp;&amp;
              dPhiMetLep &gt; 1.2 &amp;&amp; absDPhiJiMet &gt; 1.0)
            is_DM_high=true;
        }

        // Soft-lepton selections
        bool preselSoftLep=false;
        double Wpt = 0.;

        double minDPhiMetBJet = 99999.;
        for(size_t i=0;i&lt;signalBJets.size();i++)
        {
          double dPhi_tmp = fabs(signalBJets[i]-&gt;mom().deltaPhi(metVec));
          if(dPhi_tmp&lt;minDPhiMetBJet)minDPhiMetBJet=dPhi_tmp;
        }

        double dRbb=0;
        if(nBJets&gt;1)dRbb=mostBjetLike[0]-&gt;mom().deltaR_eta(mostBjetLike[1]-&gt;mom());


        if (signalSoftLeptons.size() == 1)
        {
          preselSoftLep = Met &gt; 230;

          // Apply tight selection if lepton is an electron
          // Am using same selection as 8 TeV (probably needs updating)
          // Note that we have already applied a 1 lepton cut
          if (signalSoftElectrons.size()==1 &amp;&amp; signalSoftMuons.size()==0)
          {
            vector&lt;const HEPUtils::Particle*&gt; tightElectrons;
            tightElectrons.push_back(signalSoftElectrons[0]);
            ATLAS::applyTightIDElectronSelection(tightElectrons);
            preselSoftLep = preselSoftLep &amp;&amp; (tightElectrons.size()==1);
          }

          Wpt = (signalSoftLeptons[0]-&gt;mom()+metVec).pT();
        }

        //bffN
        if (nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; signalJets[0]-&gt;pT() &gt; 400 &amp;&amp; Met &gt; 300 &amp;&amp; mT &lt; 160 &amp;&amp;
            pTLepOverMet &lt; 0.02 &amp;&amp; minDPhiMetBJet &lt; 1.5 &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp;
            topReclM &lt; 150 &amp;&amp; !analysisBtags.at(signalJets[0]))is_bffN=true;

        //bCsoft_diag
        if (nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; signalJets[0]-&gt;pT() &gt; 400 &amp;&amp; Met &gt; 300 &amp;&amp; mT &lt; 50 &amp;&amp;
            pTLepOverMet &lt; 0.02 &amp;&amp; minDPhiMetBJet &lt; 1.5 &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp;
            topReclM &lt; 150 &amp;&amp; !analysisBtags.at(signalJets[0]))is_bCsoft_diag=true;

        //bCsoft_med
        if (nJets &gt; 2 &amp;&amp; nBJets &gt; 1 &amp;&amp; preselSoftLep &amp;&amp; signalJets[0]-&gt;pT() &gt; 120 &amp;&amp; signalJets[1]-&gt;pT() &gt; 60 &amp;&amp;
            signalJets[2]-&gt;pT() &gt; 40 &amp;&amp; signalBJets[0]-&gt;pT() &gt; 120 &amp;&amp; signalBJets[1]-&gt;pT() &gt; 60 &amp;&amp; Met &gt; 230 &amp;&amp;
            mT &lt; 160 &amp;&amp; pTLepOverMet &lt; 0.03 &amp;&amp; amT2 &gt; 200 &amp;&amp; minDPhiMetBJet &gt; 0.8 &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp;
            absDPhiJMet1 &gt; 0.4 &amp;&amp; Wpt &gt; 400)is_bCsoft_med=true;

        //bCsoft_high
        if (nJets &gt; 1 &amp;&amp; nBJets &gt; 1 &amp;&amp; preselSoftLep &amp;&amp; signalJets[1]-&gt;pT() &gt; 100 &amp;&amp; signalBJets[1]-&gt;pT() &gt; 100 &amp;&amp;
            Met &gt; 230 &amp;&amp; mT &lt; 160 &amp;&amp; pTLepOverMet &lt; 0.03 &amp;&amp; amT2 &gt; 300 &amp;&amp; minDPhiMetBJet &gt; 0.4 &amp;&amp;
            absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; Wpt &gt; 500 &amp;&amp; dRbb &gt; 0.8)is_bCsoft_high=true;

        //bool isSRD_high=false;

        cutFlowVector_str[0] = &quot;No cuts &quot;;
        cutFlowVector_str[1] = &quot;Derivation skim&quot;;
        cutFlowVector_str[2] = &quot;&gt;=1 baseline lepton &quot;;
        cutFlowVector_str[3] = &quot;&gt;=1 signal lepton &quot;;
        cutFlowVector_str[4] = &quot;==1 signal lepton &quot;;
        cutFlowVector_str[5] = &quot;==1 baseline lepton &quot;;
        cutFlowVector_str[6] = &quot;XE trigger, &gt;=4 jets, met &gt; 230 GeV &quot;;
        cutFlowVector_str[7] = &quot;deltaPhi(j1,met) &gt; 0.4 &quot;;
        cutFlowVector_str[8] = &quot;deltaPhi(j2,met) &gt; 0.4 &quot;;
        cutFlowVector_str[9] = &quot;mT2tau &gt; 80 GeV &quot;;
        cutFlowVector_str[10] = &quot;tN_med: j0 pT &gt; 60 GeV&quot;;
        cutFlowVector_str[11] = &quot;tN_med: j1 pT &gt; 50 GeV&quot;;
        cutFlowVector_str[12] = &quot;tN_med: j2 pT &gt; 40 GeV &quot;;
        cutFlowVector_str[13] = &quot;tN_med: j3 pT &gt; 40 GeV &quot;;
        cutFlowVector_str[14] = &quot;tN_med: met &gt; 250 GeV &quot;;
        cutFlowVector_str[15] = &quot;tN_med: metPerp &gt; 230 GeV&quot;;
        cutFlowVector_str[16] = &quot;tN_med: HTmissSig &gt; 14 &quot;;
        cutFlowVector_str[17] = &quot;tN_med: mT &gt; 160 GeV&quot;;
        cutFlowVector_str[18] = &quot;tN_med: amt2 &gt; 175 GeV&quot;;
        cutFlowVector_str[19] = &quot;tN_med: &gt;=1 b jet &quot;;
        cutFlowVector_str[20] = &quot;tN_med: deltaR(b,l) &lt; 2.0&quot;;
        cutFlowVector_str[21] = &quot;tN_med: mtop_recl &gt; 150 GeV&quot;;
        cutFlowVector_str[22] = &quot;tN_high: j0 pT &gt; 100 GeV &quot;;
        cutFlowVector_str[23] = &quot;tN_high: j1 pT &gt; 80 GeV &quot;;
        cutFlowVector_str[24] = &quot;tN_high: j2 pT &gt; 50 GeV&quot;;
        cutFlowVector_str[25] = &quot;tN_high: j3 pT &gt; 30 GeV&quot;;
        cutFlowVector_str[26] = &quot;tN_high: met &gt; 550 GeV &quot;;
        cutFlowVector_str[27] = &quot;tN_high: HTmissSig &gt; 27&quot;;
        cutFlowVector_str[28] = &quot;tN_high: mT &gt; 160 GeV &quot;;
        cutFlowVector_str[29] = &quot;tN_high: amT2 &gt; 175 GeV &quot;;
        cutFlowVector_str[30] = &quot;tN_high: &gt;= 1 b jet&quot;;
        cutFlowVector_str[31] = &quot;tN_high: deltaR(b,l) &lt; 2.0&quot;;
        cutFlowVector_str[32] = &quot;tN_high: mtop_recl &gt; 130 GeV&quot;;
        cutFlowVector_str[33] = &quot;bWN: jet0 pT &gt; 50 GeV&quot;;
        cutFlowVector_str[34] = &quot;bWN: Met &gt; 300 GeV &quot;;
        cutFlowVector_str[35] = &quot;bWN: mT &gt; 130 GeV&quot;;
        cutFlowVector_str[36] = &quot;bWN: amT2 &lt; 110 GeV&quot;;
        cutFlowVector_str[37] = &quot;bWN: &gt;=1 b jet&quot;;
        cutFlowVector_str[38] = &quot;bWN: deltaPhi(l,ptmiss) &lt; 2.5&quot;;
        cutFlowVector_str[39] = &quot;bffN: Soft lepton preselection&quot;;
        cutFlowVector_str[40] = &quot;bffN: Met &gt; 300 GeV&quot;;
        cutFlowVector_str[41] = &quot;bffN: jet0 pT &gt; 400 GeV&quot;;
        cutFlowVector_str[42] = &quot;bffN: mT &lt; 160 GeV&quot;;
        cutFlowVector_str[43] = &quot;bffN: leading jet not b-tagged&quot;;
        cutFlowVector_str[44] = &quot;bffN: min(DPhi(ptmiss, b-jet)) &lt; 1.5&quot;;
        cutFlowVector_str[45] = &quot;bffN: pTl/Met &lt; 0.05 &quot;;
        cutFlowVector_str[46] = &quot;bffN: top veto (or mtop_recl &lt; 150 GeV) &quot;;
        cutFlowVector_str[47] = &quot;bffN: pTl/met &lt; 0.02 &quot;;
        cutFlowVector_str[48] = &quot;bC2x_diag: jet0 pT &gt; 75 GeV&quot;;
        cutFlowVector_str[49] = &quot;bC2x_diag: jet2 pT &gt; 75 GeV &quot;;
        cutFlowVector_str[50] = &quot;bC2x_diag: jet3 pT &gt; 75 GeV &quot;;
        cutFlowVector_str[51] = &quot;bC2x_diag: jet4 pT &gt; 30 GeC &quot;;
        cutFlowVector_str[52] = &quot;bC2x_diag: &gt;=2 b jet &quot;;
        cutFlowVector_str[53] = &quot;bC2x_diag: bjet1 pT &gt; 30 GeV &quot;;
        cutFlowVector_str[54] = &quot;bC2x_diag: dPhi(j1,ptmiss) &gt; 0.7 &quot;;
        cutFlowVector_str[55] = &quot;bC2x_diag: dPhi(j2,ptmiss) &gt; 0.7 &quot;;
        cutFlowVector_str[56] = &quot;bC2x_diag: HTmissSig &gt; 13 &quot;;
        cutFlowVector_str[57] = &quot;bC2x_diag: mT &gt; 180 GeV &quot;;
        cutFlowVector_str[58] = &quot;bC2x_diag: amT2 &gt; 175 GeV &quot;;
        cutFlowVector_str[59] = &quot;bC2x_diag: mWrecl &gt; 50 GeV &quot;;
        cutFlowVector_str[60] = &quot;bC2x_med: jet0 pT &gt; 200 GeV &quot;;
        cutFlowVector_str[61] = &quot;bC2x_med: jet1 pT &gt; 140 GeV &quot;;
        cutFlowVector_str[62] = &quot;bC2x_med: &gt;=2 b jet &quot;;
        cutFlowVector_str[63] = &quot;bC2x_med: bjet0 pT &gt; 140 GeV &quot;;
        cutFlowVector_str[64] = &quot;bC2x_med: bjet1 pT &gt; 140 GeV&quot;;
        cutFlowVector_str[65] = &quot;bC2x_med: dPhi(j1,ptmiss) &gt; 0.9 &quot;;
        cutFlowVector_str[66] = &quot;bC2x_med: dPhi(j2,ptmiss) &gt; 0.9 &quot; ;
        cutFlowVector_str[67] = &quot;bC2x_med: HTmissSig &gt; 10&quot;;
        cutFlowVector_str[68] = &quot;bC2x_med: mT &gt; 120 GeV&quot;;
        cutFlowVector_str[69] = &quot;bC2x_med: amT2 &gt; 300 GeV &quot;;
        cutFlowVector_str[70] = &quot;bC2x_med: mWrecl &gt; 50 GeV &quot;;
        cutFlowVector_str[71] = &quot;bCbv: jet0 pT &gt; 120 GeV&quot;;
        cutFlowVector_str[72] = &quot;bCbv: jet1 pT &gt; 80 GeV &quot;;
        cutFlowVector_str[73] = &quot;bCbv: ==0 b jets &quot;;
        cutFlowVector_str[74] = &quot;bCbv: lepton pt &gt; 60 GeV &quot;;
        cutFlowVector_str[75] = &quot;bCbv: dPhi(j1,ptmiss) &gt; 2.0 &quot;;
        cutFlowVector_str[76] = &quot;bCbv: dPhi(j2,ptmiss) &gt; 0.8 &quot;;
        cutFlowVector_str[77] = &quot;bCbv: Met &gt; 360 GeV &quot;;
        cutFlowVector_str[78] = &quot;bCbv: HtmissSig &gt; 16&quot;;
        cutFlowVector_str[79] = &quot;bCbv: mT &gt; 200 GeV&quot;;
        cutFlowVector_str[80] = &quot;bCbv: mWrecl in [70,100] GeV&quot;;
        cutFlowVector_str[81] = &quot;bCbv: dPhi(l,ptmiss) &gt; 1.2&quot;;
        cutFlowVector_str[82] = &quot;bCsoft_diag: Soft lepton preselection&quot;;
        cutFlowVector_str[83] = &quot;bCsoft_diag: Met &gt; 300 GeV&quot;;
        cutFlowVector_str[84] = &quot;bCsoft_diag: jet0 pT &gt; 400 GeV &quot;;
        cutFlowVector_str[85] = &quot;bCsoft_diag: mT &lt; 160 GeV &quot;;
        cutFlowVector_str[86] = &quot;bCsoft_diag: leading jet not b-tagged &quot;;
        cutFlowVector_str[87] = &quot;bCsoft_diag: mT &lt; 50 GeV &quot;;
        cutFlowVector_str[88] = &quot;bCsoft_diag: min(dPhi(ptmiss, b-jet)) &lt; 1.5 &quot;;
        cutFlowVector_str[89] = &quot;bCsoft_diag: pTl/Met &lt; 0.05 &quot;;
        cutFlowVector_str[90] = &quot;bCsoft_diag: top veto (or mtop_recl &lt; 150 GeV) &quot;;
        cutFlowVector_str[91] = &quot;bCsoft_diag: pTl/Met &lt; 0.02&quot;;
        cutFlowVector_str[92] = &quot;bCsoft_med: Soft lepton preselection &quot;;
        cutFlowVector_str[93] = &quot;bCsoft_med: &gt;=3 jets&quot;;
        cutFlowVector_str[94] = &quot;bCsoft_med: pTW &gt; 400 GeV&quot;;
        cutFlowVector_str[95] = &quot;bCsoft_med: jet0 pT &gt; 120 GeV&quot;;
        cutFlowVector_str[96] = &quot;bCsoft_med: jet1 pT &gt; 60 GeV&quot;;
        cutFlowVector_str[97] = &quot;bCsoft_med: jet2 pT &gt; 40 GeV&quot;;
        cutFlowVector_str[98] = &quot;bCsoft_med: mT &lt; 160 GeV&quot;;
        cutFlowVector_str[99] = &quot;bCsoft_med: amT2 &gt; 200 GeV&quot;;
        cutFlowVector_str[100] = &quot;bCsoft_med: &gt;=2 b jet&quot;;
        cutFlowVector_str[101] = &quot;bCsoft_med: bjet0 pT &gt; 120 GeV &quot;;
        cutFlowVector_str[102] = &quot;bCsoft_med: bjet1 pT &gt; 60 GeV&quot;;
        cutFlowVector_str[103] = &quot;bCsoft_med: min(dPhi(ptmiss, b-jet)) &gt; 0.8 &quot;;
        cutFlowVector_str[104] = &quot;bCsoft_med: pTl/Met &lt; 0.1&quot;;
        cutFlowVector_str[105] = &quot;bCsoft_med: pTl/Met &lt; 0.03&quot;;
        cutFlowVector_str[106] = &quot;bCsoft_high: XE trigger, &gt;=2 jets, Met &gt; 230 GeV&quot;;
        cutFlowVector_str[107] = &quot;bCsoft_high: dPhi(j1,ptmiss) &gt; 0.4&quot;;
        cutFlowVector_str[108] = &quot;bCsoft_high: dPhi(j2,ptmiss) &gt; 0.4&quot;;
        cutFlowVector_str[109] = &quot;bCsoft_high: jet0 pt &gt; 100 GeV&quot;;
        cutFlowVector_str[110] = &quot;bCsoft_high: jet1 pt &gt; 100 GeV&quot;;
        cutFlowVector_str[111] = &quot;bCsoft_high: mT &lt; 160 GeV&quot;;
        cutFlowVector_str[112] = &quot;bCsoft_high: pTW &gt; 500 GeV&quot;;
        cutFlowVector_str[113] = &quot;bCsoft_high: dRbb &gt; 0.8&quot;;
        cutFlowVector_str[114] = &quot;bCsoft_high: min(dPhi(ptmiss, b-jet))&quot;;
        cutFlowVector_str[115] = &quot;bCsoft_high: &gt;=2 b jet&quot;;
        cutFlowVector_str[116] = &quot;bCsoft_high: bjet0 pT &gt; 100 GeV&quot;;
        cutFlowVector_str[117] = &quot;bCsoft_high: bjet1 pT &gt; 100 GeV&quot;;
        cutFlowVector_str[118] = &quot;bCsoft_high: amT2 &gt; 300 GeV&quot;;

        for(int j=0;j&lt;NCUTS;j++)
        {
          if(
             (j==0) ||

             (j==1 ) ||

             (j==2 &amp;&amp; baselineLeptons.size()&gt;0) ||

             (j==3 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0) ||

             (j==4 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1) ||

             (j==5 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1) ||

             (j==6 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230.) ||

             (j==7 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4) ||

             (j==8 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4) ||

             (j==9 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80) ||

             //tN_med cutflow

             (j==10 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 60 ) ||

             (j==11 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 60 &amp;&amp; signalJets[1]-&gt;pT() &gt; 60) ||

             (j==12 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 60 &amp;&amp; signalJets[1]-&gt;pT() &gt; 60 &amp;&amp;  signalJets[2]-&gt;pT() &gt; 40) ||

             (j==13 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 60 &amp;&amp; signalJets[1]-&gt;pT() &gt; 60 &amp;&amp;  signalJets[2]-&gt;pT() &gt; 40 &amp;&amp; signalJets[3]-&gt;pT() &gt; 40) ||

             (j==14 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 60 &amp;&amp; signalJets[1]-&gt;pT() &gt; 60 &amp;&amp;  signalJets[2]-&gt;pT() &gt; 40 &amp;&amp; signalJets[3]-&gt;pT() &gt; 40 &amp;&amp; Met &gt; 250.) ||

             (j==15 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 60 &amp;&amp; signalJets[1]-&gt;pT() &gt; 60 &amp;&amp;  signalJets[2]-&gt;pT() &gt; 40 &amp;&amp; signalJets[3]-&gt;pT() &gt; 40 &amp;&amp; Met &gt; 250. &amp;&amp; MetPerp &gt; 230) ||

             (j==16 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 60 &amp;&amp; signalJets[1]-&gt;pT() &gt; 60 &amp;&amp;  signalJets[2]-&gt;pT() &gt; 40 &amp;&amp; signalJets[3]-&gt;pT() &gt; 40 &amp;&amp; Met &gt; 250. &amp;&amp; MetPerp &gt; 230 &amp;&amp; HtSigMiss &gt; 14) ||

             (j==17 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 60 &amp;&amp; signalJets[1]-&gt;pT() &gt; 60 &amp;&amp;  signalJets[2]-&gt;pT() &gt; 40 &amp;&amp; signalJets[3]-&gt;pT() &gt; 40 &amp;&amp; Met &gt; 250. &amp;&amp; MetPerp &gt; 230 &amp;&amp; HtSigMiss &gt; 14 &amp;&amp; mT &gt; 160) ||

             (j==18 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 60 &amp;&amp; signalJets[1]-&gt;pT() &gt; 60 &amp;&amp;  signalJets[2]-&gt;pT() &gt; 40 &amp;&amp; signalJets[3]-&gt;pT() &gt; 40 &amp;&amp; Met &gt; 250. &amp;&amp; MetPerp &gt; 230 &amp;&amp; HtSigMiss &gt; 14 &amp;&amp; mT &gt; 160 &amp;&amp; amT2 &gt; 175) ||

             (j==19 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 60 &amp;&amp; signalJets[1]-&gt;pT() &gt; 60 &amp;&amp;  signalJets[2]-&gt;pT() &gt; 40 &amp;&amp; signalJets[3]-&gt;pT() &gt; 40 &amp;&amp; Met &gt; 250. &amp;&amp; MetPerp &gt; 230 &amp;&amp; HtSigMiss &gt; 14 &amp;&amp; mT &gt; 160 &amp;&amp; amT2 &gt; 175 &amp;&amp; nBJets &gt;=1) ||

             (j==20 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 60 &amp;&amp; signalJets[1]-&gt;pT() &gt; 60 &amp;&amp;  signalJets[2]-&gt;pT() &gt; 40 &amp;&amp; signalJets[3]-&gt;pT() &gt; 40 &amp;&amp; Met &gt; 250. &amp;&amp; MetPerp &gt; 230 &amp;&amp; HtSigMiss &gt; 14 &amp;&amp; mT &gt; 160 &amp;&amp; amT2 &gt; 175 &amp;&amp; nBJets &gt;=1 &amp;&amp;  dRbl &lt; 2.0) ||

             (j==21 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 60 &amp;&amp; signalJets[1]-&gt;pT() &gt; 60 &amp;&amp;  signalJets[2]-&gt;pT() &gt; 40 &amp;&amp; signalJets[3]-&gt;pT() &gt; 40 &amp;&amp; Met &gt; 250. &amp;&amp; MetPerp &gt; 230 &amp;&amp; HtSigMiss &gt; 14 &amp;&amp; mT &gt; 160 &amp;&amp; amT2 &gt; 175 &amp;&amp; nBJets &gt;=1 &amp;&amp;  dRbl &lt; 2.0 &amp;&amp; topReclM &gt; 150) ||

             // tN_high cutflow

             (j==22 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 100) ||

             (j==23 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 100 &amp;&amp; signalJets[1]-&gt;pT() &gt; 80) ||

             (j==24 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 100 &amp;&amp; signalJets[1]-&gt;pT() &gt; 80 &amp;&amp; signalJets[2]-&gt;pT() &gt; 50) ||

             (j==25 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 100 &amp;&amp; signalJets[1]-&gt;pT() &gt; 80 &amp;&amp; signalJets[2]-&gt;pT() &gt; 50 &amp;&amp; signalJets[3]-&gt;pT() &gt; 30) ||

             (j==26 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 100 &amp;&amp; signalJets[1]-&gt;pT() &gt; 80 &amp;&amp; signalJets[2]-&gt;pT() &gt; 50 &amp;&amp; signalJets[3]-&gt;pT() &gt; 30 &amp;&amp; Met &gt; 550.) ||

             (j==27 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 100 &amp;&amp; signalJets[1]-&gt;pT() &gt; 80 &amp;&amp; signalJets[2]-&gt;pT() &gt; 50 &amp;&amp; signalJets[3]-&gt;pT() &gt; 30 &amp;&amp; Met &gt; 550. &amp;&amp;  HtSigMiss &gt; 27) ||

             (j==28 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 100 &amp;&amp; signalJets[1]-&gt;pT() &gt; 80 &amp;&amp; signalJets[2]-&gt;pT() &gt; 50 &amp;&amp; signalJets[3]-&gt;pT() &gt; 30 &amp;&amp; Met &gt; 550. &amp;&amp;  HtSigMiss &gt; 27 &amp;&amp; mT &gt; 160) ||

             (j==29 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 100 &amp;&amp; signalJets[1]-&gt;pT() &gt; 80 &amp;&amp; signalJets[2]-&gt;pT() &gt; 50 &amp;&amp; signalJets[3]-&gt;pT() &gt; 30 &amp;&amp; Met &gt; 550. &amp;&amp;  HtSigMiss &gt; 27 &amp;&amp; mT &gt; 160 &amp;&amp; amT2 &gt; 175.) ||

             (j==30 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 100 &amp;&amp; signalJets[1]-&gt;pT() &gt; 80 &amp;&amp; signalJets[2]-&gt;pT() &gt; 50 &amp;&amp; signalJets[3]-&gt;pT() &gt; 30 &amp;&amp; Met &gt; 550. &amp;&amp;  HtSigMiss &gt; 27 &amp;&amp; mT &gt; 160 &amp;&amp; amT2 &gt; 175. &amp;&amp; nBJets &gt;=1) ||

             (j==31 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 100 &amp;&amp; signalJets[1]-&gt;pT() &gt; 80 &amp;&amp; signalJets[2]-&gt;pT() &gt; 50 &amp;&amp; signalJets[3]-&gt;pT() &gt; 30 &amp;&amp; Met &gt; 550. &amp;&amp;  HtSigMiss &gt; 27 &amp;&amp; mT &gt; 160 &amp;&amp; amT2 &gt; 175. &amp;&amp; nBJets &gt;=1 &amp;&amp; dRbl &lt; 2.0) ||

             (j==32 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 100 &amp;&amp; signalJets[1]-&gt;pT() &gt; 80 &amp;&amp; signalJets[2]-&gt;pT() &gt; 50 &amp;&amp; signalJets[3]-&gt;pT() &gt; 30 &amp;&amp; Met &gt; 550. &amp;&amp;  HtSigMiss &gt; 27 &amp;&amp; mT &gt; 160 &amp;&amp; amT2 &gt; 175. &amp;&amp; nBJets &gt;=1 &amp;&amp; dRbl &lt; 2.0 &amp;&amp; topReclM &gt; 130.) ||

             // bWN cutflow

             (j==33 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 50.) ||

             (j==34 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 50. &amp;&amp; Met &gt; 300) ||

             (j==35 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 50. &amp;&amp; Met &gt; 300 &amp;&amp; mT &gt; 130) ||

             (j==36 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 50. &amp;&amp; Met &gt; 300 &amp;&amp; mT &gt; 130 &amp;&amp; amT2 &lt; 110) ||

             (j==37 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 50. &amp;&amp; Met &gt; 300 &amp;&amp; mT &gt; 130 &amp;&amp; amT2 &lt; 110 &amp;&amp; nBJets&gt;=1) ||

             (j==38 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 50. &amp;&amp; Met &gt; 300 &amp;&amp; mT &gt; 130 &amp;&amp; amT2 &lt; 110 &amp;&amp; nBJets&gt;=1 &amp;&amp; dPhiMetLep &lt; 2.5 ) ||

             // bffN cutflow

             (j==39 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep) ||

             (j==40 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; Met &gt; 300.) ||

             (j==41 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; Met &gt; 300. &amp;&amp; nJets &gt; 0 &amp;&amp; signalJets[0]-&gt;pT() &gt; 400.) ||

             (j==42 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; Met &gt; 300. &amp;&amp; nJets &gt; 0 &amp;&amp; signalJets[0]-&gt;pT() &gt; 400. &amp;&amp; mT &lt; 160.) ||

             (j==43 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; Met &gt; 300. &amp;&amp; nJets &gt; 0 &amp;&amp; signalJets[0]-&gt;pT() &gt; 400. &amp;&amp; mT &lt; 160. &amp;&amp;  !analysisBtags.at(signalJets[0])) ||

             (j==44 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; Met &gt; 300. &amp;&amp; nJets &gt; 0 &amp;&amp; signalJets[0]-&gt;pT() &gt; 400. &amp;&amp; mT &lt; 160. &amp;&amp;  !analysisBtags.at(signalJets[0]) &amp;&amp; minDPhiMetBJet &lt; 1.5) ||

             (j==45 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; Met &gt; 300. &amp;&amp; nJets &gt; 0 &amp;&amp; signalJets[0]-&gt;pT() &gt; 400. &amp;&amp; mT &lt; 160. &amp;&amp;  !analysisBtags.at(signalJets[0]) &amp;&amp; minDPhiMetBJet &lt; 1.5 &amp;&amp; pTLepOverMet &lt; 0.05) ||

             (j==46 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; Met &gt; 300. &amp;&amp; nJets &gt; 0 &amp;&amp; signalJets[0]-&gt;pT() &gt; 400. &amp;&amp; mT &lt; 160. &amp;&amp;  !analysisBtags.at(signalJets[0]) &amp;&amp; minDPhiMetBJet &lt; 1.5 &amp;&amp; pTLepOverMet &lt; 0.05 &amp;&amp; topReclM &lt; 150) ||

             (j==47 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; Met &gt; 300. &amp;&amp; nJets &gt; 0 &amp;&amp; signalJets[0]-&gt;pT() &gt; 400. &amp;&amp; mT &lt; 160. &amp;&amp;  !analysisBtags.at(signalJets[0]) &amp;&amp; minDPhiMetBJet &lt; 1.5 &amp;&amp; pTLepOverMet &lt; 0.05 &amp;&amp; topReclM &lt; 150 &amp;&amp; pTLepOverMet &lt; 0.02) ||

             // bC2x_diag cutflow

             (j==48 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 75) ||

             (j==49 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 75 &amp;&amp; signalJets[1]-&gt;pT() &gt; 75) ||

             (j==50 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 75 &amp;&amp; signalJets[1]-&gt;pT() &gt; 75 &amp;&amp; signalJets[2]-&gt;pT() &gt; 75) ||

             (j==51 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 75 &amp;&amp; signalJets[1]-&gt;pT() &gt; 75 &amp;&amp; signalJets[2]-&gt;pT() &gt; 75 &amp;&amp; signalJets[3]-&gt;pT() &gt; 30) ||

             (j==52 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 75 &amp;&amp; signalJets[1]-&gt;pT() &gt; 75 &amp;&amp; signalJets[2]-&gt;pT() &gt; 75 &amp;&amp; signalJets[3]-&gt;pT() &gt; 30 &amp;&amp; nBJets&gt;=2) ||

             (j==53 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 75 &amp;&amp; signalJets[1]-&gt;pT() &gt; 75 &amp;&amp; signalJets[2]-&gt;pT() &gt; 75 &amp;&amp; signalJets[3]-&gt;pT() &gt; 30 &amp;&amp; nBJets&gt;=2 &amp;&amp; signalBJets[1]-&gt;pT() &gt; 30) ||

             (j==54 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 75 &amp;&amp; signalJets[1]-&gt;pT() &gt; 75 &amp;&amp; signalJets[2]-&gt;pT() &gt; 75 &amp;&amp; signalJets[3]-&gt;pT() &gt; 30 &amp;&amp; nBJets&gt;=2 &amp;&amp; signalBJets[1]-&gt;pT() &gt; 30 &amp;&amp; absDPhiJMet0 &gt; 0.7) ||

             (j==55 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 75 &amp;&amp; signalJets[1]-&gt;pT() &gt; 75 &amp;&amp; signalJets[2]-&gt;pT() &gt; 75 &amp;&amp; signalJets[3]-&gt;pT() &gt; 30 &amp;&amp; nBJets&gt;=2 &amp;&amp; signalBJets[1]-&gt;pT() &gt; 30 &amp;&amp; absDPhiJMet0 &gt; 0.7 &amp;&amp; absDPhiJMet1 &gt; 0.7) ||

             (j==56 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 75 &amp;&amp; signalJets[1]-&gt;pT() &gt; 75 &amp;&amp; signalJets[2]-&gt;pT() &gt; 75 &amp;&amp; signalJets[3]-&gt;pT() &gt; 30 &amp;&amp; nBJets&gt;=2 &amp;&amp; signalBJets[1]-&gt;pT() &gt; 30 &amp;&amp; absDPhiJMet0 &gt; 0.7 &amp;&amp; absDPhiJMet1 &gt; 0.7 &amp;&amp; HtSigMiss &gt; 13) ||

             (j==57 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 75 &amp;&amp; signalJets[1]-&gt;pT() &gt; 75 &amp;&amp; signalJets[2]-&gt;pT() &gt; 75 &amp;&amp; signalJets[3]-&gt;pT() &gt; 30 &amp;&amp; nBJets&gt;=2 &amp;&amp; signalBJets[1]-&gt;pT() &gt; 30 &amp;&amp; absDPhiJMet0 &gt; 0.7 &amp;&amp; absDPhiJMet1 &gt; 0.7 &amp;&amp; HtSigMiss &gt; 13 &amp;&amp; mT &gt; 180) ||

             (j==58 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 75 &amp;&amp; signalJets[1]-&gt;pT() &gt; 75 &amp;&amp; signalJets[2]-&gt;pT() &gt; 75 &amp;&amp; signalJets[3]-&gt;pT() &gt; 30 &amp;&amp; nBJets&gt;=2 &amp;&amp; signalBJets[1]-&gt;pT() &gt; 30 &amp;&amp; absDPhiJMet0 &gt; 0.7 &amp;&amp; absDPhiJMet1 &gt; 0.7 &amp;&amp; HtSigMiss &gt; 13 &amp;&amp; mT &gt; 180 &amp;&amp; amT2 &gt; 175) ||

             (j==59 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 75 &amp;&amp; signalJets[1]-&gt;pT() &gt; 75 &amp;&amp; signalJets[2]-&gt;pT() &gt; 75 &amp;&amp; signalJets[3]-&gt;pT() &gt; 30 &amp;&amp; nBJets&gt;=2 &amp;&amp; signalBJets[1]-&gt;pT() &gt; 30 &amp;&amp; absDPhiJMet0 &gt; 0.7 &amp;&amp; absDPhiJMet1 &gt; 0.7 &amp;&amp; HtSigMiss &gt; 13 &amp;&amp; mT &gt; 180 &amp;&amp; amT2 &gt; 175 &amp;&amp; WReclM &gt; 50) ||

             // bC2x_med

             (j==60 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 200) ||

             (j==61 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 200 &amp;&amp; signalJets[1]-&gt;pT() &gt; 140) ||

             (j==62 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 200 &amp;&amp; signalJets[1]-&gt;pT() &gt; 140 &amp;&amp; nBJets &gt;=2) ||

             (j==63 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 200 &amp;&amp; signalJets[1]-&gt;pT() &gt; 140 &amp;&amp; nBJets &gt;=2 &amp;&amp; signalBJets[0]-&gt;pT() &gt; 140) ||

             (j==64 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 200 &amp;&amp; signalJets[1]-&gt;pT() &gt; 140 &amp;&amp; nBJets &gt;=2 &amp;&amp; signalBJets[0]-&gt;pT() &gt; 140 &amp;&amp; signalBJets[1]-&gt;pT() &gt; 140) ||

             (j==65 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 200 &amp;&amp; signalJets[1]-&gt;pT() &gt; 140 &amp;&amp; nBJets &gt;=2 &amp;&amp; signalBJets[0]-&gt;pT() &gt; 140 &amp;&amp; signalBJets[1]-&gt;pT() &gt; 140 &amp;&amp; absDPhiJMet0 &gt; 0.9) ||

             (j==66 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 200 &amp;&amp; signalJets[1]-&gt;pT() &gt; 140 &amp;&amp; nBJets &gt;=2 &amp;&amp; signalBJets[0]-&gt;pT() &gt; 140 &amp;&amp; signalBJets[1]-&gt;pT() &gt; 140 &amp;&amp; absDPhiJMet0 &gt; 0.9 &amp;&amp; absDPhiJMet1 &gt; 0.9) ||

             (j==67 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 200 &amp;&amp; signalJets[1]-&gt;pT() &gt; 140 &amp;&amp; nBJets &gt;=2 &amp;&amp; signalBJets[0]-&gt;pT() &gt; 140 &amp;&amp; signalBJets[1]-&gt;pT() &gt; 140 &amp;&amp; absDPhiJMet0 &gt; 0.9 &amp;&amp; absDPhiJMet1 &gt; 0.9 &amp;&amp; HtSigMiss &gt; 10) ||

             (j==68 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 200 &amp;&amp; signalJets[1]-&gt;pT() &gt; 140 &amp;&amp; nBJets &gt;=2 &amp;&amp; signalBJets[0]-&gt;pT() &gt; 140 &amp;&amp; signalBJets[1]-&gt;pT() &gt; 140 &amp;&amp; absDPhiJMet0 &gt; 0.9 &amp;&amp; absDPhiJMet1 &gt; 0.9 &amp;&amp; HtSigMiss &gt; 10 &amp;&amp; mT &gt; 120) ||

             (j==69 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 200 &amp;&amp; signalJets[1]-&gt;pT() &gt; 140 &amp;&amp; nBJets &gt;=2 &amp;&amp; signalBJets[0]-&gt;pT() &gt; 140 &amp;&amp; signalBJets[1]-&gt;pT() &gt; 140 &amp;&amp; absDPhiJMet0 &gt; 0.9 &amp;&amp; absDPhiJMet1 &gt; 0.9 &amp;&amp; HtSigMiss &gt; 10 &amp;&amp; mT &gt; 120 &amp;&amp; amT2 &gt; 300) ||

             (j==70 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=4 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; mT2Tau &gt; 80 &amp;&amp; signalJets[0]-&gt;pT() &gt; 200 &amp;&amp; signalJets[1]-&gt;pT() &gt; 140 &amp;&amp; nBJets &gt;=2 &amp;&amp; signalBJets[0]-&gt;pT() &gt; 140 &amp;&amp; signalBJets[1]-&gt;pT() &gt; 140 &amp;&amp; absDPhiJMet0 &gt; 0.9 &amp;&amp; absDPhiJMet1 &gt; 0.9 &amp;&amp; HtSigMiss &gt; 10 &amp;&amp; mT &gt; 120 &amp;&amp; amT2 &gt; 300 &amp;&amp; WReclM &gt; 50) ||

             // bCbv cutflow

             (j==71 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=2 &amp;&amp; Met &gt; 230. &amp;&amp; signalJets[0]-&gt;pT() &gt; 120) ||

             (j==72 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=2 &amp;&amp; Met &gt; 230. &amp;&amp; signalJets[0]-&gt;pT() &gt; 120 &amp;&amp; signalJets[1]-&gt;pT() &gt; 80) ||

             (j==73 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=2 &amp;&amp; Met &gt; 230. &amp;&amp; signalJets[0]-&gt;pT() &gt; 120 &amp;&amp; signalJets[1]-&gt;pT() &gt; 80 &amp;&amp; nBJets==0) ||

             (j==74 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=2 &amp;&amp; Met &gt; 230. &amp;&amp; signalJets[0]-&gt;pT() &gt; 120 &amp;&amp; signalJets[1]-&gt;pT() &gt; 80 &amp;&amp; nBJets==0 &amp;&amp;  baselineLeptons[0]-&gt;pT() &gt; 60) ||

             (j==75 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=2 &amp;&amp; Met &gt; 230. &amp;&amp; signalJets[0]-&gt;pT() &gt; 120 &amp;&amp; signalJets[1]-&gt;pT() &gt; 80 &amp;&amp; nBJets==0 &amp;&amp;  baselineLeptons[0]-&gt;pT() &gt; 60 &amp;&amp; absDPhiJMet0 &gt; 2.0 ) ||

             (j==76 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=2 &amp;&amp; Met &gt; 230. &amp;&amp; signalJets[0]-&gt;pT() &gt; 120 &amp;&amp; signalJets[1]-&gt;pT() &gt; 80 &amp;&amp; nBJets==0 &amp;&amp;  baselineLeptons[0]-&gt;pT() &gt; 60 &amp;&amp; absDPhiJMet0 &gt; 2.0 &amp;&amp; absDPhiJMet1 &gt; 0.8) ||

             (j==77 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=2 &amp;&amp; Met &gt; 230. &amp;&amp; signalJets[0]-&gt;pT() &gt; 120 &amp;&amp; signalJets[1]-&gt;pT() &gt; 80 &amp;&amp; nBJets==0 &amp;&amp;  baselineLeptons[0]-&gt;pT() &gt; 60 &amp;&amp; absDPhiJMet0 &gt; 2.0 &amp;&amp; absDPhiJMet1 &gt; 0.8 &amp;&amp; Met &gt; 360) ||

             (j==78 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=2 &amp;&amp; Met &gt; 230. &amp;&amp; signalJets[0]-&gt;pT() &gt; 120 &amp;&amp; signalJets[1]-&gt;pT() &gt; 80 &amp;&amp; nBJets==0 &amp;&amp;  baselineLeptons[0]-&gt;pT() &gt; 60 &amp;&amp; absDPhiJMet0 &gt; 2.0 &amp;&amp; absDPhiJMet1 &gt; 0.8 &amp;&amp; Met &gt; 360 &amp;&amp; HtSigMiss &gt; 16) ||

             (j==79 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=2 &amp;&amp; Met &gt; 230. &amp;&amp; signalJets[0]-&gt;pT() &gt; 120 &amp;&amp; signalJets[1]-&gt;pT() &gt; 80 &amp;&amp; nBJets==0 &amp;&amp;  baselineLeptons[0]-&gt;pT() &gt; 60 &amp;&amp; absDPhiJMet0 &gt; 2.0 &amp;&amp; absDPhiJMet1 &gt; 0.8 &amp;&amp; Met &gt; 360 &amp;&amp; HtSigMiss &gt; 16 &amp;&amp; mT &gt; 200) ||

             (j==80 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=2 &amp;&amp; Met &gt; 230. &amp;&amp; signalJets[0]-&gt;pT() &gt; 120 &amp;&amp; signalJets[1]-&gt;pT() &gt; 80 &amp;&amp; nBJets==0 &amp;&amp;  baselineLeptons[0]-&gt;pT() &gt; 60 &amp;&amp; absDPhiJMet0 &gt; 2.0 &amp;&amp; absDPhiJMet1 &gt; 0.8 &amp;&amp; Met &gt; 360 &amp;&amp; HtSigMiss &gt; 16 &amp;&amp; mT &gt; 200 &amp;&amp; WReclM &gt;= 70 &amp;&amp; WReclM &lt;= 100) ||

             (j==81 &amp;&amp;  baselineLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()&gt;0 &amp;&amp; signalLeptons.size()==1 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=2 &amp;&amp; Met &gt; 230. &amp;&amp; signalJets[0]-&gt;pT() &gt; 120 &amp;&amp; signalJets[1]-&gt;pT() &gt; 80 &amp;&amp; nBJets==0 &amp;&amp;  baselineLeptons[0]-&gt;pT() &gt; 60 &amp;&amp; absDPhiJMet0 &gt; 2.0 &amp;&amp; absDPhiJMet1 &gt; 0.8 &amp;&amp; Met &gt; 360 &amp;&amp; HtSigMiss &gt; 16 &amp;&amp; mT &gt; 200 &amp;&amp; WReclM &gt;= 70 &amp;&amp; WReclM &lt;= 100 &amp;&amp; dPhiMetLep &gt; 1.2 ) ||

             // bCsoft_diag

             (j==82 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep) ||

             (j==83 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; Met &gt; 300.) ||

             (j==84 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; Met &gt; 300. &amp;&amp; signalJets[0]-&gt;pT() &gt; 400) ||

             (j==85 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; Met &gt; 300. &amp;&amp; signalJets[0]-&gt;pT() &gt; 400 &amp;&amp; mT &lt; 160) ||

             (j==86 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; Met &gt; 300. &amp;&amp; signalJets[0]-&gt;pT() &gt; 400 &amp;&amp; mT &lt; 160 &amp;&amp; !analysisBtags.at(signalJets[0])) ||

             (j==87 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; Met &gt; 300. &amp;&amp; signalJets[0]-&gt;pT() &gt; 400 &amp;&amp; mT &lt; 160 &amp;&amp; !analysisBtags.at(signalJets[0]) &amp;&amp; mT &lt; 50) ||

             (j==88 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; Met &gt; 300. &amp;&amp; signalJets[0]-&gt;pT() &gt; 400 &amp;&amp; mT &lt; 160 &amp;&amp; !analysisBtags.at(signalJets[0]) &amp;&amp; mT &lt; 50 &amp;&amp; minDPhiMetBJet &lt; 1.5) ||

             (j==89 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; Met &gt; 300. &amp;&amp; signalJets[0]-&gt;pT() &gt; 400 &amp;&amp; mT &lt; 160 &amp;&amp; !analysisBtags.at(signalJets[0]) &amp;&amp; mT &lt; 50 &amp;&amp; minDPhiMetBJet &lt; 1.5 &amp;&amp;  pTLepOverMet &lt; 0.05) ||

             (j==90 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; Met &gt; 300. &amp;&amp; signalJets[0]-&gt;pT() &gt; 400 &amp;&amp; mT &lt; 160 &amp;&amp; !analysisBtags.at(signalJets[0]) &amp;&amp; mT &lt; 50 &amp;&amp; minDPhiMetBJet &lt; 1.5 &amp;&amp;  pTLepOverMet &lt; 0.05 &amp;&amp; topReclM &lt; 150 ) ||

             (j==91 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; Met &gt; 300. &amp;&amp; signalJets[0]-&gt;pT() &gt; 400 &amp;&amp; mT &lt; 160 &amp;&amp; !analysisBtags.at(signalJets[0]) &amp;&amp; mT &lt; 50 &amp;&amp; minDPhiMetBJet &lt; 1.5 &amp;&amp;  pTLepOverMet &lt; 0.05 &amp;&amp; topReclM &lt; 150 &amp;&amp;  pTLepOverMet &lt; 0.02) ||

             // bCsoft_med cutflow

             (j==92 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep) ||

             (j==93 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; nJets &gt;=3) ||

             (j==94 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; nJets &gt;=3 &amp;&amp; Wpt &gt; 400) ||

             (j==95 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; nJets &gt;=3 &amp;&amp; Wpt &gt; 400 &amp;&amp; signalJets[0]-&gt;pT() &gt; 120) ||

             (j==96 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; nJets &gt;=3 &amp;&amp; Wpt &gt; 400 &amp;&amp; signalJets[0]-&gt;pT() &gt; 120 &amp;&amp; signalJets[1]-&gt;pT() &gt; 60) ||

             (j==97 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; nJets &gt;=3 &amp;&amp; Wpt &gt; 400 &amp;&amp; signalJets[0]-&gt;pT() &gt; 120 &amp;&amp; signalJets[1]-&gt;pT() &gt; 60 &amp;&amp; signalJets[2]-&gt;pT() &gt; 40) ||
             (j==98 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; nJets &gt;=3 &amp;&amp; Wpt &gt; 400 &amp;&amp; signalJets[0]-&gt;pT() &gt; 120 &amp;&amp; signalJets[1]-&gt;pT() &gt; 60 &amp;&amp; signalJets[2]-&gt;pT() &gt; 40 &amp;&amp; mT &lt; 160) ||

             (j==99 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; nJets &gt;=3 &amp;&amp; Wpt &gt; 400 &amp;&amp; signalJets[0]-&gt;pT() &gt; 120 &amp;&amp; signalJets[1]-&gt;pT() &gt; 60 &amp;&amp; signalJets[2]-&gt;pT() &gt; 40 &amp;&amp; mT &lt; 160 &amp;&amp; amT2 &gt; 200) ||

             (j==100 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; nJets &gt;=3 &amp;&amp; Wpt &gt; 400 &amp;&amp; signalJets[0]-&gt;pT() &gt; 120 &amp;&amp; signalJets[1]-&gt;pT() &gt; 60 &amp;&amp; signalJets[2]-&gt;pT() &gt; 40 &amp;&amp; mT &lt; 160 &amp;&amp; amT2 &gt; 200 &amp;&amp; nBJets &gt; 1) ||

             (j==101 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; nJets &gt;=3 &amp;&amp; Wpt &gt; 400 &amp;&amp; signalJets[0]-&gt;pT() &gt; 120 &amp;&amp; signalJets[1]-&gt;pT() &gt; 60 &amp;&amp; signalJets[2]-&gt;pT() &gt; 40 &amp;&amp; mT &lt; 160 &amp;&amp; amT2 &gt; 200 &amp;&amp; nBJets &gt; 1 &amp;&amp;  signalBJets[0]-&gt;pT() &gt; 120) ||

             (j==102 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; nJets &gt;=3 &amp;&amp; Wpt &gt; 400 &amp;&amp; signalJets[0]-&gt;pT() &gt; 120 &amp;&amp; signalJets[1]-&gt;pT() &gt; 60 &amp;&amp; signalJets[2]-&gt;pT() &gt; 40 &amp;&amp; mT &lt; 160 &amp;&amp; amT2 &gt; 200 &amp;&amp; nBJets &gt; 1 &amp;&amp;  signalBJets[0]-&gt;pT() &gt; 120 &amp;&amp; signalBJets[1]-&gt;pT() &gt; 60) ||

             (j==103 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; nJets &gt;=3 &amp;&amp; Wpt &gt; 400 &amp;&amp; signalJets[0]-&gt;pT() &gt; 120 &amp;&amp; signalJets[1]-&gt;pT() &gt; 60 &amp;&amp; signalJets[2]-&gt;pT() &gt; 40 &amp;&amp; mT &lt; 160 &amp;&amp; amT2 &gt; 200 &amp;&amp; nBJets &gt; 1 &amp;&amp;  signalBJets[0]-&gt;pT() &gt; 120 &amp;&amp; signalBJets[1]-&gt;pT() &gt; 60 &amp;&amp; minDPhiMetBJet &gt; 0.8) ||

             (j==104 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; nJets &gt;=3 &amp;&amp; Wpt &gt; 400 &amp;&amp; signalJets[0]-&gt;pT() &gt; 120 &amp;&amp; signalJets[1]-&gt;pT() &gt; 60 &amp;&amp; signalJets[2]-&gt;pT() &gt; 40 &amp;&amp; mT &lt; 160 &amp;&amp; amT2 &gt; 200 &amp;&amp; nBJets &gt; 1 &amp;&amp;  signalBJets[0]-&gt;pT() &gt; 120 &amp;&amp; signalBJets[1]-&gt;pT() &gt; 60 &amp;&amp; minDPhiMetBJet &gt; 0.8 &amp;&amp; pTLepOverMet &lt; 0.1) ||

             (j==105 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt; 1 &amp;&amp; nBJets &gt; 0 &amp;&amp; preselSoftLep &amp;&amp; nJets &gt;=3 &amp;&amp; Wpt &gt; 400 &amp;&amp; signalJets[0]-&gt;pT() &gt; 120 &amp;&amp; signalJets[1]-&gt;pT() &gt; 60 &amp;&amp; signalJets[2]-&gt;pT() &gt; 40 &amp;&amp; mT &lt; 160 &amp;&amp; amT2 &gt; 200 &amp;&amp; nBJets &gt; 1 &amp;&amp;  signalBJets[0]-&gt;pT() &gt; 120 &amp;&amp; signalBJets[1]-&gt;pT() &gt; 60 &amp;&amp; minDPhiMetBJet &gt; 0.8 &amp;&amp; pTLepOverMet &lt; 0.1 &amp;&amp; pTLepOverMet &lt; 0.03) ||

             // bCsoft_high cutflow

             (j==106 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=2 &amp;&amp; Met &gt; 230.) ||

             (j==107 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=2 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4) ||

             (j==108 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=2 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4) ||
             (j==109 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=2 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; signalJets[0]-&gt;pT() &gt; 100) ||

             (j==110 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=2 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; signalJets[0]-&gt;pT() &gt; 100 &amp;&amp; signalJets[1]-&gt;pT() &gt; 100) ||

             (j==111 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=2 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; signalJets[0]-&gt;pT() &gt; 100 &amp;&amp; signalJets[1]-&gt;pT() &gt; 100 &amp;&amp; mT &lt; 160) ||

             (j==112 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=2 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; signalJets[0]-&gt;pT() &gt; 100 &amp;&amp; signalJets[1]-&gt;pT() &gt; 100 &amp;&amp; mT &lt; 160 &amp;&amp; Wpt &gt; 500) ||

             (j==113 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=2 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; signalJets[0]-&gt;pT() &gt; 100 &amp;&amp; signalJets[1]-&gt;pT() &gt; 100 &amp;&amp; mT &lt; 160 &amp;&amp; Wpt &gt; 500 &amp;&amp; dRbb &gt; 0.8) ||

             (j==114 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=2 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; signalJets[0]-&gt;pT() &gt; 100 &amp;&amp; signalJets[1]-&gt;pT() &gt; 100 &amp;&amp; mT &lt; 160 &amp;&amp; Wpt &gt; 500 &amp;&amp; dRbb &gt; 0.8 &amp;&amp; minDPhiMetBJet &gt; 0.4) ||

             (j==115 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=2 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; signalJets[0]-&gt;pT() &gt; 100 &amp;&amp; signalJets[1]-&gt;pT() &gt; 100 &amp;&amp; mT &lt; 160 &amp;&amp; Wpt &gt; 500 &amp;&amp; dRbb &gt; 0.8 &amp;&amp; minDPhiMetBJet &gt; 0.4 &amp;&amp; nBJets&gt;=2 ) ||

             (j==116 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=2 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; signalJets[0]-&gt;pT() &gt; 100 &amp;&amp; signalJets[1]-&gt;pT() &gt; 100 &amp;&amp; mT &lt; 160 &amp;&amp; Wpt &gt; 500 &amp;&amp; dRbb &gt; 0.8 &amp;&amp; minDPhiMetBJet &gt; 0.4 &amp;&amp; nBJets&gt;=2 &amp;&amp; signalBJets[0]-&gt;pT() &gt; 100) ||

             (j==117 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=2 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; signalJets[0]-&gt;pT() &gt; 100 &amp;&amp; signalJets[1]-&gt;pT() &gt; 100 &amp;&amp; mT &lt; 160 &amp;&amp; Wpt &gt; 500 &amp;&amp; dRbb &gt; 0.8 &amp;&amp; minDPhiMetBJet &gt; 0.4 &amp;&amp; nBJets&gt;=2 &amp;&amp; signalBJets[0]-&gt;pT() &gt; 100 &amp;&amp; signalBJets[1]-&gt;pT() &gt; 100) ||

             (j==118 &amp;&amp; baselineLeptons.size()&gt;0 &amp;&amp; baselineLeptons.size()==1 &amp;&amp; nJets &gt;=2 &amp;&amp; Met &gt; 230. &amp;&amp; absDPhiJMet0 &gt; 0.4 &amp;&amp; absDPhiJMet1 &gt; 0.4 &amp;&amp; signalJets[0]-&gt;pT() &gt; 100 &amp;&amp; signalJets[1]-&gt;pT() &gt; 100 &amp;&amp; mT &lt; 160 &amp;&amp; Wpt &gt; 500 &amp;&amp; dRbb &gt; 0.8 &amp;&amp; minDPhiMetBJet &gt; 0.4 &amp;&amp; nBJets&gt;=2 &amp;&amp; signalBJets[0]-&gt;pT() &gt; 100 &amp;&amp; signalBJets[1]-&gt;pT() &gt; 100 &amp;&amp; amT2 &gt; 300)
             )
          {
            cutFlowVector[j]++;
          }

        }

        if(is_tN_med) _counters.at(&quot;tN_med&quot;).add_event(event);
        if(is_tN_high) _counters.at(&quot;tN_high&quot;).add_event(event);
        if(is_bWN) _counters.at(&quot;bWN&quot;).add_event(event);
        if(is_bC2x_diag) _counters.at(&quot;bC2x_diag&quot;).add_event(event);
        if(is_bC2x_med) _counters.at(&quot;bC2x_med&quot;).add_event(event);
        if(is_bCbv) _counters.at(&quot;bCbv&quot;).add_event(event);
        if(is_DM_low) _counters.at(&quot;DM_low_loose&quot;).add_event(event);
        if(is_DM_low) _counters.at(&quot;DM_low&quot;).add_event(event);
        if(is_DM_high) _counters.at(&quot;DM_high&quot;).add_event(event);

        if(is_bffN) _counters.at(&quot;bffN&quot;).add_event(event);
        if(is_bCsoft_diag) _counters.at(&quot;bCsoft_diag&quot;).add_event(event);
        if(is_bCsoft_med) _counters.at(&quot;bCsoft_med&quot;).add_event(event);
        if(is_bCsoft_high) _counters.at(&quot;bCsoft_high&quot;).add_event(event);

        return;

      }

      void combine(const Analysis* other)
      {
        const Analysis_ATLAS_13TeV_1LEPStop_36invfb* specificOther
                = dynamic_cast&lt;const Analysis_ATLAS_13TeV_1LEPStop_36invfb*&gt;(other);

        for (auto&amp; pair : _counters) { pair.second += specificOther-&gt;_counters.at(pair.first); }

        if (NCUTS != specificOther-&gt;NCUTS) NCUTS = specificOther-&gt;NCUTS;
        for (int j=0; j&lt;NCUTS; j++)
        {
          cutFlowVector[j] += specificOther-&gt;cutFlowVector[j];
          cutFlowVector_str[j] = specificOther-&gt;cutFlowVector_str[j];
        }
      }


      void collect_results()
      {

        // // For debugging:
        // double scale_by=1.;
        // cout &lt;&lt; &quot;------------------------------------------------------------------------------------------------------------------------------ &quot;&lt;&lt;endl;
        // cout &lt;&lt; &quot;CUT FLOW: ATLAS 13 TeV 1 lep stop paper &quot;&lt;&lt;endl;
        // cout &lt;&lt; &quot;------------------------------------------------------------------------------------------------------------------------------&quot;&lt;&lt;endl;
        // cout&lt;&lt; right &lt;&lt; setw(40) &lt;&lt; &quot;CUT&quot; &lt;&lt; setw(20) &lt;&lt; &quot;RAW&quot; &lt;&lt; setw(20) &lt;&lt; &quot;SCALED&quot;
        //     &lt;&lt; setw(20) &lt;&lt; &quot;%&quot; &lt;&lt; setw(20) &lt;&lt; &quot;clean adj RAW&quot;&lt;&lt; setw(20) &lt;&lt; &quot;clean adj %&quot; &lt;&lt; endl;
        // for (int j=0; j&lt;NCUTS; j++)
        // {
        //   cout &lt;&lt; right &lt;&lt; setw(40) &lt;&lt; cutFlowVector_str[j].c_str() &lt;&lt; setw(20)
        //        &lt;&lt; cutFlowVector[j] &lt;&lt; setw(20) &lt;&lt; cutFlowVector[j]*scale_by &lt;&lt; setw(20)
        //        &lt;&lt; 100.*cutFlowVector[j]/cutFlowVector[0] &lt;&lt; &quot;%&quot; &lt;&lt; setw(20)
        //        &lt;&lt; cutFlowVector[j]*scale_by &lt;&lt; setw(20) &lt;&lt; 100.*cutFlowVector[j]/cutFlowVector[0]&lt;&lt; &quot;%&quot; &lt;&lt; endl;
        // }
        // cout &lt;&lt; &quot;------------------------------------------------------------------------------------------------------------------------------ &quot;&lt;&lt;endl;


        add_result(SignalRegionData(_counters.at(&quot;tN_med&quot;), 50., { 36.3, 6.6}));
        add_result(SignalRegionData(_counters.at(&quot;tN_high&quot;), 8., { 3.8, 1.0}));
        add_result(SignalRegionData(_counters.at(&quot;bWN&quot;), 68., { 71, 16}));
        add_result(SignalRegionData(_counters.at(&quot;bC2x_diag&quot;), 22., { 21.3, 5.0}));
        add_result(SignalRegionData(_counters.at(&quot;bC2x_med&quot;), 4., { 5.8, 1.6}));
        add_result(SignalRegionData(_counters.at(&quot;bCbv&quot;), 25., { 25.1, 3.8}));
        add_result(SignalRegionData(_counters.at(&quot;DM_low_loose&quot;), 65., { 48.3, 8.2}));
        add_result(SignalRegionData(_counters.at(&quot;DM_low&quot;), 13., { 13.8, 3.6}));
        add_result(SignalRegionData(_counters.at(&quot;DM_high&quot;), 5., { 7.4, 2.1}));
        add_result(SignalRegionData(_counters.at(&quot;bffN&quot;), 70., { 60.5, 6.1}));
        add_result(SignalRegionData(_counters.at(&quot;bCsoft_diag&quot;), 33., { 24.7, 3.1}));
        add_result(SignalRegionData(_counters.at(&quot;bCsoft_med&quot;), 19., { 13.7, 2.1}));
        add_result(SignalRegionData(_counters.at(&quot;bCsoft_high&quot;), 2., { 1.8, 0.3}));

        return;
      }


    protected:
      void analysis_specific_reset()
      {
        for (auto&amp; pair : _counters) { pair.second.reset(); }

        std::fill(cutFlowVector.begin(), cutFlowVector.end(), 0);
      }

    };

    DEFINE_ANALYSIS_FACTORY(ATLAS_13TeV_1LEPStop_36invfb)

  }
}

#endif
</code></pre><hr><p>Updated on 2022-08-02 at 18:18:40 +0000</p><div class=edit-page><a href=https://github.com/RC1242RC/gambit_gh_pages/blob/master/content/en/documentation/code/gambit_sphinx/Files/Analysis__ATLAS__13TeV__1LEPStop__36invfb_8cpp.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on GitHub</a></div></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a class=text-muted href=https://www.netlify.com/>Netlify</a>, <a class=text-muted href=https://gohugo.io/>Hugo</a>, and <a class=text-muted href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline><li class=list-inline-item><a href=/license/>License</a></li></ul></div></div></div></footer><script src=/js/bootstrap.min.54bf0932b8a36d0e152b1635b099a6ef1394d35327e2437550a075c9c8ed1bd8aed5847c21b36fc02ed24014c031d9ca24017b0c78b1639d7e2fa8329898b842.js integrity="sha512-VL8JMrijbQ4VKxY1sJmm7xOU01Mn4kN1UKB1ycjtG9iu1YR8IbNvwC7SQBTAMdnKJAF7DHixY51+L6gymJi4Qg==" crossorigin=anonymous defer></script>
<script src=/js/highlight.min.5b48bc253dc75aeea5fb366ecf700f4925e2b6eb1a1466f2124b722d68148d67bc0a9365d2b8ad9c585161b46372d23b08509a16f1fd518542b894756d4752d0.js integrity="sha512-W0i8JT3HWu6l+zZuz3APSSXitusaFGbyEktyLWgUjWe8CpNl0ritnFhRYbRjctI7CFCaFvH9UYVCuJR1bUdS0A==" crossorigin=anonymous defer></script>
<script src=/main.min.40265e9a032aeba5eaf67baac3cbbc22667a7533215d326eeb3e9f4d5e4be40f9ff4dcd22949db73ae527ca26a19d7998091a8973c82af760b2c0daa335190ed.js integrity="sha512-QCZemgMq66Xq9nuqw8u8ImZ6dTMhXTJu6z6fTV5L5A+f9NzSKUnbc65SfKJqGdeZgJGolzyCr3YLLA2qM1GQ7Q==" crossorigin=anonymous defer></script>
<script src=https://rc1242rc.github.io/index.min.bf15e814991a9d3ef02f52a26d135d3cd0a098afc407e971daad9f276d437236be129db79cd96bd09f86d0730d8272253cdaff9edd528739d4fc2013efa8d4ba.js integrity="sha512-vxXoFJkanT7wL1KibRNdPNCgmK/EB+lx2q2fJ21Dcja+Ep23nNlr0J+G0HMNgnIlPNr/nt1ShznU/CAT76jUug==" crossorigin=anonymous defer></script></body></html>